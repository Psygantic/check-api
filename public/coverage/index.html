<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for App</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.0/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.0/favicon_green.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.0/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2017-03-03T00:08:22+00:00">2017-03-03T00:08:22+00:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="green">99.58%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         247.47
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>116</b> files in total.
    <b>2865</b> relevant lines. 
    <span class="green"><b>2853</b> lines covered</span> and
    <span class="red"><b>12</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#e6a365ade5ce357634f8a4ac5eecd58f6032e0f3" class="src_link" title="../controllers/api/v1/base_api_controller.rb">../controllers/api/v1/base_api_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>109</td>
        <td>62</td>
        <td>62</td>
        <td>0</td>
        <td>130.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5a7aa5a00ae3184898111bab3418a728a889e04e" class="src_link" title="../controllers/api/v1/confirmations_controller.rb">../controllers/api/v1/confirmations_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>14</td>
        <td>10</td>
        <td>5</td>
        <td>5</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c41a5340f4ead1a3cce0a477d1689b5fd33a5a66" class="src_link" title="../controllers/api/v1/graphql_controller.rb">../controllers/api/v1/graphql_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>62</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>53.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#35e65069b1196d58de29c8083524fd68a2a4147a" class="src_link" title="../controllers/api/v1/omniauth_callbacks_controller.rb">../controllers/api/v1/omniauth_callbacks_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>46</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>4.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c51f03642b48922e66273be6220eb78075d2dbd2" class="src_link" title="../controllers/api/v1/registrations_controller.rb">../controllers/api/v1/registrations_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>62</td>
        <td>34</td>
        <td>34</td>
        <td>0</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#05c9618673218b1493595b8a722622e8011dd95e" class="src_link" title="../controllers/api/v1/sessions_controller.rb">../controllers/api/v1/sessions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>34</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>4.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#67d8f4f56b98a41ec0384f715547f7e146b97d14" class="src_link" title="../controllers.lication_controller.rb">../controllers.lication_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>41</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>7.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7f6a5a6f7593e805497379b51ce0d79ed7bc02d" class="src_link" title="../controllers/concerns/facebook_authentication.rb">../controllers/concerns/facebook_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9cff0f08721bd13a85752f13dd9ea537bbe42d63" class="src_link" title="../controllers/concerns/slack_authentication.rb">../controllers/concerns/slack_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0971008d6a7a8d61a699db0753ee876b1bdea4f3" class="src_link" title="../controllers/concerns/twitter_authentication.rb">../controllers/concerns/twitter_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#782dc64cd6c7457a95a8164ca35f3ad320126641" class="src_link" title="../graph/mutations/account_mutations.rb">../graph/mutations/account_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bf861b227eecfbb0aa60b2ddec2b2a177b022103" class="src_link" title="../graph/mutations/annotation_mutations.rb">../graph/mutations/annotation_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3cf8e16e15c91ab6131bb456e9409bfd93aada85" class="src_link" title="../graph/mutations/comment_mutations.rb">../graph/mutations/comment_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#408cdd41190f5d277578abb33438231604e652fb" class="src_link" title="../graph/mutations/contact_mutations.rb">../graph/mutations/contact_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#04f9eabab43dd3ed7b99b9b389944a87d620f44b" class="src_link" title="../graph/mutations/dynamic_mutations.rb">../graph/mutations/dynamic_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f194fa39d6443f5d18faf8833225edcc6ca93593" class="src_link" title="../graph/mutations/flag_mutations.rb">../graph/mutations/flag_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3eb36527a8137891d5a630ad9a861a54b7d4b041" class="src_link" title="../graph/mutations/graphql_crud_operations.rb">../graph/mutations/graphql_crud_operations.rb</a></td>
        <td class="green strong">98.18 %</td>
        <td>212</td>
        <td>110</td>
        <td>108</td>
        <td>2</td>
        <td>16.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#83a9e5b858bb38eee5b1a3ba2f14a5e2fa187f34" class="src_link" title="../graph/mutations/project_media_mutations.rb">../graph/mutations/project_media_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a6637cff3c1c09b0c58914d6ba71d9f1fade3df4" class="src_link" title="../graph/mutations/project_mutations.rb">../graph/mutations/project_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9f0a73d04cb36feda0b218926798683547469b91" class="src_link" title="../graph/mutations/project_source_mutations.rb">../graph/mutations/project_source_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f4e4d1fa7215e9972142ac7e43e1e3d6985fd9ca" class="src_link" title="../graph/mutations/source_mutations.rb">../graph/mutations/source_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d8fd8a60a8f48d8e1b5383e734797ea616ecaa6" class="src_link" title="../graph/mutations/status_mutations.rb">../graph/mutations/status_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#60fd57acb2b12b6c6dd8082d05275c6a733e2175" class="src_link" title="../graph/mutations/tag_mutations.rb">../graph/mutations/tag_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7915bed7bdcfe0826c2297a179cde7e3a4dba831" class="src_link" title="../graph/mutations/task_mutations.rb">../graph/mutations/task_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e890021ee6d068c38fbe4ecb1ca7a6d967d044a" class="src_link" title="../graph/mutations/team_mutations.rb">../graph/mutations/team_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5cacb506cf1c7b4bbd05d5d1b1123687082fe0f2" class="src_link" title="../graph/mutations/team_user_mutations.rb">../graph/mutations/team_user_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ec38efa5820c09471c33bee863a2f2ab56a03dd8" class="src_link" title="../graph/mutations/user_mutations.rb">../graph/mutations/user_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e37e35c30a5965cb9b1e4b67197ef80a4b72f005" class="src_link" title="../graph/mutations/version_mutations.rb">../graph/mutations/version_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#141df6a452b5edc99b8207b5d8f723322f8b6ccc" class="src_link" title="../graph/types/about_type.rb">../graph/types/about_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f03b3dbe0294a0c436dd2b178f7d3c0a9befc5bc" class="src_link" title="../graph/types/account_type.rb">../graph/types/account_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>38</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba8a7247ec7e8e7838d2936c6b409770016b1762" class="src_link" title="../graph/types/annotation_type.rb">../graph/types/annotation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a67ffe45314b0fcc815c3bf02db26ee9c9a3eee8" class="src_link" title="../graph/types/annotator_type.rb">../graph/types/annotator_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#780847d8ef690ae6e58c8911207fca4bedb5d5ff" class="src_link" title="../graph/types/check_search_type.rb">../graph/types/check_search_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b851290a4189c7858b468480804da28b570dbab5" class="src_link" title="../graph/types/comment_type.rb">../graph/types/comment_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d0cf60f44d5e9117d84ce2e26af08a3e62c80ea1" class="src_link" title="../graph/types/contact_type.rb">../graph/types/contact_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#06fcfd737d1aea8c2cf39ccdf29777c4d99c6c47" class="src_link" title="../graph/types/dynamic_type.rb">../graph/types/dynamic_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#94b921bd0fb041012e9756d7e6534ee355d6c134" class="src_link" title="../graph/types/flag_type.rb">../graph/types/flag_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dbc14484c5291199518f29833e5819b110be4a8d" class="src_link" title="../graph/types/media_type.rb">../graph/types/media_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>19</td>
        <td>19</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dfb90ee1a2a9eefc02e05c595b554ac4d2146f25" class="src_link" title="../graph/types/mutation_type.rb">../graph/types/mutation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>68</td>
        <td>49</td>
        <td>49</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8d4412fde968d01897317a90eafe735e60722098" class="src_link" title="../graph/types/node_identification.rb">../graph/types/node_identification.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>32</td>
        <td>22</td>
        <td>22</td>
        <td>0</td>
        <td>9.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7025d05f4e1feace4629b557adb334c5f6d8b1f4" class="src_link" title="../graph/types/project_media_type.rb">../graph/types/project_media_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>150</td>
        <td>79</td>
        <td>79</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#da726a5fedb93b3fd795c2a75a3a8416089868f3" class="src_link" title="../graph/types/project_source_type.rb">../graph/types/project_source_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>30</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#10d1a7e824cfe9101a780d06b999f8c8dc635403" class="src_link" title="../graph/types/project_type.rb">../graph/types/project_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b569181384890401fa22991d906f9a5578f25e1d" class="src_link" title="../graph/types/public_team_type.rb">../graph/types/public_team_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aad14bf6d5125732ed3c0ddb316644ab9396c028" class="src_link" title="../graph/types/query_type.rb">../graph/types/query_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>112</td>
        <td>70</td>
        <td>70</td>
        <td>0</td>
        <td>3.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2e5cdec4050dccec9abca30d3ecaea58541edf2b" class="src_link" title="../graph/types/root_level_type.rb">../graph/types/root_level_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>83</td>
        <td>50</td>
        <td>50</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6549165ddd33f656fac17f7fc40c499e696ac522" class="src_link" title="../graph/types/source_type.rb">../graph/types/source_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>66</td>
        <td>38</td>
        <td>38</td>
        <td>0</td>
        <td>5.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#822e4ddba9b5ec4f6dec3c08e58b8b88a816b9cf" class="src_link" title="../graph/types/status_type.rb">../graph/types/status_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b624c21ffa164869d6a0900b217c369b4604a24f" class="src_link" title="../graph/types/tag_type.rb">../graph/types/tag_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a755198ebeff997a44d9630784ebb6091226ea91" class="src_link" title="../graph/types/task_type.rb">../graph/types/task_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#828d7ed4a3766f96c8727f33d9bcd363217d3041" class="src_link" title="../graph/types/team_type.rb">../graph/types/team_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>41</td>
        <td>41</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a39a1b1b400f78ebc30c6ecb25c5c211e17b17aa" class="src_link" title="../graph/types/team_user_type.rb">../graph/types/team_user_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#88d168229627a1bc70ca5f36aaa82c76e7a99ee2" class="src_link" title="../graph/types/user_type.rb">../graph/types/user_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>27</td>
        <td>27</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#575c07c36a90f26475f8f106d5289f3dd0b7329e" class="src_link" title="../graph/types/version_type.rb">../graph/types/version_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>47</td>
        <td>29</td>
        <td>29</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#db1bc6aef95690a1f3b4d378c7f61adc8b8d50a4" class="src_link" title="../mailers.lication_mailer.rb">../mailers.lication_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#68c1c75256e1d86bfb576e0defd12c8208941b75" class="src_link" title="../mailers/devise_mailer.rb">../mailers/devise_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#40e27a71083e7ac9eb11b55ff70ac7cb6c81c15c" class="src_link" title="../mailers/registration_mailer.rb">../mailers/registration_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#758047c0a649f0af11671ed66f60b0c926f1bd0a" class="src_link" title="../mailers/team_user_mailer.rb">../mailers/team_user_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>121.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#08d679bc80659fb3262f22814c1b10fcd271779d" class="src_link" title="../models/ability.rb">../models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>220</td>
        <td>145</td>
        <td>145</td>
        <td>0</td>
        <td>837.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8765507dc9f9bb69a1e07a3294d9757176206216" class="src_link" title="../models/account.rb">../models/account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>67</td>
        <td>43</td>
        <td>43</td>
        <td>0</td>
        <td>78.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#710341af2263a38e8fb9ba4cbe838124ba0e0371" class="src_link" title="../models/annotations/annotation.rb">../models/annotations/annotation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>9.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c3ed09ae7ebff52d2bdb0685e65b9cd784d3e563" class="src_link" title="../models/annotations/comment.rb">../models/annotations/comment.rb</a></td>
        <td class="green strong">90.7 %</td>
        <td>77</td>
        <td>43</td>
        <td>39</td>
        <td>4</td>
        <td>55.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b9eb383cef3e525b78ec25556e5e622091e970b5" class="src_link" title="../models/annotations/dynamic.rb">../models/annotations/dynamic.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>106</td>
        <td>60</td>
        <td>60</td>
        <td>0</td>
        <td>15.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6990b385898921bc3e78b9461981d1b486561be9" class="src_link" title="../models/annotations/embed.rb">../models/annotations/embed.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>65</td>
        <td>38</td>
        <td>38</td>
        <td>0</td>
        <td>47.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f8abb75e1a2e28109963dd40be7c8e6658ea993f" class="src_link" title="../models/annotations/flag.rb">../models/annotations/flag.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>19</td>
        <td>19</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#63dc70a62cd20a38eb7f5afb4207edc4ad22d818" class="src_link" title="../models/annotations/status.rb">../models/annotations/status.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>119</td>
        <td>65</td>
        <td>65</td>
        <td>0</td>
        <td>362.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ee3b2e03d75af753c3c188173427c4cc40690014" class="src_link" title="../models/annotations/tag.rb">../models/annotations/tag.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>45</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>13.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7d22773707e4a69bb16bf302130a66e850a62e0" class="src_link" title="../models/annotations/task.rb">../models/annotations/task.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>129</td>
        <td>70</td>
        <td>70</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b6b59f4ff888ef6ea9487a9185078d04c31e62e3" class="src_link" title="../models/api_key.rb">../models/api_key.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>27</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>3.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f71d6556b512a66892d45117be9fe4c749192a19" class="src_link" title="../models/bot.rb">../models/bot.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8921f3293fd57be4af7c9b962257d36c9b6da762" class="src_link" title="../models/bounce.rb">../models/bounce.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>119.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d9ba5a0035c64322dee16d249283ffddea93cc5e" class="src_link" title="../models/claim.rb">../models/claim.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#75a92083bcaf99cdb20ff3f398eda1c53dc2082b" class="src_link" title="../models/concerns/annotation_base.rb">../models/concerns/annotation_base.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>255</td>
        <td>149</td>
        <td>149</td>
        <td>0</td>
        <td>564.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#be8643e296f5cc0ce2c559640b75be969504ff9c" class="src_link" title="../models/concerns/check_elastic_search_model.rb">../models/concerns/check_elastic_search_model.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>82</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>406.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5cf765db826269aee89547b8b67f3c5f69483758" class="src_link" title="../models/concerns/singleton_annotation_base.rb">../models/concerns/singleton_annotation_base.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>103.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b99d3c6215364c93afba58a43a5c46a4d9e84b30" class="src_link" title="../models/concerns/versioned.rb">../models/concerns/versioned.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>83.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7e40128b02941c0a83a7037470df0fbbb7dd02fe" class="src_link" title="../models/contact.rb">../models/contact.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a70a3e982d25e9e446c5cba2adc2378cae20642" class="src_link" title="../models/dynamic_annotation.rb">../models/dynamic_annotation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#671bf174271bfb71d29fa72bf80498036c0537d4" class="src_link" title="../models/dynamic_annotation/annotation_type.rb">../models/dynamic_annotation/annotation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>18.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5eff9284892f3ecbe23daf42f6c9ae94cf2e88e1" class="src_link" title="../models/dynamic_annotation/field.rb">../models/dynamic_annotation/field.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>7.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9a27f34ff1d68452443f2df18147af0d536dfeda" class="src_link" title="../models/dynamic_annotation/field_instance.rb">../models/dynamic_annotation/field_instance.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c59f4a7753b4947479cb46c9572a751b75c290af" class="src_link" title="../models/dynamic_annotation/field_type.rb">../models/dynamic_annotation/field_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c58c801b65c00b8ae2851bb0ca46657408e5336" class="src_link" title="../models/link.rb">../models/link.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>43</td>
        <td>26</td>
        <td>26</td>
        <td>0</td>
        <td>154.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a36420c425896c79cfb738a58e59151d38966a6a" class="src_link" title="../models/media.rb">../models/media.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>76</td>
        <td>42</td>
        <td>42</td>
        <td>0</td>
        <td>103.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ed14b2241f62604d1979262fe25b6566376d70df" class="src_link" title="../models/project.rb">../models/project.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>92</td>
        <td>51</td>
        <td>51</td>
        <td>0</td>
        <td>382.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#018645750caab849ffc8c046d36609a27913e7c9" class="src_link" title="../models/project_media.rb">../models/project_media.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>274</td>
        <td>172</td>
        <td>172</td>
        <td>0</td>
        <td>67.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8b210e5ce38e68c88483135b05a8cec4c0494c90" class="src_link" title="../models/project_source.rb">../models/project_source.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1ff24a3a20e4469d85f8504e0a64fe6799d255bc" class="src_link" title="../models/root_level.rb">../models/root_level.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b270baf8337df92dec8f6b1b7a0cc6e23eea6d18" class="src_link" title="../models/search/comment_search.rb">../models/search/comment_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dc0e2c42b7a3f5ac9e5815eaaf4e2c32f0f8f665" class="src_link" title="../models/search/dynamic_search.rb">../models/search/dynamic_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0e3b59e250237f0beb297e5b58af12e0ed7a038a" class="src_link" title="../models/search/media_search.rb">../models/search/media_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>17.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d5ecefc7af32a1dbd18f2e7f9217605250164f0" class="src_link" title="../models/search/tag_search.rb">../models/search/tag_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e99d048c239a2368822ce6af1f081dbda7fa12a0" class="src_link" title="../models/source.rb">../models/source.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>54</td>
        <td>31</td>
        <td>31</td>
        <td>0</td>
        <td>130.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#71b9adc3090ff3c43d0d7e55aaab936d62d43a9b" class="src_link" title="../models/team.rb">../models/team.rb</a></td>
        <td class="green strong">99.03 %</td>
        <td>182</td>
        <td>103</td>
        <td>102</td>
        <td>1</td>
        <td>253.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#daf3cc08eef40d66411e0ae6a531b961f544e1dd" class="src_link" title="../models/team_user.rb">../models/team_user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>76</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>56.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#227095a68c55b053e6b5111362ae3cff24b02f4a" class="src_link" title="../models/uploaded_file.rb">../models/uploaded_file.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fef511b3fcaffc59a16d70d0b6840bd64f3dc31a" class="src_link" title="../models/uploaded_image.rb">../models/uploaded_image.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4a07c80a4841a4bea1d05c6d98daf9bb801c62d0" class="src_link" title="../models/user.rb">../models/user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>233</td>
        <td>132</td>
        <td>132</td>
        <td>0</td>
        <td>1162.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#30d53ee2aa3321074474db3ab50320d46b7baa79" class="src_link" title="../uploaders/file_uploader.rb">../uploaders/file_uploader.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>675.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2afedd0e87563af538aaaea2579b801de288f12d" class="src_link" title="../uploaders/image_uploader.rb">../uploaders/image_uploader.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>1658.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#789a1cc02a6652558f6c0d5da3b33fa4fc62d731" class="src_link" title="../workers/elastic_search_worker.rb">../workers/elastic_search_worker.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>91.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ac87e23493e0c267a9788647e0d02eb62392155a" class="src_link" title="lib/api_constraints.rb">lib/api_constraints.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>214.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#47666e090b628bfe1fd07353da6f91c909228d28" class="src_link" title="lib/check_elastic_search.rb">lib/check_elastic_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>65</td>
        <td>41</td>
        <td>41</td>
        <td>0</td>
        <td>72.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#37fb467436bcf6e2d5b947053ffdc98c8ac3f9aa" class="src_link" title="lib/check_notifications/pusher.rb">lib/check_notifications/pusher.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>78</td>
        <td>42</td>
        <td>42</td>
        <td>0</td>
        <td>1022.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c39888abbd831c7d2f81173dad57673905574247" class="src_link" title="lib/check_notifications/slack.rb">lib/check_notifications/slack.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>87</td>
        <td>46</td>
        <td>46</td>
        <td>0</td>
        <td>356.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7553b062377d88a7112f9dd2ea358ddef05faeef" class="src_link" title="lib/check_permissions.rb">lib/check_permissions.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>112</td>
        <td>62</td>
        <td>62</td>
        <td>0</td>
        <td>363.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a0158b47b9d235a35765159dcc2ef6728d86e0c2" class="src_link" title="lib/check_search.rb">lib/check_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>77</td>
        <td>45</td>
        <td>45</td>
        <td>0</td>
        <td>38.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#86d675b34054456747cff5841d114c25f322c775" class="src_link" title="lib/check_settings.rb">lib/check_settings.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>34</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>2638.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c1c533dfd87dbae279c339d93dd6ad2c2010c68" class="src_link" title="lib/devise_async.rb">lib/devise_async.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>35</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#097423e39de73a9e25c56fe24c0b574fff977719" class="src_link" title="lib/error_codes.rb">lib/error_codes.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1bf077e64a6eddad880ad3a7362435cac1a154cf" class="src_link" title="lib/included_validator.rb">lib/included_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>751.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fae1396ffcf3e3b04e8d96b0c89a9e6a15d3644a" class="src_link" title="lib/lapis_webhook.rb">lib/lapis_webhook.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5bd729ae741be8f577c048923b094d692051b899" class="src_link" title="lib/machine_name_validator.rb">lib/machine_name_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>46.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#64fca552e32de9dd0fe9f39b9d08cd82bca892a8" class="src_link" title="lib/pender_data.rb">lib/pender_data.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>842.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cb44bb32b2c7de6371aaea084349d6e627b72d05" class="src_link" title="lib/safe_validator.rb">lib/safe_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e5e5b06c5124b5b219bc0791188bf341f4b56ee2" class="src_link" title="lib/size_validator.rb">lib/size_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>23</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>2520.6</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent"><span class="green">97.81%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         46.91
       </span>
    </span> hits/line)
  </h2>
  <a name="Controllers"></a>
  <div>
    <b>10</b> files in total.
    <b>228</b> relevant lines. 
    <span class="green"><b>223</b> lines covered</span> and
    <span class="red"><b>5</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#e6a365ade5ce357634f8a4ac5eecd58f6032e0f3" class="src_link" title="../controllers/api/v1/base_api_controller.rb">../controllers/api/v1/base_api_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>109</td>
        <td>62</td>
        <td>62</td>
        <td>0</td>
        <td>130.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5a7aa5a00ae3184898111bab3418a728a889e04e" class="src_link" title="../controllers/api/v1/confirmations_controller.rb">../controllers/api/v1/confirmations_controller.rb</a></td>
        <td class="red strong">50.0 %</td>
        <td>14</td>
        <td>10</td>
        <td>5</td>
        <td>5</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c41a5340f4ead1a3cce0a477d1689b5fd33a5a66" class="src_link" title="../controllers/api/v1/graphql_controller.rb">../controllers/api/v1/graphql_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>62</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>53.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#35e65069b1196d58de29c8083524fd68a2a4147a" class="src_link" title="../controllers/api/v1/omniauth_callbacks_controller.rb">../controllers/api/v1/omniauth_callbacks_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>46</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>4.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c51f03642b48922e66273be6220eb78075d2dbd2" class="src_link" title="../controllers/api/v1/registrations_controller.rb">../controllers/api/v1/registrations_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>62</td>
        <td>34</td>
        <td>34</td>
        <td>0</td>
        <td>2.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#05c9618673218b1493595b8a722622e8011dd95e" class="src_link" title="../controllers/api/v1/sessions_controller.rb">../controllers/api/v1/sessions_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>34</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>4.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#67d8f4f56b98a41ec0384f715547f7e146b97d14" class="src_link" title="../controllers.lication_controller.rb">../controllers.lication_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>41</td>
        <td>21</td>
        <td>21</td>
        <td>0</td>
        <td>7.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7f6a5a6f7593e805497379b51ce0d79ed7bc02d" class="src_link" title="../controllers/concerns/facebook_authentication.rb">../controllers/concerns/facebook_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>2.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9cff0f08721bd13a85752f13dd9ea537bbe42d63" class="src_link" title="../controllers/concerns/slack_authentication.rb">../controllers/concerns/slack_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0971008d6a7a8d61a699db0753ee876b1bdea4f3" class="src_link" title="../controllers/concerns/twitter_authentication.rb">../controllers/concerns/twitter_authentication.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.8</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent"><span class="green">99.66%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         331.37
       </span>
    </span> hits/line)
  </h2>
  <a name="Models"></a>
  <div>
    <b>40</b> files in total.
    <b>1456</b> relevant lines. 
    <span class="green"><b>1451</b> lines covered</span> and
    <span class="red"><b>5</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#08d679bc80659fb3262f22814c1b10fcd271779d" class="src_link" title="../models/ability.rb">../models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>220</td>
        <td>145</td>
        <td>145</td>
        <td>0</td>
        <td>837.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8765507dc9f9bb69a1e07a3294d9757176206216" class="src_link" title="../models/account.rb">../models/account.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>67</td>
        <td>43</td>
        <td>43</td>
        <td>0</td>
        <td>78.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#710341af2263a38e8fb9ba4cbe838124ba0e0371" class="src_link" title="../models/annotations/annotation.rb">../models/annotations/annotation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>9.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c3ed09ae7ebff52d2bdb0685e65b9cd784d3e563" class="src_link" title="../models/annotations/comment.rb">../models/annotations/comment.rb</a></td>
        <td class="green strong">90.7 %</td>
        <td>77</td>
        <td>43</td>
        <td>39</td>
        <td>4</td>
        <td>55.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b9eb383cef3e525b78ec25556e5e622091e970b5" class="src_link" title="../models/annotations/dynamic.rb">../models/annotations/dynamic.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>106</td>
        <td>60</td>
        <td>60</td>
        <td>0</td>
        <td>15.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6990b385898921bc3e78b9461981d1b486561be9" class="src_link" title="../models/annotations/embed.rb">../models/annotations/embed.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>65</td>
        <td>38</td>
        <td>38</td>
        <td>0</td>
        <td>47.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f8abb75e1a2e28109963dd40be7c8e6658ea993f" class="src_link" title="../models/annotations/flag.rb">../models/annotations/flag.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>19</td>
        <td>19</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#63dc70a62cd20a38eb7f5afb4207edc4ad22d818" class="src_link" title="../models/annotations/status.rb">../models/annotations/status.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>119</td>
        <td>65</td>
        <td>65</td>
        <td>0</td>
        <td>362.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ee3b2e03d75af753c3c188173427c4cc40690014" class="src_link" title="../models/annotations/tag.rb">../models/annotations/tag.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>45</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>13.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7d22773707e4a69bb16bf302130a66e850a62e0" class="src_link" title="../models/annotations/task.rb">../models/annotations/task.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>129</td>
        <td>70</td>
        <td>70</td>
        <td>0</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b6b59f4ff888ef6ea9487a9185078d04c31e62e3" class="src_link" title="../models/api_key.rb">../models/api_key.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>27</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>3.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f71d6556b512a66892d45117be9fe4c749192a19" class="src_link" title="../models/bot.rb">../models/bot.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8921f3293fd57be4af7c9b962257d36c9b6da762" class="src_link" title="../models/bounce.rb">../models/bounce.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>119.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d9ba5a0035c64322dee16d249283ffddea93cc5e" class="src_link" title="../models/claim.rb">../models/claim.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>2</td>
        <td>2</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#75a92083bcaf99cdb20ff3f398eda1c53dc2082b" class="src_link" title="../models/concerns/annotation_base.rb">../models/concerns/annotation_base.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>255</td>
        <td>149</td>
        <td>149</td>
        <td>0</td>
        <td>564.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#be8643e296f5cc0ce2c559640b75be969504ff9c" class="src_link" title="../models/concerns/check_elastic_search_model.rb">../models/concerns/check_elastic_search_model.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>82</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>406.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5cf765db826269aee89547b8b67f3c5f69483758" class="src_link" title="../models/concerns/singleton_annotation_base.rb">../models/concerns/singleton_annotation_base.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>103.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b99d3c6215364c93afba58a43a5c46a4d9e84b30" class="src_link" title="../models/concerns/versioned.rb">../models/concerns/versioned.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>83.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7e40128b02941c0a83a7037470df0fbbb7dd02fe" class="src_link" title="../models/contact.rb">../models/contact.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a70a3e982d25e9e446c5cba2adc2378cae20642" class="src_link" title="../models/dynamic_annotation.rb">../models/dynamic_annotation.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#671bf174271bfb71d29fa72bf80498036c0537d4" class="src_link" title="../models/dynamic_annotation/annotation_type.rb">../models/dynamic_annotation/annotation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>18.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5eff9284892f3ecbe23daf42f6c9ae94cf2e88e1" class="src_link" title="../models/dynamic_annotation/field.rb">../models/dynamic_annotation/field.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>7.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9a27f34ff1d68452443f2df18147af0d536dfeda" class="src_link" title="../models/dynamic_annotation/field_instance.rb">../models/dynamic_annotation/field_instance.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c59f4a7753b4947479cb46c9572a751b75c290af" class="src_link" title="../models/dynamic_annotation/field_type.rb">../models/dynamic_annotation/field_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>5</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c58c801b65c00b8ae2851bb0ca46657408e5336" class="src_link" title="../models/link.rb">../models/link.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>43</td>
        <td>26</td>
        <td>26</td>
        <td>0</td>
        <td>154.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a36420c425896c79cfb738a58e59151d38966a6a" class="src_link" title="../models/media.rb">../models/media.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>76</td>
        <td>42</td>
        <td>42</td>
        <td>0</td>
        <td>103.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ed14b2241f62604d1979262fe25b6566376d70df" class="src_link" title="../models/project.rb">../models/project.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>92</td>
        <td>51</td>
        <td>51</td>
        <td>0</td>
        <td>382.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#018645750caab849ffc8c046d36609a27913e7c9" class="src_link" title="../models/project_media.rb">../models/project_media.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>274</td>
        <td>172</td>
        <td>172</td>
        <td>0</td>
        <td>67.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8b210e5ce38e68c88483135b05a8cec4c0494c90" class="src_link" title="../models/project_source.rb">../models/project_source.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1ff24a3a20e4469d85f8504e0a64fe6799d255bc" class="src_link" title="../models/root_level.rb">../models/root_level.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b270baf8337df92dec8f6b1b7a0cc6e23eea6d18" class="src_link" title="../models/search/comment_search.rb">../models/search/comment_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dc0e2c42b7a3f5ac9e5815eaaf4e2c32f0f8f665" class="src_link" title="../models/search/dynamic_search.rb">../models/search/dynamic_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0e3b59e250237f0beb297e5b58af12e0ed7a038a" class="src_link" title="../models/search/media_search.rb">../models/search/media_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>17.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d5ecefc7af32a1dbd18f2e7f9217605250164f0" class="src_link" title="../models/search/tag_search.rb">../models/search/tag_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e99d048c239a2368822ce6af1f081dbda7fa12a0" class="src_link" title="../models/source.rb">../models/source.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>54</td>
        <td>31</td>
        <td>31</td>
        <td>0</td>
        <td>130.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#71b9adc3090ff3c43d0d7e55aaab936d62d43a9b" class="src_link" title="../models/team.rb">../models/team.rb</a></td>
        <td class="green strong">99.03 %</td>
        <td>182</td>
        <td>103</td>
        <td>102</td>
        <td>1</td>
        <td>253.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#daf3cc08eef40d66411e0ae6a531b961f544e1dd" class="src_link" title="../models/team_user.rb">../models/team_user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>76</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>56.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#227095a68c55b053e6b5111362ae3cff24b02f4a" class="src_link" title="../models/uploaded_file.rb">../models/uploaded_file.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>20</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fef511b3fcaffc59a16d70d0b6840bd64f3dc31a" class="src_link" title="../models/uploaded_image.rb">../models/uploaded_image.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4a07c80a4841a4bea1d05c6d98daf9bb801c62d0" class="src_link" title="../models/user.rb">../models/user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>233</td>
        <td>132</td>
        <td>132</td>
        <td>0</td>
        <td>1162.5</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         65.16
       </span>
    </span> hits/line)
  </h2>
  <a name="Mailers"></a>
  <div>
    <b>4</b> files in total.
    <b>47</b> relevant lines. 
    <span class="green"><b>47</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#db1bc6aef95690a1f3b4d378c7f61adc8b8d50a4" class="src_link" title="../mailers.lication_mailer.rb">../mailers.lication_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>4</td>
        <td>3</td>
        <td>3</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#68c1c75256e1d86bfb576e0defd12c8208941b75" class="src_link" title="../mailers/devise_mailer.rb">../mailers/devise_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#40e27a71083e7ac9eb11b55ff70ac7cb6c81c15c" class="src_link" title="../mailers/registration_mailer.rb">../mailers/registration_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#758047c0a649f0af11671ed66f60b0c926f1bd0a" class="src_link" title="../mailers/team_user_mailer.rb">../mailers/team_user_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>25</td>
        <td>25</td>
        <td>0</td>
        <td>121.0</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Helpers"></a>
  <div>
    <b>0</b> files in total.
    <b>0.0</b> relevant lines. 
    <span class="green"><b>0.0</b> lines covered</span> and
    <span class="red"><b>0.0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Jobs">
  <h2>
    <span class="group_name">Jobs</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         91.8
       </span>
    </span> hits/line)
  </h2>
  <a name="Jobs"></a>
  <div>
    <b>1</b> files in total.
    <b>11</b> relevant lines. 
    <span class="green"><b>11</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#789a1cc02a6652558f6c0d5da3b33fa4fc62d731" class="src_link" title="../workers/elastic_search_worker.rb">../workers/elastic_search_worker.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>91.8</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         518.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Libraries"></a>
  <div>
    <b>15</b> files in total.
    <b>356</b> relevant lines. 
    <span class="green"><b>356</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#ac87e23493e0c267a9788647e0d02eb62392155a" class="src_link" title="lib/api_constraints.rb">lib/api_constraints.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>214.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#47666e090b628bfe1fd07353da6f91c909228d28" class="src_link" title="lib/check_elastic_search.rb">lib/check_elastic_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>65</td>
        <td>41</td>
        <td>41</td>
        <td>0</td>
        <td>72.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#37fb467436bcf6e2d5b947053ffdc98c8ac3f9aa" class="src_link" title="lib/check_notifications/pusher.rb">lib/check_notifications/pusher.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>78</td>
        <td>42</td>
        <td>42</td>
        <td>0</td>
        <td>1022.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c39888abbd831c7d2f81173dad57673905574247" class="src_link" title="lib/check_notifications/slack.rb">lib/check_notifications/slack.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>87</td>
        <td>46</td>
        <td>46</td>
        <td>0</td>
        <td>356.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7553b062377d88a7112f9dd2ea358ddef05faeef" class="src_link" title="lib/check_permissions.rb">lib/check_permissions.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>112</td>
        <td>62</td>
        <td>62</td>
        <td>0</td>
        <td>363.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a0158b47b9d235a35765159dcc2ef6728d86e0c2" class="src_link" title="lib/check_search.rb">lib/check_search.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>77</td>
        <td>45</td>
        <td>45</td>
        <td>0</td>
        <td>38.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#86d675b34054456747cff5841d114c25f322c775" class="src_link" title="lib/check_settings.rb">lib/check_settings.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>34</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>2638.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c1c533dfd87dbae279c339d93dd6ad2c2010c68" class="src_link" title="lib/devise_async.rb">lib/devise_async.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>35</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#097423e39de73a9e25c56fe24c0b574fff977719" class="src_link" title="lib/error_codes.rb">lib/error_codes.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1bf077e64a6eddad880ad3a7362435cac1a154cf" class="src_link" title="lib/included_validator.rb">lib/included_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>751.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fae1396ffcf3e3b04e8d96b0c89a9e6a15d3644a" class="src_link" title="lib/lapis_webhook.rb">lib/lapis_webhook.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5bd729ae741be8f577c048923b094d692051b899" class="src_link" title="lib/machine_name_validator.rb">lib/machine_name_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>46.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#64fca552e32de9dd0fe9f39b9d08cd82bca892a8" class="src_link" title="lib/pender_data.rb">lib/pender_data.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>36</td>
        <td>23</td>
        <td>23</td>
        <td>0</td>
        <td>842.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cb44bb32b2c7de6371aaea084349d6e627b72d05" class="src_link" title="lib/safe_validator.rb">lib/safe_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e5e5b06c5124b5b219bc0791188bf341f4b56ee2" class="src_link" title="lib/size_validator.rb">lib/size_validator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>23</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>2520.6</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Ungrouped">
  <h2>
    <span class="group_name">Ungrouped</span>
    (<span class="covered_percent"><span class="green">99.74%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         35.65
       </span>
    </span> hits/line)
  </h2>
  <a name="Ungrouped"></a>
  <div>
    <b>46</b> files in total.
    <b>767</b> relevant lines. 
    <span class="green"><b>765</b> lines covered</span> and
    <span class="red"><b>2</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#782dc64cd6c7457a95a8164ca35f3ad320126641" class="src_link" title="../graph/mutations/account_mutations.rb">../graph/mutations/account_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bf861b227eecfbb0aa60b2ddec2b2a177b022103" class="src_link" title="../graph/mutations/annotation_mutations.rb">../graph/mutations/annotation_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3cf8e16e15c91ab6131bb456e9409bfd93aada85" class="src_link" title="../graph/mutations/comment_mutations.rb">../graph/mutations/comment_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#408cdd41190f5d277578abb33438231604e652fb" class="src_link" title="../graph/mutations/contact_mutations.rb">../graph/mutations/contact_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#04f9eabab43dd3ed7b99b9b389944a87d620f44b" class="src_link" title="../graph/mutations/dynamic_mutations.rb">../graph/mutations/dynamic_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f194fa39d6443f5d18faf8833225edcc6ca93593" class="src_link" title="../graph/mutations/flag_mutations.rb">../graph/mutations/flag_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3eb36527a8137891d5a630ad9a861a54b7d4b041" class="src_link" title="../graph/mutations/graphql_crud_operations.rb">../graph/mutations/graphql_crud_operations.rb</a></td>
        <td class="green strong">98.18 %</td>
        <td>212</td>
        <td>110</td>
        <td>108</td>
        <td>2</td>
        <td>16.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#83a9e5b858bb38eee5b1a3ba2f14a5e2fa187f34" class="src_link" title="../graph/mutations/project_media_mutations.rb">../graph/mutations/project_media_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a6637cff3c1c09b0c58914d6ba71d9f1fade3df4" class="src_link" title="../graph/mutations/project_mutations.rb">../graph/mutations/project_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9f0a73d04cb36feda0b218926798683547469b91" class="src_link" title="../graph/mutations/project_source_mutations.rb">../graph/mutations/project_source_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f4e4d1fa7215e9972142ac7e43e1e3d6985fd9ca" class="src_link" title="../graph/mutations/source_mutations.rb">../graph/mutations/source_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3d8fd8a60a8f48d8e1b5383e734797ea616ecaa6" class="src_link" title="../graph/mutations/status_mutations.rb">../graph/mutations/status_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#60fd57acb2b12b6c6dd8082d05275c6a733e2175" class="src_link" title="../graph/mutations/tag_mutations.rb">../graph/mutations/tag_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7915bed7bdcfe0826c2297a179cde7e3a4dba831" class="src_link" title="../graph/mutations/task_mutations.rb">../graph/mutations/task_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e890021ee6d068c38fbe4ecb1ca7a6d967d044a" class="src_link" title="../graph/mutations/team_mutations.rb">../graph/mutations/team_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5cacb506cf1c7b4bbd05d5d1b1123687082fe0f2" class="src_link" title="../graph/mutations/team_user_mutations.rb">../graph/mutations/team_user_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>18</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ec38efa5820c09471c33bee863a2f2ab56a03dd8" class="src_link" title="../graph/mutations/user_mutations.rb">../graph/mutations/user_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e37e35c30a5965cb9b1e4b67197ef80a4b72f005" class="src_link" title="../graph/mutations/version_mutations.rb">../graph/mutations/version_mutations.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#141df6a452b5edc99b8207b5d8f723322f8b6ccc" class="src_link" title="../graph/types/about_type.rb">../graph/types/about_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f03b3dbe0294a0c436dd2b178f7d3c0a9befc5bc" class="src_link" title="../graph/types/account_type.rb">../graph/types/account_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>38</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ba8a7247ec7e8e7838d2936c6b409770016b1762" class="src_link" title="../graph/types/annotation_type.rb">../graph/types/annotation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a67ffe45314b0fcc815c3bf02db26ee9c9a3eee8" class="src_link" title="../graph/types/annotator_type.rb">../graph/types/annotator_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#780847d8ef690ae6e58c8911207fca4bedb5d5ff" class="src_link" title="../graph/types/check_search_type.rb">../graph/types/check_search_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b851290a4189c7858b468480804da28b570dbab5" class="src_link" title="../graph/types/comment_type.rb">../graph/types/comment_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d0cf60f44d5e9117d84ce2e26af08a3e62c80ea1" class="src_link" title="../graph/types/contact_type.rb">../graph/types/contact_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>24</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#06fcfd737d1aea8c2cf39ccdf29777c4d99c6c47" class="src_link" title="../graph/types/dynamic_type.rb">../graph/types/dynamic_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#94b921bd0fb041012e9756d7e6534ee355d6c134" class="src_link" title="../graph/types/flag_type.rb">../graph/types/flag_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dbc14484c5291199518f29833e5819b110be4a8d" class="src_link" title="../graph/types/media_type.rb">../graph/types/media_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>19</td>
        <td>19</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dfb90ee1a2a9eefc02e05c595b554ac4d2146f25" class="src_link" title="../graph/types/mutation_type.rb">../graph/types/mutation_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>68</td>
        <td>49</td>
        <td>49</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8d4412fde968d01897317a90eafe735e60722098" class="src_link" title="../graph/types/node_identification.rb">../graph/types/node_identification.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>32</td>
        <td>22</td>
        <td>22</td>
        <td>0</td>
        <td>9.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7025d05f4e1feace4629b557adb334c5f6d8b1f4" class="src_link" title="../graph/types/project_media_type.rb">../graph/types/project_media_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>150</td>
        <td>79</td>
        <td>79</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#da726a5fedb93b3fd795c2a75a3a8416089868f3" class="src_link" title="../graph/types/project_source_type.rb">../graph/types/project_source_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>30</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#10d1a7e824cfe9101a780d06b999f8c8dc635403" class="src_link" title="../graph/types/project_type.rb">../graph/types/project_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>24</td>
        <td>24</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b569181384890401fa22991d906f9a5578f25e1d" class="src_link" title="../graph/types/public_team_type.rb">../graph/types/public_team_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aad14bf6d5125732ed3c0ddb316644ab9396c028" class="src_link" title="../graph/types/query_type.rb">../graph/types/query_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>112</td>
        <td>70</td>
        <td>70</td>
        <td>0</td>
        <td>3.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2e5cdec4050dccec9abca30d3ecaea58541edf2b" class="src_link" title="../graph/types/root_level_type.rb">../graph/types/root_level_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>83</td>
        <td>50</td>
        <td>50</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6549165ddd33f656fac17f7fc40c499e696ac522" class="src_link" title="../graph/types/source_type.rb">../graph/types/source_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>66</td>
        <td>38</td>
        <td>38</td>
        <td>0</td>
        <td>5.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#822e4ddba9b5ec4f6dec3c08e58b8b88a816b9cf" class="src_link" title="../graph/types/status_type.rb">../graph/types/status_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b624c21ffa164869d6a0900b217c369b4604a24f" class="src_link" title="../graph/types/tag_type.rb">../graph/types/tag_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a755198ebeff997a44d9630784ebb6091226ea91" class="src_link" title="../graph/types/task_type.rb">../graph/types/task_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#828d7ed4a3766f96c8727f33d9bcd363217d3041" class="src_link" title="../graph/types/team_type.rb">../graph/types/team_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>64</td>
        <td>41</td>
        <td>41</td>
        <td>0</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a39a1b1b400f78ebc30c6ecb25c5c211e17b17aa" class="src_link" title="../graph/types/team_user_type.rb">../graph/types/team_user_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#88d168229627a1bc70ca5f36aaa82c76e7a99ee2" class="src_link" title="../graph/types/user_type.rb">../graph/types/user_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>42</td>
        <td>27</td>
        <td>27</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#575c07c36a90f26475f8f106d5289f3dd0b7329e" class="src_link" title="../graph/types/version_type.rb">../graph/types/version_type.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>47</td>
        <td>29</td>
        <td>29</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#30d53ee2aa3321074474db3ab50320d46b7baa79" class="src_link" title="../uploaders/file_uploader.rb">../uploaders/file_uploader.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>7</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>675.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2afedd0e87563af538aaaea2579b801de288f12d" class="src_link" title="../uploaders/image_uploader.rb">../uploaders/image_uploader.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>1658.8</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.12.0 
        and simplecov-html v0.10.0<br/>
        using MiniTest
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="e6a365ade5ce357634f8a4ac5eecd58f6032e0f3">
  <div class="header">
    <h3>../controllers/api/v1/base_api_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>62</b> relevant lines. 
      <span class="green"><b>62</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;error_codes&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">module Api</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  module V1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    class BaseApiController &lt; ApplicationController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      include BaseDoc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      before_filter :remove_empty_params_and_headers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">      before_filter :set_custom_response_headers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      before_filter :authenticate_from_token!, except: [:me, :options]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      before_action :set_paper_trail_whodunnit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      # Verify payload for webhook methods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      # before_filter :verify_payload!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">      respond_to :json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      def version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">        name = &quot;#{Rails.application.class.parent_name} v#{VERSION}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">        render_success &#39;version&#39;, name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">      def me</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="24">
          <span class="hits">5</span>
          
          <code class="ruby">        header = CONFIG[&#39;authorization_header&#39;] || &#39;X-Token&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="25">
          <span class="hits">5</span>
          
          <code class="ruby">        token = request.headers[header]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="27">
          <span class="hits">5</span>
          
          <code class="ruby">        if session[&#39;check.error&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">          message = session[&#39;check.error&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">          reset_session</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">          render_error(message, &#39;UNKNOWN&#39;) and return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">        if token</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">          render_user User.where(token: token).last, &#39;token&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">          render_user current_api_user, &#39;session&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      # Needed for pre-flight check</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">      def options</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">        render text: &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">      private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">      def render_user(user = nil, source = nil)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="48">
          <span class="hits">4</span>
          
          <code class="ruby">        unless user.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="49">
          <span class="hits">3</span>
          
          <code class="ruby">          user = user.as_json</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="50">
          <span class="hits">3</span>
          
          <code class="ruby">          user[:source] = source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="53">
          <span class="hits">4</span>
          
          <code class="ruby">        render_success &#39;user&#39;, user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">      def authenticate_from_token!</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="57">
          <span class="hits">8</span>
          
          <code class="ruby">        header = CONFIG[&#39;authorization_header&#39;] || &#39;X-Token&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="58">
          <span class="hits">8</span>
          
          <code class="ruby">        token = request.headers[header]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="59">
          <span class="hits">8</span>
          
          <code class="ruby">        key = ApiKey.where(access_token: token).where(&#39;expire_at &gt; ?&#39;, Time.now).exists?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="60">
          <span class="hits">8</span>
          
          <code class="ruby">        (render_unauthorized and return false) unless key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      # User token or session</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">      def authenticate_user!</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="65">
          <span class="hits">113</span>
          
          <code class="ruby">        header = CONFIG[&#39;authorization_header&#39;] || &#39;X-Token&#39;</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="66">
          <span class="hits">113</span>
          
          <code class="ruby">        token = request.headers[header].to_s</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="67">
          <span class="hits">113</span>
          
          <code class="ruby">        user = User.where(token: token).last</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="68">
          <span class="hits">113</span>
          
          <code class="ruby">        User.current = user</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="69">
          <span class="hits">113</span>
          
          <code class="ruby">        (token &amp;&amp; user) ? sign_in(user, store: false) : authenticate_api_user!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">      def verify_payload!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="73">
          <span class="hits">3</span>
          
          <code class="ruby">        begin</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="74">
          <span class="hits">3</span>
          
          <code class="ruby">          payload = request.raw_post</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="75">
          <span class="hits">3</span>
          
          <code class="ruby">          if verify_signature(payload)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">            @payload = JSON.parse(payload)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">            render_unauthorized and return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">        rescue</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">          render_error(&#39;Could not verify payload&#39;, &#39;UNKNOWN&#39;) and return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">      def verify_signature(payload)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="86">
          <span class="hits">3</span>
          
          <code class="ruby">        signature = &#39;sha1=&#39; + OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new(&#39;sha1&#39;), CONFIG[&#39;secret_token&#39;].to_s, payload)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">        Rack::Utils.secure_compare(signature, request.headers[&#39;X-Signature&#39;].to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">      def get_params</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="91">
          <span class="hits">7</span>
          
          <code class="ruby">        params.reject{ |k, _v| [&#39;id&#39;, &#39;action&#39;, &#39;controller&#39;, &#39;format&#39;].include?(k) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">      def remove_empty_params_and_headers</code>
        </li>
      
        <li class="covered" data-hits="535" data-linenumber="95">
          <span class="hits">535</span>
          
          <code class="ruby">        params.reject!{ |_k, v| v.blank? }</code>
        </li>
      
        <li class="covered" data-hits="6370" data-linenumber="96">
          <span class="hits">6370</span>
          
          <code class="ruby">        request.headers.each{ |k, v| request.headers[k] = nil if (k =~ /HTTP_/).present? &amp;&amp; v.blank? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">      def set_custom_response_headers</code>
        </li>
      
        <li class="covered" data-hits="130" data-linenumber="100">
          <span class="hits">130</span>
          
          <code class="ruby">        response.headers[&#39;X-Build&#39;] = BUILD</code>
        </li>
      
        <li class="covered" data-hits="130" data-linenumber="101">
          <span class="hits">130</span>
          
          <code class="ruby">        response.headers[&#39;Accept&#39;] ||= ApiConstraints.accept(1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">      def user_for_paper_trail</code>
        </li>
      
        <li class="covered" data-hits="247" data-linenumber="105">
          <span class="hits">247</span>
          
          <code class="ruby">        current_api_user.id unless current_api_user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5a7aa5a00ae3184898111bab3418a728a889e04e">
  <div class="header">
    <h3>../controllers/api/v1/confirmations_controller.rb</h3>
    <h4><span class="red">50.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Api::V1::ConfirmationsController &lt; Devise::ConfirmationsController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def show</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    valid_host = params[:client_host].to_s == CONFIG[&#39;checkdesk_client&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="4">
          <span class="hits">4</span>
          
          <code class="ruby">    if valid_host</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">      User.current = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">      User.current = self.resource = resource_class.confirm_by_token(params[:confirmation_token])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">      yield resource if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      path = resource.errors.empty? ? &#39;/check/user/confirmed&#39; : &#39;/check/user/unconfirmed&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      redirect_to CONFIG[&#39;checkdesk_client&#39;] + path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">      render_error(&#39;Unrecognized client&#39;, &#39;INVALID_VALUE&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c41a5340f4ead1a3cce0a477d1689b5fd33a5a66">
  <div class="header">
    <h3>../controllers/api/v1/graphql_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Api</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module V1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    class GraphqlController &lt; Api::V1::BaseApiController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">      include GraphqlDoc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      skip_before_filter :authenticate_from_token!</code>
        </li>
      
        <li class="covered" data-hits="114" data-linenumber="7">
          <span class="hits">114</span>
          
          <code class="ruby">      before_action :authenticate_user!, only: [:create], if: -&gt; { params[:query].to_s.match(/^query About/).nil? }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      before_action :set_current_user, :load_context_team, :set_current_team, :load_ability</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      def create</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="11">
          <span class="hits">112</span>
          
          <code class="ruby">        query_string = params[:query]</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="12">
          <span class="hits">112</span>
          
          <code class="ruby">        query_variables = ensure_hash(params[:variables]) || {}</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="13">
          <span class="hits">112</span>
          
          <code class="ruby">        query_variables = {} if query_variables == &#39;null&#39;</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="14">
          <span class="hits">112</span>
          
          <code class="ruby">        debug = !!CONFIG[&#39;graphql_debug&#39;]</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="15">
          <span class="hits">112</span>
          
          <code class="ruby">        begin</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="16">
          <span class="hits">112</span>
          
          <code class="ruby">          query = GraphQL::Query.new(RelayOnRailsSchema, query_string, variables: query_variables, debug: debug, context: {ability: @ability, file: request.params[:file] })</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="17">
          <span class="hits">112</span>
          
          <code class="ruby">          render json: query.result</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="18">
          <span class="hits">5</span>
          
          <code class="ruby">        rescue ActiveRecord::RecordInvalid, RuntimeError, ActiveRecord::RecordNotUnique =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">          render json: { error: e.message }, status: 400</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">        rescue CheckPermissions::AccessDenied =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">          render json: { error: e.message }, status: 403</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">        rescue ActiveRecord::RecordNotFound =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">          render json: { error: e.message }, status: 404</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      # If the request wasn&#39;t `Content-Type: application/json`, parse the variables</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">      def ensure_hash(variables_param)</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="31">
          <span class="hits">112</span>
          
          <code class="ruby">        return {} if variables_param.blank?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">        variables_param.kind_of?(Hash) ? variables_param : JSON.parse(variables_param)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">      private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">      def load_ability</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="38">
          <span class="hits">112</span>
          
          <code class="ruby">        @ability = Ability.new if User.current.present? &amp;&amp; Team.current.present?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">      def set_current_user</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="42">
          <span class="hits">112</span>
          
          <code class="ruby">        User.current = current_api_user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">      def load_context_team</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="46">
          <span class="hits">112</span>
          
          <code class="ruby">        @context_team = nil</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="47">
          <span class="hits">112</span>
          
          <code class="ruby">        slug = request.params[&#39;team&#39;]</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="48">
          <span class="hits">112</span>
          
          <code class="ruby">        @context_team = Team.where(slug: slug).first unless slug.blank?</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="49">
          <span class="hits">112</span>
          
          <code class="ruby">        log = @context_team.nil? ? &#39;No context team&#39; : &quot;Context team is #{@context_team.name}&quot;</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="50">
          <span class="hits">112</span>
          
          <code class="ruby">        logger.info message: log, context_team: @context_team</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="51">
          <span class="hits">112</span>
          
          <code class="ruby">        Team.current = @context_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">      def set_current_team</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="55">
          <span class="hits">112</span>
          
          <code class="ruby">        if !current_api_user.nil? &amp;&amp; !@context_team.nil? &amp;&amp; current_api_user.is_member_of?(@context_team) &amp;&amp; current_api_user.current_team_id != @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="56">
          <span class="hits">16</span>
          
          <code class="ruby">          current_api_user.current_team_id = @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="57">
          <span class="hits">16</span>
          
          <code class="ruby">          current_api_user.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="35e65069b1196d58de29c8083524fd68a2a4147a">
  <div class="header">
    <h3>../controllers/api/v1/omniauth_callbacks_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Api</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module V1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">      include TwitterAuthentication</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">      include FacebookAuthentication</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      include SlackAuthentication</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      def logout</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">        sign_out current_api_user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">        User.current = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">        destination = params[:destination] || &#39;/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">        redirect_to destination</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      def failure</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">        redirect_to &#39;/close.html&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">      protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      def start_session_and_redirect</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="22">
          <span class="hits">11</span>
          
          <code class="ruby">        auth = request.env[&#39;omniauth.auth&#39;]</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="23">
          <span class="hits">11</span>
          
          <code class="ruby">        user = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="25">
          <span class="hits">11</span>
          
          <code class="ruby">        begin</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="26">
          <span class="hits">11</span>
          
          <code class="ruby">          user = User.from_omniauth(auth)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">        rescue ActiveRecord::RecordInvalid =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">          session[&#39;check.error&#39;] = e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="31">
          <span class="hits">11</span>
          
          <code class="ruby">        unless user.nil?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="32">
          <span class="hits">10</span>
          
          <code class="ruby">          session[&#39;checkdesk.current_user_id&#39;] = user.id</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="33">
          <span class="hits">10</span>
          
          <code class="ruby">          User.current = user</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="34">
          <span class="hits">10</span>
          
          <code class="ruby">          sign_in(user)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="37">
          <span class="hits">11</span>
          
          <code class="ruby">        destination = params[:destination] || &#39;/api&#39;</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="38">
          <span class="hits">11</span>
          
          <code class="ruby">        if request.env.has_key?(&#39;omniauth.params&#39;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">          destination = request.env[&#39;omniauth.params&#39;][&#39;destination&#39;] unless request.env[&#39;omniauth.params&#39;][&#39;destination&#39;].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="42">
          <span class="hits">11</span>
          
          <code class="ruby">        redirect_to destination</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c51f03642b48922e66273be6220eb78075d2dbd2">
  <div class="header">
    <h3>../controllers/api/v1/registrations_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>34</b> relevant lines. 
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Api::V1::RegistrationsController &lt; Devise::RegistrationsController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  before_action :configure_sign_up_params, only: [:create]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  before_action :configure_account_update_params, only: [:update]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  respond_to :json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include RegistrationsDoc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # POST /resource</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    # super</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    build_resource(sign_up_params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="14">
          <span class="hits">8</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="15">
          <span class="hits">8</span>
          
          <code class="ruby">      User.current = resource</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="16">
          <span class="hits">8</span>
          
          <code class="ruby">      resource.save!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">      sign_up(resource_name, resource)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      render_success &#39;user&#39;, resource</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">    rescue ActiveRecord::RecordInvalid =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="20">
          <span class="hits">5</span>
          
          <code class="ruby">      clean_up_passwords resource</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="21">
          <span class="hits">5</span>
          
          <code class="ruby">      set_minimum_password_length</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="22">
          <span class="hits">5</span>
          
          <code class="ruby">      render_error e.message.gsub(/^Validation failed: Email /, &#39;&#39;), &#39;INVALID_VALUE&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # PUT /resource</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def update</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    # super</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    self.resource = resource_class.to_adapter.get!(send(:&quot;current_#{resource_name}&quot;).to_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    resource_updated = update_resource(resource, account_update_params)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    User.current = resource</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    if resource_updated</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">      sign_in resource, scope: resource_name, bypass_sign_in: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">      render_success &#39;user&#39;, resource</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      clean_up_passwords resource</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">      render_error &#39;Could not update user: &#39; + resource.errors.full_messages.join(&#39;, &#39;), &#39;INVALID_VALUE&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  # DELETE /resource</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    # super</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    resource.destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    render_success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  # If you have extra params to permit, append them to the sanitizer.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def configure_sign_up_params</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="55">
          <span class="hits">8</span>
          
          <code class="ruby">    devise_parameter_sanitizer.permit(:sign_up, keys: [:name, :login, :password, :password_confirmation, :image])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  # If you have extra params to permit, append them to the sanitizer.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def configure_account_update_params</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">    devise_parameter_sanitizer.permit(:account_update, keys: [:name, :password, :password_confirmation, :current_password])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="05c9618673218b1493595b8a722622e8011dd95e">
  <div class="header">
    <h3>../controllers/api/v1/sessions_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Api::V1::SessionsController &lt; Devise::SessionsController</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  before_action :configure_sign_in_params, only: [:create]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include SessionsDoc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # POST /resource/sign_in</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="8">
          <span class="hits">11</span>
          
          <code class="ruby">    User.current = nil</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="9">
          <span class="hits">11</span>
          
          <code class="ruby">    self.resource = warden.authenticate!(auth_options)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="10">
          <span class="hits">10</span>
          
          <code class="ruby">    sign_in(resource_name, resource)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="11">
          <span class="hits">10</span>
          
          <code class="ruby">    User.current = current_api_user</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="12">
          <span class="hits">10</span>
          
          <code class="ruby">    destination = params[:destination]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="13">
          <span class="hits">10</span>
          
          <code class="ruby">    destination ? redirect_to(URI.parse(destination).path) : render_success(&#39;user&#39;, current_api_user)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  # DELETE /resource/sign_out</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    User.current = nil</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name))</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    if signed_out</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      destination = params[:destination]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      destination ? redirect_to(URI.parse(destination).path) : render_success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      render_error(&#39;Could not logout&#39;, &#39;AUTH&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  # If you have extra params to permit, append them to the sanitizer.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def configure_sign_in_params</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="32">
          <span class="hits">11</span>
          
          <code class="ruby">    devise_parameter_sanitizer.permit(:sign_in, keys: [:login, :password])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="67d8f4f56b98a41ec0384f715547f7e146b97d14">
  <div class="header">
    <h3>../controllers.lication_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;error_codes&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include HttpAcceptLanguage::AutoLocale</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  protect_from_forgery with: :exception</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  skip_before_filter :verify_authenticity_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  rescue_from CanCan::AccessDenied do |_exception|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    redirect_to &#39;/403.html&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def authenticated?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="14">
          <span class="hits">9</span>
          
          <code class="ruby">    redirect_to(&#39;/&#39;) unless signed_in?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def render_success(type = &#39;success&#39;, object = nil)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="20">
          <span class="hits">21</span>
          
          <code class="ruby">    json = { type: type }</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="21">
          <span class="hits">21</span>
          
          <code class="ruby">    json[:data] = object unless object.nil?</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="22">
          <span class="hits">21</span>
          
          <code class="ruby">    render json: json, status: 200</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="23">
          <span class="hits">21</span>
          
          <code class="ruby">    logger.info message: json, status: 200</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def render_error(message, code, status = 400)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="27">
          <span class="hits">19</span>
          
          <code class="ruby">    render json: { type: &#39;error&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">                   data: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">                     message: message,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">                     code: LapisConstants::ErrorCodes::const_get(code)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">                   }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">                 },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">                 status: status</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="34">
          <span class="hits">19</span>
          
          <code class="ruby">    logger.error message: message, status: 400</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def render_unauthorized</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="38">
          <span class="hits">6</span>
          
          <code class="ruby">    render_error &#39;Unauthorized&#39;, &#39;UNAUTHORIZED&#39;, 401</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="39">
          <span class="hits">6</span>
          
          <code class="ruby">    logger.warn message: &#39;unauthorized&#39;, status: 401</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d7f6a5a6f7593e805497379b51ce0d79ed7bc02d">
  <div class="header">
    <h3>../controllers/concerns/facebook_authentication.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module FacebookAuthentication</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # OAuth callback</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def facebook</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="6">
          <span class="hits">5</span>
          
          <code class="ruby">    request.env[&#39;omniauth.auth&#39;][&#39;url&#39;] = &#39;https://facebook.com/&#39; + request.env[&#39;omniauth.auth&#39;].uid</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    start_session_and_redirect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9cff0f08721bd13a85752f13dd9ea537bbe42d63">
  <div class="header">
    <h3>../controllers/concerns/slack_authentication.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module SlackAuthentication</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # OAuth callback</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    start_session_and_redirect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0971008d6a7a8d61a699db0753ee876b1bdea4f3">
  <div class="header">
    <h3>../controllers/concerns/twitter_authentication.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module TwitterAuthentication</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # OAuth callback</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def twitter</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    request.env[&#39;omniauth.auth&#39;][&#39;url&#39;] = &#39;https://twitter.com/&#39; + request.env[&#39;omniauth.auth&#39;].info.nickname</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>
          
          <code class="ruby">    start_session_and_redirect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="782dc64cd6c7457a95a8164ca35f3ad320126641">
  <div class="header">
    <h3>../graph/mutations/account_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module AccountMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    url: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    source_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    user_id: &#39;int&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    url: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    source_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    user_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;account&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bf861b227eecfbb0aa60b2ddec2b2a177b022103">
  <div class="header">
    <h3>../graph/mutations/annotation_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module AnnotationMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    content: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotation_type: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    content: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotation_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;annotation&#39;, create_fields, update_fields, [&#39;source&#39;, &#39;project_media&#39;, &#39;project&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3cf8e16e15c91ab6131bb456e9409bfd93aada85">
  <div class="header">
    <h3>../graph/mutations/comment_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CommentMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    text: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    text: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;comment&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;, &#39;project&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="408cdd41190f5d277578abb33438231604e652fb">
  <div class="header">
    <h3>../graph/mutations/contact_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module ContactMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    location: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    phone: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    web: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    team_id: &#39;int&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    location: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    phone: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    web: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    team_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;contact&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="04f9eabab43dd3ed7b99b9b389944a87d620f44b">
  <div class="header">
    <h3>../graph/mutations/dynamic_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module DynamicMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    set_fields: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotation_type: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    set_fields: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotation_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;dynamic&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;, &#39;project&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f194fa39d6443f5d18faf8833225edcc6ca93593">
  <div class="header">
    <h3>../graph/mutations/flag_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module FlagMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    flag: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    flag: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;flag&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3eb36527a8137891d5a630ad9a861a54b7d4b041">
  <div class="header">
    <h3>../graph/mutations/graphql_crud_operations.rb</h3>
    <h4><span class="green">98.18 %</span> covered</h4>
    <div>
      <b>110</b> relevant lines. 
      <span class="green"><b>108</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GraphqlCrudOperations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.safe_save(obj, attrs, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="3">
          <span class="hits">28</span>
          
          <code class="ruby">    attrs.each do |key, value|</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="4">
          <span class="hits">54</span>
          
          <code class="ruby">      obj.send(&quot;#{key}=&quot;, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="6">
          <span class="hits">28</span>
          
          <code class="ruby">    obj.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="8">
          <span class="hits">27</span>
          
          <code class="ruby">    name = obj.class_name.underscore</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="9">
          <span class="hits">27</span>
          
          <code class="ruby">    ret = { name.to_sym =&gt; obj }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="11">
          <span class="hits">27</span>
          
          <code class="ruby">    parents.each do |parent_name|</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="12">
          <span class="hits">28</span>
          
          <code class="ruby">      child, parent = obj, obj.send(parent_name)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="13">
          <span class="hits">28</span>
          
          <code class="ruby">      unless parent.nil?</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="14">
          <span class="hits">23</span>
          
          <code class="ruby">        parent.no_cache = true</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="15">
          <span class="hits">23</span>
          
          <code class="ruby">        ret[&quot;#{name}Edge&quot;.to_sym] = GraphQL::Relay::Edge.between(child, parent)</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="16">
          <span class="hits">23</span>
          
          <code class="ruby">        ret[parent_name.to_sym] = parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="20">
          <span class="hits">27</span>
          
          <code class="ruby">    ret</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create(type, inputs, ctx, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="24">
          <span class="hits">18</span>
          
          <code class="ruby">    klass = type.camelize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="26">
          <span class="hits">18</span>
          
          <code class="ruby">    obj = klass.constantize.new</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="27">
          <span class="hits">18</span>
          
          <code class="ruby">    obj.file = ctx[:file] if type == &#39;project_media&#39; &amp;&amp; !ctx[:file].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="29">
          <span class="hits">18</span>
          
          <code class="ruby">    attrs = inputs.keys.inject({}) do |memo, key|</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="30">
          <span class="hits">62</span>
          
          <code class="ruby">      memo[key] = inputs[key] unless key == &quot;clientMutationId&quot;</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="31">
          <span class="hits">62</span>
          
          <code class="ruby">      memo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="34">
          <span class="hits">18</span>
          
          <code class="ruby">    self.safe_save(obj, attrs, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update(_type, inputs, ctx, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="38">
          <span class="hits">10</span>
          
          <code class="ruby">    obj = NodeIdentification.object_from_id(inputs[:id], ctx)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="39">
          <span class="hits">10</span>
          
          <code class="ruby">    obj = obj.load if obj.is_a?(Annotation)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="41">
          <span class="hits">10</span>
          
          <code class="ruby">    attrs = inputs.keys.inject({}) do |memo, key|</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="42">
          <span class="hits">30</span>
          
          <code class="ruby">      memo[key] = inputs[key] unless key == &quot;clientMutationId&quot; || key == &#39;id&#39;</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="43">
          <span class="hits">30</span>
          
          <code class="ruby">      memo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="46">
          <span class="hits">10</span>
          
          <code class="ruby">    self.safe_save(obj, attrs, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.destroy(inputs, _ctx, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="50">
          <span class="hits">10</span>
          
          <code class="ruby">    type, id = NodeIdentification.from_global_id(inputs[:id])</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="51">
          <span class="hits">10</span>
          
          <code class="ruby">    obj = type.constantize.find(id)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="52">
          <span class="hits">10</span>
          
          <code class="ruby">    obj = obj.load if obj.respond_to?(:load)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="53">
          <span class="hits">10</span>
          
          <code class="ruby">    obj.destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="55">
          <span class="hits">10</span>
          
          <code class="ruby">    ret = { deletedId: inputs[:id] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="57">
          <span class="hits">24</span>
          
          <code class="ruby">    parents.each { |parent| ret[parent.to_sym] = obj.send(parent) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="59">
          <span class="hits">10</span>
          
          <code class="ruby">    ret</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_create(type, create_fields, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="63">
          <span class="hits">17</span>
          
          <code class="ruby">    self.define_create_or_update(&#39;create&#39;, type, create_fields, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_update(type, update_fields, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="67">
          <span class="hits">17</span>
          
          <code class="ruby">    self.define_create_or_update(&#39;update&#39;, type, update_fields, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_create_or_update(action, type, fields, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="71">
          <span class="hits">34</span>
          
          <code class="ruby">    GraphQL::Relay::Mutation.define do</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="72">
          <span class="hits">34</span>
          
          <code class="ruby">      mapping = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">        &#39;str&#39;  =&gt; types.String,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">        &#39;!str&#39; =&gt; !types.String,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">        &#39;int&#39;  =&gt; types.Int,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">        &#39;!int&#39; =&gt; !types.Int,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">        &#39;id&#39;   =&gt; types.ID,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">        &#39;!id&#39;  =&gt; !types.ID,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">        &#39;bool&#39; =&gt; types.Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="82">
          <span class="hits">34</span>
          
          <code class="ruby">      name &quot;#{action.camelize}#{type.camelize}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="84">
          <span class="hits">34</span>
          
          <code class="ruby">      fields.each do |field_name, field_type|</code>
        </li>
      
        <li class="covered" data-hits="153" data-linenumber="85">
          <span class="hits">153</span>
          
          <code class="ruby">        input_field field_name, mapping[field_type]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="88">
          <span class="hits">34</span>
          
          <code class="ruby">      klass = &quot;#{type.camelize}Type&quot;.constantize</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="89">
          <span class="hits">34</span>
          
          <code class="ruby">      return_field type.to_sym, klass</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="91">
          <span class="hits">34</span>
          
          <code class="ruby">      parents.each do |parent|</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="92">
          <span class="hits">46</span>
          
          <code class="ruby">        return_field &quot;#{type}Edge&quot;.to_sym, klass.edge_type</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="93">
          <span class="hits">46</span>
          
          <code class="ruby">        return_field parent.to_sym, &quot;#{parent.gsub(/_was$/, &#39;&#39;).camelize}Type&quot;.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="96">
          <span class="hits">34</span>
          
          <code class="ruby">      resolve -&gt; (inputs, ctx) {</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="97">
          <span class="hits">28</span>
          
          <code class="ruby">        GraphqlCrudOperations.send(action, type, inputs, ctx, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_destroy(type, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="103">
          <span class="hits">17</span>
          
          <code class="ruby">    GraphQL::Relay::Mutation.define do</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="104">
          <span class="hits">17</span>
          
          <code class="ruby">      name &quot;Destroy#{type.camelize}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="106">
          <span class="hits">17</span>
          
          <code class="ruby">      input_field :id, !types.ID</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="108">
          <span class="hits">17</span>
          
          <code class="ruby">      return_field :deletedId, types.ID</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="109">
          <span class="hits">17</span>
          
          <code class="ruby">      parents.each do |parent|</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="110">
          <span class="hits">23</span>
          
          <code class="ruby">        return_field parent.to_sym, &quot;#{parent.gsub(/_was$/, &#39;&#39;).camelize}Type&quot;.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="113">
          <span class="hits">17</span>
          
          <code class="ruby">      resolve -&gt; (inputs, ctx) {</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="114">
          <span class="hits">10</span>
          
          <code class="ruby">        GraphqlCrudOperations.destroy(inputs, ctx, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_crud_operations(type, create_fields, update_fields = {}, parents = [])</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="120">
          <span class="hits">17</span>
          
          <code class="ruby">    update_fields = create_fields if update_fields.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    [</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="122">
          <span class="hits">17</span>
          
          <code class="ruby">      GraphqlCrudOperations.define_create(type, create_fields, parents),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">      GraphqlCrudOperations.define_update(type, update_fields, parents),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">      GraphqlCrudOperations.define_destroy(type, parents)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_default_type(&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="129">
          <span class="hits">13</span>
          
          <code class="ruby">    GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="130">
          <span class="hits">13</span>
          
          <code class="ruby">      field :permissions, types.String do</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="131">
          <span class="hits">13</span>
          
          <code class="ruby">        resolve -&gt; (obj, _args, ctx) {</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="132">
          <span class="hits">18</span>
          
          <code class="ruby">          obj.permissions(ctx[:ability])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="136">
          <span class="hits">13</span>
          
          <code class="ruby">      instance_eval(&amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.field_verification_statuses</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="141">
          <span class="hits">2</span>
          
          <code class="ruby">    proc do |classname|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="142">
          <span class="hits">2</span>
          
          <code class="ruby">      field :verification_statuses do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="143">
          <span class="hits">2</span>
          
          <code class="ruby">        type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="145">
          <span class="hits">2</span>
          
          <code class="ruby">        resolve -&gt;(_obj, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">          team = Team.current || Team.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">          team.verification_statuses(classname)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_annotation_fields</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="154">
          <span class="hits">7</span>
          
          <code class="ruby">    [:annotation_type, :updated_at, :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">     :annotated_id, :annotated_type, :content, :dbid ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.define_annotation_type(type, fields = {}, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="159">
          <span class="hits">7</span>
          
          <code class="ruby">    GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="160">
          <span class="hits">7</span>
          
          <code class="ruby">      name type.capitalize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="162">
          <span class="hits">7</span>
          
          <code class="ruby">      interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="164">
          <span class="hits">7</span>
          
          <code class="ruby">      field :id, !types.ID do</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="165">
          <span class="hits">7</span>
          
          <code class="ruby">        resolve -&gt; (annotation, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="166">
          <span class="hits">6</span>
          
          <code class="ruby">          annotation.relay_id(type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="170">
          <span class="hits">7</span>
          
          <code class="ruby">      GraphqlCrudOperations.define_annotation_fields.each do |name|</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="171">
          <span class="hits">49</span>
          
          <code class="ruby">        field name, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="174">
          <span class="hits">7</span>
          
          <code class="ruby">      field :permissions, types.String do</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="175">
          <span class="hits">7</span>
          
          <code class="ruby">        resolve -&gt; (annotation, _args, ctx) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">          annotation.permissions(ctx[:ability], annotation.annotation_type_class)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="180">
          <span class="hits">7</span>
          
          <code class="ruby">      fields.each do |name, _field_type|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="181">
          <span class="hits">10</span>
          
          <code class="ruby">        field name, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="184">
          <span class="hits">7</span>
          
          <code class="ruby">      connection :medias, -&gt; { ProjectMediaType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="185">
          <span class="hits">7</span>
          
          <code class="ruby">        resolve -&gt;(annotation, _args, _ctx) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">          annotation.entity_objects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="189">
          <span class="hits">7</span>
          
          <code class="ruby">      instance_exec :annotator, AnnotatorType, &amp;GraphqlCrudOperations.annotation_fields</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="190">
          <span class="hits">7</span>
          
          <code class="ruby">      instance_exec :version, VersionType, &amp;GraphqlCrudOperations.annotation_fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="192">
          <span class="hits">7</span>
          
          <code class="ruby">      instance_eval(&amp;block) if block_given?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.annotation_fields</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="197">
          <span class="hits">14</span>
          
          <code class="ruby">    proc do |name, field_type = types.String, method = nil|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="198">
          <span class="hits">14</span>
          
          <code class="ruby">      field name do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="199">
          <span class="hits">14</span>
          
          <code class="ruby">        type field_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="201">
          <span class="hits">14</span>
          
          <code class="ruby">        resolve -&gt; (annotation, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="202">
          <span class="hits">2</span>
          
          <code class="ruby">          annotation.send(method.blank? ? name : method)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.load_if_can(klass, id, ctx)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="209">
          <span class="hits">24</span>
          
          <code class="ruby">    obj = klass.find_if_can(id, ctx[:ability])</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="210">
          <span class="hits">21</span>
          
          <code class="ruby">    obj</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="83a9e5b858bb38eee5b1a3ba2f14a5e2fa187f34">
  <div class="header">
    <h3>../graph/mutations/project_media_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module ProjectMediaMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    media_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    project_id: &#39;!int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    url: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    quote: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    media_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    project_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    previous_project_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    embed: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;project_media&#39;, create_fields, update_fields, [&#39;project&#39;, &#39;project_was&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a6637cff3c1c09b0c58914d6ba71d9f1fade3df4">
  <div class="header">
    <h3>../graph/mutations/project_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module ProjectMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    lead_image: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    title: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    team_id: &#39;int&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    lead_image: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    title: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    set_slack_channel: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    information: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;project&#39;, create_fields, update_fields, [&#39;team&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9f0a73d04cb36feda0b218926798683547469b91">
  <div class="header">
    <h3>../graph/mutations/project_source_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module ProjectSourceMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    source_id: &#39;!int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    project_id: &#39;!int&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    source_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    project_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;project_source&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f4e4d1fa7215e9972142ac7e43e1e3d6985fd9ca">
  <div class="header">
    <h3>../graph/mutations/source_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module SourceMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    avatar: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    slogan: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    name: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    user_id: &#39;int&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    avatar: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    slogan: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    name: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    user_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;source&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3d8fd8a60a8f48d8e1b5383e734797ea616ecaa6">
  <div class="header">
    <h3>../graph/mutations/status_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module StatusMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    status: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    status: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;status&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="60fd57acb2b12b6c6dd8082d05275c6a733e2175">
  <div class="header">
    <h3>../graph/mutations/tag_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module TagMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    tag: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    tag: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;tag&#39;, create_fields, update_fields, [&#39;source&#39;, &#39;project_media&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7915bed7bdcfe0826c2297a179cde7e3a4dba831">
  <div class="header">
    <h3>../graph/mutations/task_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module TaskMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    label: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    type: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    jsonoptions: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    annotated_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    annotated_type: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    label: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    response: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;task&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;, &#39;project&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3e890021ee6d068c38fbe4ecb1ca7a6d967d044a">
  <div class="header">
    <h3>../graph/mutations/team_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module TeamMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    archived: &#39;bool&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    private: &#39;bool&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    logo: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    name: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    slug: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    contact: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    archived: &#39;bool&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    private: &#39;bool&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    logo: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    name: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    description: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    set_slack_notifications_enabled: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    set_slack_webhook: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    set_slack_channel: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    contact: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;team&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5cacb506cf1c7b4bbd05d5d1b1123687082fe0f2">
  <div class="header">
    <h3>../graph/mutations/team_user_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module TeamUserMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    user_id: &#39;!int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    team_id: &#39;!int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    status: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    role: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    user_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    team_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    status: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    role: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;team_user&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ec38efa5820c09471c33bee863a2f2ab56a03dd8">
  <div class="header">
    <h3>../graph/mutations/user_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module UserMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    email: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    profile_image: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    login: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    name: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    current_team_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    password: &#39;!str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    password_confirmation: &#39;!str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    email: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    profile_image: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    login: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    name: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    current_team_id: &#39;int&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    password: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    password_confirmation: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;user&#39;, create_fields, update_fields)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e37e35c30a5965cb9b1e4b67197ef80a4b72f005">
  <div class="header">
    <h3>../graph/mutations/version_mutations.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionMutations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  create_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    item_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    item_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    event: &#39;str&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  update_fields = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    item_type: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    item_id: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    event: &#39;str&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    id: &#39;!id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  Create, Update, Destroy = GraphqlCrudOperations.define_crud_operations(&#39;version&#39;, create_fields, update_fields, [&#39;project_media&#39;, &#39;source&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="141df6a452b5edc99b8207b5d8f723322f8b6ccc">
  <div class="header">
    <h3>../graph/types/about_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">AboutType = GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;About&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Information about the application&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]      </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  global_id_field :id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, types.String, &#39;Application name&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version, types.String, &#39;Application version&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :tos, types.String, &#39;Terms of Service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :privacy_policy, types.String, &#39;Privacy Policy&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :max_upload_size, types.String, &#39;Maximum upload size&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f03b3dbe0294a0c436dd2b178f7d3c0a9befc5bc">
  <div class="header">
    <h3>../graph/types/account_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">AccountType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Account&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Account type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Account&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :data, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :provider, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    type UserType</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (account, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      account.user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { SourceType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (account, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">      account.source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :medias, -&gt; { MediaType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(account, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">      account.medias</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"># End of fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ba8a7247ec7e8e7838d2936c6b409770016b1762">
  <div class="header">
    <h3>../graph/types/annotation_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">AnnotationType = GraphqlCrudOperations.define_annotation_type(&#39;annotation&#39;, { content: &#39;str&#39; })</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a67ffe45314b0fcc815c3bf02db26ee9c9a3eee8">
  <div class="header">
    <h3>../graph/types/annotator_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">AnnotatorType = GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Annotator&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Information about an annotator&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]      </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  global_id_field :id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :profile_image, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="780847d8ef690ae6e58c8911207fca4bedb5d5ff">
  <div class="header">
    <h3>../graph/types/check_search_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">CheckSearchType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;CheckSearch&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;CheckSearch type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :number_of_results, types.Int</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :medias, ProjectMediaType.connection_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b851290a4189c7858b468480804da28b570dbab5">
  <div class="header">
    <h3>../graph/types/comment_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">CommentType = GraphqlCrudOperations.define_annotation_type(&#39;comment&#39;, { text: &#39;str&#39; })</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d0cf60f44d5e9117d84ce2e26af08a3e62c80ea1">
  <div class="header">
    <h3>../graph/types/contact_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">ContactType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Contact&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Contact type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Contact&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :location, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :phone, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :web, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { TeamType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (contact, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">      contact.team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"># End of fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="06fcfd737d1aea8c2cf39ccdf29777c4d99c6c47">
  <div class="header">
    <h3>../graph/types/dynamic_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">DynamicType = GraphqlCrudOperations.define_annotation_type(&#39;dynamic&#39;, {})</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="94b921bd0fb041012e9756d7e6534ee355d6c134">
  <div class="header">
    <h3>../graph/types/flag_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">FlagType = GraphqlCrudOperations.define_annotation_type(&#39;flag&#39;, { flag: &#39;str&#39; })</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dbc14484c5291199518f29833e5819b110be4a8d">
  <div class="header">
    <h3>../graph/types/media_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">MediaType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Media&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Media type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Media&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :quote, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :account_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pusher_channel, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :embed_path, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :thumbnail_path, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :account do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { AccountType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">      media.account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dfb90ee1a2a9eefc02e05c595b554ac4d2146f25">
  <div class="header">
    <h3>../graph/types/mutation_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>49</b> relevant lines. 
      <span class="green"><b>49</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">MutationType = GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;MutationType&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createComment, field: CommentMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateComment, field: CommentMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyComment, field: CommentMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createProjectSource, field: ProjectSourceMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateProjectSource, field: ProjectSourceMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyProjectSource, field: ProjectSourceMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createSource, field: SourceMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateSource, field: SourceMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroySource, field: SourceMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createTeamUser, field: TeamUserMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateTeamUser, field: TeamUserMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyTeamUser, field: TeamUserMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createTeam, field: TeamMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateTeam, field: TeamMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyTeam, field: TeamMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createAccount, field: AccountMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateAccount, field: AccountMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyAccount, field: AccountMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createProject, field: ProjectMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateProject, field: ProjectMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyProject, field: ProjectMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createProjectMedia, field: ProjectMediaMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateProjectMedia, field: ProjectMediaMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyProjectMedia, field: ProjectMediaMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createUser, field: UserMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateUser, field: UserMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyUser, field: UserMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createTag, field: TagMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateTag, field: TagMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyTag, field: TagMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createStatus, field: StatusMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateStatus, field: StatusMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyStatus, field: StatusMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createFlag, field: FlagMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateFlag, field: FlagMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyFlag, field: FlagMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  # field :createAnnotation, field: AnnotationMutations::Create.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  # field :updateAnnotation, field: AnnotationMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyAnnotation, field: AnnotationMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyVersion, field: VersionMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createContact, field: ContactMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateContact, field: ContactMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyContact, field: ContactMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createDynamic, field: DynamicMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateDynamic, field: DynamicMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyDynamic, field: DynamicMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  field :createTask, field: TaskMutations::Create.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updateTask, field: TaskMutations::Update.field</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  field :destroyTask, field: TaskMutations::Destroy.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8d4412fde968d01897317a90eafe735e60722098">
  <div class="header">
    <h3>../graph/types/node_identification.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">GraphQL::Relay::GlobalNodeIdentification.instance_variable_set(:@instance, nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">NodeIdentification = GraphQL::Relay::GlobalNodeIdentification.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  object_from_id -&gt; (id, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="4">
          <span class="hits">12</span>
          
          <code class="ruby">    type_name, id = NodeIdentification.from_global_id(id)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="5">
          <span class="hits">12</span>
          
          <code class="ruby">    obj = nil</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="6">
          <span class="hits">12</span>
          
          <code class="ruby">    if type_name == &#39;About&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">      name = Rails.application.class.parent_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      obj = OpenStruct.new({ name: name, version: VERSION, id: 1, type: &#39;About&#39; })</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="9">
          <span class="hits">11</span>
          
          <code class="ruby">    elsif type_name == &#39;CheckSearch&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      obj = CheckSearch.new(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="12">
          <span class="hits">10</span>
          
          <code class="ruby">      obj = type_name.constantize.find_if_can(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="14">
          <span class="hits">12</span>
          
          <code class="ruby">    obj</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  type_from_object -&gt; (object) do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    klass = object.respond_to?(:type) ? object.type : object.class_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    &quot;#{klass}Type&quot;.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  to_global_id -&gt; (type_name, id) do</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="23">
          <span class="hits">33</span>
          
          <code class="ruby">    Base64.encode64(&quot;#{type_name}/#{id}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  from_global_id -&gt; (global_id) do</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="27">
          <span class="hits">22</span>
          
          <code class="ruby">    id_parts  = Base64.decode64(global_id).split(&quot;/&quot;)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="28">
          <span class="hits">22</span>
          
          <code class="ruby">    type_name = id_parts[0]</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="29">
          <span class="hits">22</span>
          
          <code class="ruby">    id        = id_parts[1]</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="30">
          <span class="hits">22</span>
          
          <code class="ruby">    [type_name, id]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7025d05f4e1feace4629b557adb334c5f6d8b1f4">
  <div class="header">
    <h3>../graph/types/project_media_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>79</b> relevant lines. 
      <span class="green"><b>79</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">ProjectMediaType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;ProjectMedia type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;ProjectMedia&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :media_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :quote, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      media = project_media.media</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      media.respond_to?(:domain) ? media.domain : &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pusher_channel do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.media.pusher_channel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  field :account do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { AccountType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.media.account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { ProjectType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">      project_media.project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :projects, -&gt; { ProjectType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.media.projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  field :media do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { MediaType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">      project_media.media</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { UserType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { TeamType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.project.team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :log, -&gt; { VersionType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="82">
          <span class="hits">18</span>
          
          <code class="ruby">      project_media.get_versions_log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  field :annotations_count do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.Int</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.get_versions_log_count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :tags, -&gt; { TagType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.get_annotations(&#39;tag&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="100">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :tasks, -&gt; { TaskType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.get_annotations(&#39;task&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  field :embed do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="110">
          <span class="hits">4</span>
          
          <code class="ruby">      project_media.embed.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  field :last_status do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="118">
          <span class="hits">3</span>
          
          <code class="ruby">      project_media.last_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">  field :last_status_obj do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="123">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { StatusType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.get_annotations(&#39;status&#39;).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">  field :overridden do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.overridden.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  field :published do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project_media, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">      project_media.created_at.to_i.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  instance_exec :media, &amp;GraphqlCrudOperations.field_verification_statuses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"># End of fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="da726a5fedb93b3fd795c2a75a3a8416089868f3">
  <div class="header">
    <h3>../graph/types/project_source_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">ProjectSourceType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;ProjectSource&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;ProjectSource type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;ProjectSource&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { ProjectType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">      project_source.project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { SourceType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project_source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">      project_source.source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"># End of fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="10d1a7e824cfe9101a780d06b999f8c8dc635403">
  <div class="header">
    <h3>../graph/types/project_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">ProjectType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Project&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Project type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Project&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :avatar, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :title, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :get_slack_channel, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pusher_channel, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :medias_count, types.Int</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    type TeamType</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (project, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      team = project.team</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :project_medias, -&gt; { ProjectMediaType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">      project.project_medias.to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :sources, -&gt; { SourceType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(project, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">      project.sources</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b569181384890401fa22991d906f9a5578f25e1d">
  <div class="header">
    <h3>../graph/types/public_team_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">PublicTeamType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;PublicTeam&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Public team type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;PublicTeam&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :slug, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :avatar, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private, types.Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="aad14bf6d5125732ed3c0ddb316644ab9396c028">
  <div class="header">
    <h3>../graph/types/query_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>70</b> relevant lines. 
      <span class="green"><b>70</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">QueryType = GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &quot;Query&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &quot;The query root of this schema&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :node, field: NodeIdentification.field</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :root, RootLevelType do</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="8">
          <span class="hits">29</span>
          
          <code class="ruby">    resolve -&gt; (_obj, _args, _ctx) { RootLevel::STATIC }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :about do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    type AboutType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Information about the application&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, _args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      OpenStruct.new({ name: Rails.application.class.parent_name, version: VERSION, id: 1, type: &#39;About&#39;, tos: CONFIG[&#39;terms_of_service&#39;], privacy_policy: CONFIG[&#39;privacy_policy&#39;], max_upload_size: UploadedFile.max_size_readable })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :me do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    type UserType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Information about the current user&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, _args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="23">
          <span class="hits">8</span>
          
          <code class="ruby">      User.current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  # Get team by id or slug</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    type TeamType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Information about the context team or the team from given id&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :id, types.ID</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :slug, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, args, ctx) do</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="35">
          <span class="hits">5</span>
          
          <code class="ruby">      tid = args[&#39;id&#39;].to_i</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="36">
          <span class="hits">5</span>
          
          <code class="ruby">      if !args[&#39;slug&#39;].blank?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">        team = Team.where(slug: args[&#39;slug&#39;]).first</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">        tid = team.id unless team.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end  </code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="40">
          <span class="hits">5</span>
          
          <code class="ruby">      if tid === 0 &amp;&amp; !Team.current.blank?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">        tid = Team.current.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="43">
          <span class="hits">5</span>
          
          <code class="ruby">      GraphqlCrudOperations.load_if_can(Team, tid, ctx)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  # Get public team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  field :public_team do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    type PublicTeamType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Public information about a team&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :slug, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="55">
          <span class="hits">3</span>
          
          <code class="ruby">      team = args[&#39;slug&#39;].blank? ? Team.current : Team.where(slug: args[&#39;slug&#39;]).last</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="56">
          <span class="hits">3</span>
          
          <code class="ruby">      id = team.blank? ? 0 : team.id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="57">
          <span class="hits">3</span>
          
          <code class="ruby">      Team.find(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_media do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    type ProjectMediaType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Information about a project media, The argument should be given like this: &quot;project_media_id,project_id&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :ids, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, args, ctx) do</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="66">
          <span class="hits">12</span>
          
          <code class="ruby">      pmid, pid = args[&#39;ids&#39;].split(&#39;,&#39;).map(&amp;:to_i)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="67">
          <span class="hits">12</span>
          
          <code class="ruby">      tid = Team.current.blank? ? 0 : Team.current.id</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="68">
          <span class="hits">12</span>
          
          <code class="ruby">      project = Project.where(id: pid, team_id: tid).last</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="69">
          <span class="hits">12</span>
          
          <code class="ruby">      pid = project.nil? ? 0 : project.id</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="70">
          <span class="hits">12</span>
          
          <code class="ruby">      pmid = ProjectMedia.belonged_to_project(pmid, pid) || 0</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="71">
          <span class="hits">12</span>
          
          <code class="ruby">      GraphqlCrudOperations.load_if_can(ProjectMedia, pmid, ctx)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    type ProjectType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Information about a project, given its id and its team id&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :id, !types.ID</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, args, ctx) do</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="82">
          <span class="hits">3</span>
          
          <code class="ruby">      tid = Team.current.blank? ? 0 : Team.current.id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="83">
          <span class="hits">3</span>
          
          <code class="ruby">      project = Project.where(id: args[&#39;id&#39;], team_id: tid).last</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="84">
          <span class="hits">3</span>
          
          <code class="ruby">      id = project.nil? ? 0 : project.id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="85">
          <span class="hits">3</span>
          
          <code class="ruby">      GraphqlCrudOperations.load_if_can(Project, id, ctx)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  field :search do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    type CheckSearchType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">    description &#39;Search medias, The argument should be given like this: &quot;{\&quot;keyword\&quot;:\&quot;search keyword\&quot;}&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">    argument :query, !types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (_obj, args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="96">
          <span class="hits">6</span>
          
          <code class="ruby">      CheckSearch.new(args[&#39;query&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  # Getters by ID</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  [:source, :user].each do |type|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="103">
          <span class="hits">2</span>
          
          <code class="ruby">    field type do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="104">
          <span class="hits">2</span>
          
          <code class="ruby">      type &quot;#{type.to_s.camelize}Type&quot;.constantize</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="105">
          <span class="hits">2</span>
          
          <code class="ruby">      description &quot;Information about the #{type} with given id&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="106">
          <span class="hits">2</span>
          
          <code class="ruby">      argument :id, !types.ID</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="107">
          <span class="hits">2</span>
          
          <code class="ruby">      resolve -&gt; (_obj, args, ctx) do</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="108">
          <span class="hits">4</span>
          
          <code class="ruby">        GraphqlCrudOperations.load_if_can(type.to_s.camelize.constantize, args[&#39;id&#39;], ctx)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2e5cdec4050dccec9abca30d3ecaea58541edf2b">
  <div class="header">
    <h3>../graph/types/root_level_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>50</b> relevant lines. 
      <span class="green"><b>50</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">RootLevelType = GraphQL::ObjectType.define do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;RootLevel&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Unassociated root object queries&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;RootLevel&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :comments, CommentType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      Comment.all_sorted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :project_medias, ProjectMediaType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">      ProjectMedia.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :project_sources, ProjectSourceType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      ProjectSource.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :sources, SourceType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">      Source.order(&#39;created_at DESC&#39;).all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :team_users, TeamUserType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">      TeamUser.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :teams, TeamType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">      Team.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :accounts, AccountType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">      Account.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :medias, MediaType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">      Media.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :projects, ProjectType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="50">
          <span class="hits">3</span>
          
          <code class="ruby">      Project.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :users, UserType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="55">
          <span class="hits">3</span>
          
          <code class="ruby">      User.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :annotations, AnnotationType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">      Annotation.all_sorted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :tags, TagType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">      Tag.all_sorted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :statuses, StatusType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">      Status.all_sorted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :versions, VersionType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">      PaperTrail::Version.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  connection :contacts, ContactType.connection_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(_object, _args, _ctx){</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">      Contact.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6549165ddd33f656fac17f7fc40c499e696ac522">
  <div class="header">
    <h3>../graph/types/source_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>38</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">SourceType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Source&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Source type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Source&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :image, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :accounts, -&gt; { AccountType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="19">
          <span class="hits">19</span>
          
          <code class="ruby">      source.accounts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :project_sources, -&gt; { ProjectSourceType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="25">
          <span class="hits">19</span>
          
          <code class="ruby">      source.project_sources</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :projects, -&gt; { ProjectType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="31">
          <span class="hits">19</span>
          
          <code class="ruby">      source.projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :annotations, -&gt; { AnnotationType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="37">
          <span class="hits">19</span>
          
          <code class="ruby">      source.annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :medias, -&gt; { ProjectMediaType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="43">
          <span class="hits">19</span>
          
          <code class="ruby">      source.medias</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :collaborators, -&gt; { UserType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="49">
          <span class="hits">19</span>
          
          <code class="ruby">      source.collaborators</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :comments, -&gt; { CommentType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="55">
          <span class="hits">19</span>
          
          <code class="ruby">      source.comments</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :tags, -&gt; { TagType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(source, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="61">
          <span class="hits">19</span>
          
          <code class="ruby">      source.tags</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  instance_exec :source, &amp;GraphqlCrudOperations.field_verification_statuses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="822e4ddba9b5ec4f6dec3c08e58b8b88a816b9cf">
  <div class="header">
    <h3>../graph/types/status_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">StatusType = GraphqlCrudOperations.define_annotation_type(&#39;status&#39;, { status: &#39;str&#39; })</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b624c21ffa164869d6a0900b217c369b4604a24f">
  <div class="header">
    <h3>../graph/types/tag_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">TagType = GraphqlCrudOperations.define_annotation_type(&#39;tag&#39;, { tag: &#39;str&#39; })</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a755198ebeff997a44d9630784ebb6091226ea91">
  <div class="header">
    <h3>../graph/types/task_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">TaskType = GraphqlCrudOperations.define_annotation_type(&#39;task&#39;, { label: &#39;str&#39;, type: &#39;str&#39;, description: &#39;str&#39;, options: &#39;str&#39;, status: &#39;str&#39; }) do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  field :first_response do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    type AnnotationType</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (task, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      obj = task.load</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">      obj.nil? ? nil : obj.responses.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="828d7ed4a3766f96c8727f33d9bcd363217d3041">
  <div class="header">
    <h3>../graph/types/team_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>41</b> relevant lines. 
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">TeamType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Team&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Team type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;Team&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :archived, types.Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private, types.Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :avatar, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :slug, !types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :members_count, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :get_slack_notifications_enabled, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :get_slack_webhook, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :get_slack_channel, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :get_suggested_tags, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pusher_channel, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  field :media_verification_statuses do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">      team.verification_statuses(:media)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source_verification_statuses do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    type types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">      team.verification_statuses(:source)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :team_users, -&gt; { TeamUserType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="43">
          <span class="hits">4</span>
          
          <code class="ruby">      team.team_users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :users, -&gt; { UserType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">      team.users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :contacts, -&gt; { ContactType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="55">
          <span class="hits">4</span>
          
          <code class="ruby">      team.contacts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :projects, -&gt; { ProjectType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(team, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="61">
          <span class="hits">4</span>
          
          <code class="ruby">      team.recent_projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a39a1b1b400f78ebc30c6ecb25c5c211e17b17aa">
  <div class="header">
    <h3>../graph/types/team_user_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">TeamUserType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;TeamUser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;TeamUser type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;TeamUser&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :status, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :role, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :team do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    type TeamType</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team_user, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">      team_user.team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    type UserType</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (team_user, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">      team_user.user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="88d168229627a1bc70ca5f36aaa82c76e7a99ee2">
  <div class="header">
    <h3>../graph/types/user_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>27</b> relevant lines. 
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">UserType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;User&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;User type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;User&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :provider, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :uuid, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :profile_image, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :login, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :current_team_id, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :permissions, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    type SourceType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (user, _args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      user.source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :current_team do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    type TeamType</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt; (user, _args, _ctx) do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">      user.current_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :teams, -&gt; { TeamType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(user, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">      user.teams</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :team_users, -&gt; { TeamUserType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(user, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">      user.team_users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="575c07c36a90f26475f8f106d5289f3dd0b7329e">
  <div class="header">
    <h3>../graph/types/version_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">VersionType = GraphqlCrudOperations.define_default_type do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  name &#39;Version&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  description &#39;Version type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  interfaces [NodeIdentification.interface]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :id, field: GraphQL::Relay::GlobalIdField.new(&#39;PaperTrail::Version&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dbid, types.Int</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :item_type, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :item_id, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :event, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :event_type, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :object_after, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :meta, types.String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :object_changes_json, types.String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { UserType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(version, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      version.user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :annotation do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { AnnotationType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(version, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">      version.annotation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">  connection :projects, -&gt; { ProjectType.connection_type } do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(version, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">      version.projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  field :task do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    type -&gt; { TaskType }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    resolve -&gt;(version, _args, _ctx) {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">      version.task</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="db1bc6aef95690a1f3b4d378c7f61adc8b8d50a4">
  <div class="header">
    <h3>../mailers.lication_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ApplicationMailer &lt; ActionMailer::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  default from: CONFIG[&#39;default_mail&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  layout &#39;mailer&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="68c1c75256e1d86bfb576e0defd12c8208941b75">
  <div class="header">
    <h3>../mailers/devise_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DeviseMailer &lt; Devise::Mailer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include Devise::Controllers::UrlHelpers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  layout nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def confirmation_instructions(record, token, opts={})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @host = CONFIG[&#39;checkdesk_base_url&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @client_host = CONFIG[&#39;checkdesk_client&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    opts[:subject] = I18n.t(:mail_account_confirmation, default: &quot;Check account confirmation&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="40e27a71083e7ac9eb11b55ff70ac7cb6c81c15c">
  <div class="header">
    <h3>../mailers/registration_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class RegistrationMailer &lt; ApplicationMailer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  layout nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def welcome_email(user)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    @url = CONFIG[&#39;checkdesk_client&#39;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    mail(to: @user.email, subject: I18n.t(:mail_new_account, default: &quot;New account for you on Check&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def duplicate_email_detection(user, duplicate)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    @duplicate_provider = duplicate.provider? ? duplicate.provider.camelcase : I18n.t(:mail_duplicate_email_exists_email)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    @user_provider = user.provider? ? user.provider.camelcase : I18n.t(:mail_duplicate_email_exists_email)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">    mail(to: @user.email, subject: I18n.t(:mail_duplicate_email_exists))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="758047c0a649f0af11671ed66f60b0c926f1bd0a">
  <div class="header">
    <h3>../mailers/team_user_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class TeamUserMailer &lt; ApplicationMailer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  layout nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def request_to_join(team, requestor, origin)</code>
        </li>
      
        <li class="covered" data-hits="330" data-linenumber="5">
          <span class="hits">330</span>
          
          <code class="ruby">    if team &amp;&amp; requestor</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="6">
          <span class="hits">327</span>
          
          <code class="ruby">      @team = team</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="7">
          <span class="hits">327</span>
          
          <code class="ruby">      @requestor = requestor</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="8">
          <span class="hits">327</span>
          
          <code class="ruby">      @url = origin.blank? ? &#39;&#39; : URI.join(origin, &quot;/#{@team.slug}/members&quot;)</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="9">
          <span class="hits">327</span>
          
          <code class="ruby">      @handle = requestor.handle</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="10">
          <span class="hits">327</span>
          
          <code class="ruby">      recipients = team.recipients(requestor)</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="11">
          <span class="hits">327</span>
          
          <code class="ruby">      self.send_email_to_recipients(recipients, I18n.t(:mail_request_to_join, default: &quot;%{user} wants to join %{team} team on Check!&quot;, user: requestor.name, team: team.name))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def request_to_join_processed(team, requestor, accepted, origin)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">    if team &amp;&amp; requestor &amp;&amp; !requestor.email.blank?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="17">
          <span class="hits">4</span>
          
          <code class="ruby">      @team = team</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">      @requestor = requestor</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">      @accepted = accepted</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">      @url = origin.blank? ? &#39;&#39; : URI.join(origin, &quot;/#{@team.slug}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">      Rails.logger.info &quot;Sending e-mail to #{requestor.email}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">      status = accepted ? I18n.t(:approved, default: &quot;approved!&quot;) : I18n.t(:rejected, default: &quot;not approved&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">      self.send_email_to_recipients(requestor.email, I18n.t(:mail_request_to_join_processed, default: &quot;Your request to join %{team} on Check was %{status}&quot;, team: team.name, status: status))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_email_to_recipients(recipients, subject)</code>
        </li>
      
        <li class="covered" data-hits="331" data-linenumber="30">
          <span class="hits">331</span>
          
          <code class="ruby">    recipients = Bounce.remove_bounces(recipients)</code>
        </li>
      
        <li class="covered" data-hits="331" data-linenumber="31">
          <span class="hits">331</span>
          
          <code class="ruby">    unless recipients.empty?</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="32">
          <span class="hits">17</span>
          
          <code class="ruby">      Rails.logger.info &quot;Sending e-mail to #{recipients}&quot;</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="33">
          <span class="hits">17</span>
          
          <code class="ruby">      mail(to: recipients, subject: subject)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="08d679bc80659fb3262f22814c1b10fcd271779d">
  <div class="header">
    <h3>../models/ability.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>145</b> relevant lines. 
      <span class="green"><b>145</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Ability</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include CanCan::Ability</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(user = nil)</code>
        </li>
      
        <li class="covered" data-hits="1344" data-linenumber="5">
          <span class="hits">1344</span>
          
          <code class="ruby">    alias_action :create, :update, :destroy, :to =&gt; :cud</code>
        </li>
      
        <li class="covered" data-hits="1344" data-linenumber="6">
          <span class="hits">1344</span>
          
          <code class="ruby">    @user = User.current ||= user || User.new</code>
        </li>
      
        <li class="covered" data-hits="1344" data-linenumber="7">
          <span class="hits">1344</span>
          
          <code class="ruby">    @context_team = Team.current ||= @user.current_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    # Define User abilities</code>
        </li>
      
        <li class="covered" data-hits="1344" data-linenumber="9">
          <span class="hits">1344</span>
          
          <code class="ruby">    if @user.is_admin?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">      global_admin_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="12">
          <span class="hits">1338</span>
          
          <code class="ruby">      extra_perms_for_all_users</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="13">
          <span class="hits">1338</span>
          
          <code class="ruby">      if @user.id</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="14">
          <span class="hits">1324</span>
          
          <code class="ruby">        authenticated_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="16">
          <span class="hits">1338</span>
          
          <code class="ruby">      if @user.role? :contributor</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="17">
          <span class="hits">1160</span>
          
          <code class="ruby">        contributor_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="19">
          <span class="hits">1338</span>
          
          <code class="ruby">      if @user.role? :journalist</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="20">
          <span class="hits">894</span>
          
          <code class="ruby">        journalist_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="22">
          <span class="hits">1338</span>
          
          <code class="ruby">      if @user.role? :editor</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="23">
          <span class="hits">746</span>
          
          <code class="ruby">        editor_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="25">
          <span class="hits">1338</span>
          
          <code class="ruby">      if @user.role? :owner</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="26">
          <span class="hits">702</span>
          
          <code class="ruby">        owner_perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def global_admin_perms</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="34">
          <span class="hits">6</span>
          
          <code class="ruby">    can :access, :rails_admin</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="35">
          <span class="hits">6</span>
          
          <code class="ruby">    can :dashboard</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="36">
          <span class="hits">6</span>
          
          <code class="ruby">    can :manage, :all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def owner_perms</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="40">
          <span class="hits">702</span>
          
          <code class="ruby">    can :access, :rails_admin</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="41">
          <span class="hits">702</span>
          
          <code class="ruby">    can :dashboard</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="43">
          <span class="hits">702</span>
          
          <code class="ruby">    can [:update, :destroy], User, :team_users =&gt; { :team_id =&gt; @context_team.id, role: [&#39;owner&#39;, &#39;editor&#39;, &#39;journalist&#39;, &#39;contributor&#39;] }</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="44">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, Team, :id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="45">
          <span class="hits">702</span>
          
          <code class="ruby">    can :create, TeamUser, :team_id =&gt; @context_team.id, role: [&#39;owner&#39;]</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="46">
          <span class="hits">702</span>
          
          <code class="ruby">    can :update, TeamUser, team_id: @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="47">
          <span class="hits">702</span>
          
          <code class="ruby">    cannot :update, TeamUser, team_id: @context_team.id, user_id: @user.id</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="48">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, Contact, :team_id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="49">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, Project, :team_id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="50">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, [Media, Link, Claim] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="51">
          <span class="hits">10</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="53">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, [ProjectMedia, ProjectSource], project: { team: { team_users: { team_id: @context_team.id }}}</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="54">
          <span class="hits">702</span>
          
          <code class="ruby">    %w(annotation comment flag status tag embed dynamic task).each do |annotation_type|</code>
        </li>
      
        <li class="covered" data-hits="5616" data-linenumber="55">
          <span class="hits">5616</span>
          
          <code class="ruby">      can :destroy, annotation_type.classify.constantize, [&#39;annotation_type = ?&#39;, annotation_type] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="56">
          <span class="hits">18</span>
          
          <code class="ruby">        obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="59">
          <span class="hits">702</span>
          
          <code class="ruby">    can :destroy, PaperTrail::Version do |obj|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="60">
          <span class="hits">11</span>
          
          <code class="ruby">      teams = []</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="61">
          <span class="hits">11</span>
          
          <code class="ruby">      v_obj = obj.item_type.constantize.find(obj.item_id)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="62">
          <span class="hits">11</span>
          
          <code class="ruby">      teams = v_obj.get_team if v_obj.respond_to?(:get_team)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="63">
          <span class="hits">11</span>
          
          <code class="ruby">      teams &lt;&lt; v_obj.team_id if teams.blank? and v_obj.respond_to?(:team)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="64">
          <span class="hits">11</span>
          
          <code class="ruby">      teams &lt;&lt; v_obj.project.team_id if teams.blank? and v_obj.respond_to?(:project)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="65">
          <span class="hits">11</span>
          
          <code class="ruby">      teams.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def editor_perms</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="70">
          <span class="hits">746</span>
          
          <code class="ruby">    can :update, User, :team_users =&gt; { :team_id =&gt; @context_team.id, role: [&#39;editor&#39;] }</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="71">
          <span class="hits">746</span>
          
          <code class="ruby">    can :update, Team, :id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="72">
          <span class="hits">746</span>
          
          <code class="ruby">    can :create, TeamUser, :team_id =&gt; @context_team.id, role: [&#39;editor&#39;]</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="73">
          <span class="hits">746</span>
          
          <code class="ruby">    can :update, TeamUser, team_id: @context_team.id, role: [&#39;editor&#39;, &#39;journalist&#39;, &#39;contributor&#39;]</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="74">
          <span class="hits">746</span>
          
          <code class="ruby">    cannot :update, TeamUser, team_id: @context_team.id, user_id: @user.id</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="75">
          <span class="hits">746</span>
          
          <code class="ruby">    can [:create, :update], Contact, :team_id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="76">
          <span class="hits">746</span>
          
          <code class="ruby">    can :update, Project, :team_id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="77">
          <span class="hits">746</span>
          
          <code class="ruby">    can [:create, :update], ProjectSource, project: { team: { team_users: { team_id: @context_team.id }}}</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="78">
          <span class="hits">746</span>
          
          <code class="ruby">    %w(annotation comment flag dynamic task).each do |annotation_type|</code>
        </li>
      
        <li class="covered" data-hits="3730" data-linenumber="79">
          <span class="hits">3730</span>
          
          <code class="ruby">      can :update, annotation_type.classify.constantize, [&#39;annotation_type = ?&#39;, annotation_type] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="80">
          <span class="hits">19</span>
          
          <code class="ruby">        obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="746" data-linenumber="83">
          <span class="hits">746</span>
          
          <code class="ruby">    can :create, Task, [&#39;annotation_type = ?&#39;, &#39;task&#39;] do |task|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="84">
          <span class="hits">21</span>
          
          <code class="ruby">      task.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">  def journalist_perms</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="89">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, User, :team_users =&gt; { :team_id =&gt; @context_team.id, role: [&#39;journalist&#39;, &#39;contributor&#39;] }</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="90">
          <span class="hits">894</span>
          
          <code class="ruby">    can :create, TeamUser, :team_id =&gt; @context_team.id, role: [&#39;journalist&#39;, &#39;contributor&#39;]</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="91">
          <span class="hits">894</span>
          
          <code class="ruby">    can :create, Project, :team_id =&gt; @context_team.id</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="92">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, Project, :team_id =&gt; @context_team.id, :user_id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="93">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, [Media, Link, Claim], projects: { team: { team_users: { team_id: @context_team.id }}}</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="94">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, ProjectMedia, project: { team: { team_users: { team_id: @context_team.id }}}</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="95">
          <span class="hits">894</span>
          
          <code class="ruby">    can :create, Flag, [&#39;annotation_type = ?&#39;, &#39;flag&#39;] do |flag|</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="96">
          <span class="hits">20</span>
          
          <code class="ruby">      flag.get_team.include? @context_team.id and (flag.flag.to_s == &#39;Mark as graphic&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="98">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, Flag, [&#39;annotation_type = ?&#39;, &#39;flag&#39;] do |flag|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="99">
          <span class="hits">3</span>
          
          <code class="ruby">      flag.get_team.include? @context_team.id and (flag.annotator_id.to_i == @user.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="101">
          <span class="hits">894</span>
          
          <code class="ruby">    %w(status tag).each do |annotation_type|</code>
        </li>
      
        <li class="covered" data-hits="1788" data-linenumber="102">
          <span class="hits">1788</span>
          
          <code class="ruby">      can :create, annotation_type.classify.constantize, [&#39;annotation_type = ?&#39;, annotation_type] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="103">
          <span class="hits">50</span>
          
          <code class="ruby">        obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="894" data-linenumber="106">
          <span class="hits">894</span>
          
          <code class="ruby">    can :update, Status, [&#39;annotation_type = ?&#39;, &#39;status&#39;] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="107">
          <span class="hits">15</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">  def contributor_perms</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="112">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, User, :id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="113">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :create, [Media, Account, Source, Comment, Embed, Link, Claim, Dynamic]</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="114">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, [Media, Link, Claim], :user_id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="115">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, [Media, Link, Claim] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="116">
          <span class="hits">25</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id and (obj.user_id == @user.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="118">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, [Account, Source, Embed]</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="119">
          <span class="hits">1160</span>
          
          <code class="ruby">    can [:create, :update], ProjectSource, project: { team: { team_users: { team_id: @context_team.id }}}, source: { user_id: @user.id }</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="120">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :create, ProjectMedia, project: { team: { team_users: { team_id: @context_team.id }}}</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="121">
          <span class="hits">1160</span>
          
          <code class="ruby">    can [:update, :destroy], ProjectMedia, project: { team: { team_users: { team_id: @context_team.id }}}, media: { user_id: @user.id }</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="122">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, Comment, [&#39;annotation_type = ?&#39;, &#39;comment&#39;] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="123">
          <span class="hits">6</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id and (obj.annotator_id.to_i == @user.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="125">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :create, Flag, [&#39;annotation_type = ?&#39;, &#39;flag&#39;] do |flag|</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="126">
          <span class="hits">43</span>
          
          <code class="ruby">      flag.get_team.include? @context_team.id and ([&#39;Spam&#39;, &#39;Graphic content&#39;].include?flag.flag.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="128">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :create, Tag, [&#39;annotation_type = ?&#39;, &#39;tag&#39;] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="129">
          <span class="hits">34</span>
          
          <code class="ruby">      (obj.get_team.include? @context_team.id and obj.annotated_type === &#39;ProjectMedia&#39; and obj.annotated.user_id.to_i === @user.id) or obj.annotated_type === &#39;Source&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="131">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :destroy, TeamUser, user_id: @user.id</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="132">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :destroy, Tag, [&#39;annotation_type = ?&#39;, &#39;tag&#39;] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="133">
          <span class="hits">8</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="135">
          <span class="hits">1160</span>
          
          <code class="ruby">    can [:destroy, :update], [Dynamic, Annotation, Task] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="136">
          <span class="hits">11</span>
          
          <code class="ruby">      obj.annotator_id.to_i == @user.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="138">
          <span class="hits">1160</span>
          
          <code class="ruby">    can [:create, :update, :destroy], DynamicAnnotation::Field do |obj|</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="139">
          <span class="hits">15</span>
          
          <code class="ruby">      obj.annotation.annotator_id == @user.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="141">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, [Dynamic, Annotation] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="142">
          <span class="hits">5</span>
          
          <code class="ruby">      obj.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="144">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, DynamicAnnotation::Field do |obj|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="145">
          <span class="hits">6</span>
          
          <code class="ruby">      obj.annotation.get_team.include? @context_team.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="148">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :update, Task, [&#39;annotation_type = ?&#39;, &#39;task&#39;] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="149">
          <span class="hits">4</span>
          
          <code class="ruby">      before, after = obj.data_change</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="150">
          <span class="hits">4</span>
          
          <code class="ruby">      changes = (after.to_a - before.to_a).to_h</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="151">
          <span class="hits">4</span>
          
          <code class="ruby">      obj.get_team.include?(@context_team.id) &amp;&amp; changes.keys == [&#39;status&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="153">
          <span class="hits">1160</span>
          
          <code class="ruby">    can :destroy, PaperTrail::Version do |obj|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="154">
          <span class="hits">3</span>
          
          <code class="ruby">      v_obj = obj.item_type.constantize.find(obj.item_id) if obj.item_type == &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="155">
          <span class="hits">3</span>
          
          <code class="ruby">      !v_obj.nil? and v_obj.project.team_id == @context_team.id and v_obj.media.user_id = @user.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">  def authenticated_perms</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="160">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :create, Team</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="161">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :create, TeamUser, :user_id =&gt; @user.id, status: [&#39;member&#39;, &#39;requested&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    # Permissions for registration and login</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="164">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :create, Source, :user_id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="165">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :update, User, :id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="166">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :create, Account, :user_id =&gt; @user.id</code>
        </li>
      
        <li class="covered" data-hits="1324" data-linenumber="167">
          <span class="hits">1324</span>
          
          <code class="ruby">    can :create, Embed, :annotated_id =&gt; @user.account_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  # Extra permissions for all users</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  def extra_perms_for_all_users</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="172">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :create, User</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="173">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :create, PaperTrail::Version</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="174">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, Team, :private =&gt; false</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="175">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, Team, :private =&gt; true, :team_users =&gt; { :user_id =&gt; @user.id, :status =&gt; &#39;member&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    # A @user can read a user if:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    # 1) @user is the same as target user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">    # 2) target user is a member of at least one public team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    # 3) @user is a member of at least one same team as the target user</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="181">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, User, id: @user.id</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="182">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, User, teams: { private: false }</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="183">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, User, team_users: { status: &#39;member&#39;, team: { team_users: { user_id: @user.id, status: &#39;member&#39; }}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    # A @user can read contact, project or team user if:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">    # 1) team is private and @user is a member of that team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    # 2) team user is not private</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="188">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Contact, Project, TeamUser], team: { team_users: { user_id: @user.id, status: &#39;member&#39;} }</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="189">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Contact, Project, TeamUser], team: { private: false }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    # A @user can read any of those objects if:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    # 1) it&#39;s a source related to him/her or not related to any user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">    # 2) it&#39;s related to at least one public team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">    # 3) it&#39;s related to a private team which the @user has access to</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="195">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Account, ProjectMedia, Source], user_id: [@user.id, nil]</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="196">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Source, Media, Link, Claim], projects: { team: { private: false }}</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="197">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Source, Media, Link, Claim], projects: { team: { team_users: { user_id: @user.id, status: &#39;member&#39; }}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="199">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [Account, ProjectSource], source: { user_id: [@user.id, nil] }</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="200">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, Account, source: { projects: { team: { private: false, team_users: { user_id: @user.id }}}}</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="201">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, Account, source: { projects: { team: { team_users: { user_id: @user.id, status: &#39;member&#39; }}}}</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="202">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [ProjectMedia, ProjectSource], project: { team: { private: false } }</code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="203">
          <span class="hits">1338</span>
          
          <code class="ruby">    can :read, [ProjectMedia, ProjectSource], project: { team: { team_users: { user_id: @user.id, status: &#39;member&#39; }}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="205">
          <span class="hits">1338</span>
          
          <code class="ruby">    %w(comment flag status embed tag dynamic task annotation).each do |annotation_type|</code>
        </li>
      
        <li class="covered" data-hits="10704" data-linenumber="206">
          <span class="hits">10704</span>
          
          <code class="ruby">      can :read, annotation_type.classify.constantize, [&#39;annotation_type = ?&#39;, annotation_type] do |obj|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="207">
          <span class="hits">12</span>
          
          <code class="ruby">        team_ids = obj.get_team</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="208">
          <span class="hits">12</span>
          
          <code class="ruby">        teams = Team.where(id: team_ids, private: false)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="209">
          <span class="hits">12</span>
          
          <code class="ruby">        if teams.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="210">
          <span class="hits">6</span>
          
          <code class="ruby">          tu = TeamUser.where(user_id: @user.id, team_id: team_ids, status: &#39;member&#39;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="211">
          <span class="hits">6</span>
          
          <code class="ruby">          TeamUser.where(user_id: @user.id, team_id: team_ids, status: &#39;member&#39;).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="213">
          <span class="hits">6</span>
          
          <code class="ruby">          teams.any?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1338" data-linenumber="218">
          <span class="hits">1338</span>
          
          <code class="ruby">    cannot :manage, ApiKey</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8765507dc9f9bb69a1e07a3294d9757176206216">
  <div class="header">
    <h3>../models/account.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>43</b> relevant lines. 
      <span class="green"><b>43</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Account &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include PenderData</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="452" data-linenumber="4">
          <span class="hits">452</span>
          
          <code class="ruby">  has_paper_trail on: [:create, :update], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :source</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :medias</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :validate_pender_result, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :pender_result_is_a_profile, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :url_is_unique, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :set_pender_result_as_annotation, :create_source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def provider</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    self.data[&#39;provider&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    user_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def source_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    source = Source.where(name: value).last</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    source.nil? ? nil : source.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    s = self.source</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    s.get_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def data</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">    em = self.annotations(&#39;embed&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    JSON.parse(em.embed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_source</code>
        </li>
      
        <li class="covered" data-hits="437" data-linenumber="45">
          <span class="hits">437</span>
          
          <code class="ruby">    if self.source.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">      data = self.pender_data</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="47">
          <span class="hits">5</span>
          
          <code class="ruby">      source = Source.new</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="48">
          <span class="hits">5</span>
          
          <code class="ruby">      source.avatar = data[&#39;picture&#39;]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="49">
          <span class="hits">5</span>
          
          <code class="ruby">      source.name = data[&#39;title&#39;].blank? ? &#39;Untitled&#39; : data[&#39;title&#39;]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">      source.slogan = data[&#39;description&#39;].to_s</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="51">
          <span class="hits">5</span>
          
          <code class="ruby">      source.save!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="52">
          <span class="hits">5</span>
          
          <code class="ruby">      self.source = source</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="53">
          <span class="hits">5</span>
          
          <code class="ruby">      self.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def pender_result_is_a_profile</code>
        </li>
      
        <li class="covered" data-hits="800" data-linenumber="58">
          <span class="hits">800</span>
          
          <code class="ruby">    errors.add(:base, &#39;Sorry, this is not a profile&#39;) if !self.pender_data.nil? &amp;&amp; self.pender_data[&#39;provider&#39;] != &#39;page&#39; &amp;&amp; self.pender_data[&#39;type&#39;] != &#39;profile&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def url_is_unique</code>
        </li>
      
        <li class="covered" data-hits="800" data-linenumber="62">
          <span class="hits">800</span>
          
          <code class="ruby">    existing = Account.where(url: self.url).where(&#39;source_id IS NOT NULL&#39;).first</code>
        </li>
      
        <li class="covered" data-hits="800" data-linenumber="63">
          <span class="hits">800</span>
          
          <code class="ruby">    unless existing.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">      errors.add(:base, &quot;Account with this URL exists and has source id #{existing.source_id}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="710341af2263a38e8fb9ba4cbe838124ba0e0371">
  <div class="header">
    <h3>../models/annotations/annotation.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Annotation &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :cant_instantiate_abstract_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def load</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="7">
          <span class="hits">27</span>
          
          <code class="ruby">    klass = nil</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="8">
          <span class="hits">27</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="9">
          <span class="hits">27</span>
          
          <code class="ruby">      klass = self.annotation_type.camelize.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    rescue NameError</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">      klass = Dynamic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="13">
          <span class="hits">27</span>
          
          <code class="ruby">    klass.where(id: self.id).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="17">
          <span class="hits">13</span>
          
          <code class="ruby">    self.load.destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def cant_instantiate_abstract_class</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    raise &#39;You cannot instantiate this abstract class&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c3ed09ae7ebff52d2bdb0685e65b9cd784d3e563">
  <div class="header">
    <h3>../models/annotations/comment.rb</h3>
    <h4><span class="green">90.7 %</span> covered</h4>
    <div>
      <b>43</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Comment &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :text</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :extract_check_entities</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :add_update_elasticsearch_comment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  before_destroy :destroy_elasticsearch_comment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    { text: self.text }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.where(email: value).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    user.nil? ? nil : user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def target_id_callback(value, mapping_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    data = self.annotated.embed</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    params = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      default: &#39;*%{user}* added a note on &lt;%{url}&gt;\n&gt; %{comment}&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      user: User.current.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      url: &quot;#{self.annotated_client_url}|#{data[&#39;title&#39;]}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      comment: self.text.gsub(&quot;\n&quot;, &quot;\n&gt;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    I18n.t(:slack_save_comment, params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_check_urls</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="40">
          <span class="hits">216</span>
          
          <code class="ruby">    urls = []</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="41">
          <span class="hits">216</span>
          
          <code class="ruby">    team = self.annotated_type === &#39;ProjectMedia&#39; ? self.annotated.project.team : nil</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="42">
          <span class="hits">216</span>
          
          <code class="ruby">    if team</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="43">
          <span class="hits">122</span>
          
          <code class="ruby">      words = self.text.to_s.split(/\s+/)</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="44">
          <span class="hits">122</span>
          
          <code class="ruby">      pattern = Regexp.new(CONFIG[&#39;checkdesk_client&#39;])</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="45">
          <span class="hits">122</span>
          
          <code class="ruby">      words.each do |word|</code>
        </li>
      
        <li class="covered" data-hits="135" data-linenumber="46">
          <span class="hits">135</span>
          
          <code class="ruby">        match = word.match(pattern)</code>
        </li>
      
        <li class="covered" data-hits="135" data-linenumber="47">
          <span class="hits">135</span>
          
          <code class="ruby">        if !match.nil? &amp;&amp; Team.slug_from_url(word) == team.slug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">          urls &lt;&lt; word</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="52">
          <span class="hits">216</span>
          
          <code class="ruby">    urls</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  # Supports only media for the time being</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_check_entities</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="59">
          <span class="hits">216</span>
          
          <code class="ruby">    ids = []</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="60">
          <span class="hits">216</span>
          
          <code class="ruby">    self.extract_check_urls.each do |url|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      match = url.match(/\/project\/([0-9]+)\/media\/([0-9]+)/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">      unless match.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">        ids &lt;&lt; match[2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="66">
          <span class="hits">216</span>
          
          <code class="ruby">    self.entities = ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_update_elasticsearch_comment</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="70">
          <span class="hits">216</span>
          
          <code class="ruby">    add_update_media_search_child(&#39;comment_search&#39;, %w(text))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_elasticsearch_comment</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="74">
          <span class="hits">7</span>
          
          <code class="ruby">    destroy_elasticsearch_data(CommentSearch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b9eb383cef3e525b78ec25556e5e622091e970b5">
  <div class="header">
    <h3>../models/annotations/dynamic.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>60</b> relevant lines. 
      <span class="green"><b>60</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Dynamic &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :set_fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :annotation_type_object, class_name: &#39;DynamicAnnotation::AnnotationType&#39;, foreign_key: &#39;annotation_type&#39;, primary_key: &#39;annotation_type&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :fields, class_name: &#39;DynamicAnnotation::Field&#39;, foreign_key: &#39;annotation_id&#39;, primary_key: &#39;id&#39;, dependent: :destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :add_update_elasticsearch_dynamic_annotation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :create_fields</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  after_update :update_fields</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  before_destroy :destroy_elasticsearch_dynamic_annotation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :annotation_type_exists</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :mandatory_fields_are_set, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :update</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    if !self.set_fields.blank? &amp;&amp; self.annotation_type =~ /^task_response/</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      response = note = task = &#39;-&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">      @fields ||= self.fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">      @fields.each do |f|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">        response = f.value if f.field_name =~ /^response_/</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="28">
          <span class="hits">6</span>
          
          <code class="ruby">        note = f.value if f.field_name =~ /^note_/</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="29">
          <span class="hits">6</span>
          
          <code class="ruby">        task = Task.find(f.value).label if f.field_name =~ /^task_/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">      params = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">        default: &#39;*%{user}* answered the task &lt;%{url}&gt; in %{project}:\n&gt; %{response}\n&gt; Note:\n&gt; %{note}&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">        user: User.current.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">        url: &quot;#{self.annotated_client_url}|#{task}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">        project: self.annotated.project.title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">        response: response,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">        note: note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">      I18n.t(:slack_answer_task, params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def data</code>
        </li>
      
        <li class="covered" data-hits="168" data-linenumber="46">
          <span class="hits">168</span>
          
          <code class="ruby">    fields = self.fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      &#39;fields&#39; =&gt; fields,</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="49">
          <span class="hits">41</span>
          
          <code class="ruby">      &#39;indexable&#39; =&gt; fields.map(&amp;:value).select{ |v| v.is_a?(String) }.join(&#39;. &#39;)</code>
        </li>
      
        <li class="covered" data-hits="168" data-linenumber="50">
          <span class="hits">168</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_update_elasticsearch_dynamic_annotation</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="56">
          <span class="hits">47</span>
          
          <code class="ruby">    add_update_media_search_child(&#39;dynamic_search&#39;, [&#39;indexable&#39;]) if self.fields.count &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_elasticsearch_dynamic_annotation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">    destroy_elasticsearch_data(DynamicSearch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotation_type_exists</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="64">
          <span class="hits">49</span>
          
          <code class="ruby">    errors.add(:annotation_type, &#39;does not exist&#39;) if self.annotation_type != &#39;dynamic&#39; &amp;&amp; DynamicAnnotation::AnnotationType.where(annotation_type: self.annotation_type).last.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_fields</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="68">
          <span class="hits">43</span>
          
          <code class="ruby">    unless self.set_fields.blank?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="69">
          <span class="hits">12</span>
          
          <code class="ruby">      @fields = []</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="70">
          <span class="hits">12</span>
          
          <code class="ruby">      data = JSON.parse(self.set_fields)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="71">
          <span class="hits">12</span>
          
          <code class="ruby">      data.each do |field_name, value|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="72">
          <span class="hits">26</span>
          
          <code class="ruby">        f = DynamicAnnotation::Field.new</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="73">
          <span class="hits">26</span>
          
          <code class="ruby">        f.field_name = field_name</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="74">
          <span class="hits">26</span>
          
          <code class="ruby">        f.value = value</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="75">
          <span class="hits">26</span>
          
          <code class="ruby">        f.annotation_id = self.id</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="76">
          <span class="hits">26</span>
          
          <code class="ruby">        f.save!</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="77">
          <span class="hits">26</span>
          
          <code class="ruby">        @fields &lt;&lt; f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_fields</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="83">
          <span class="hits">4</span>
          
          <code class="ruby">    unless self.set_fields.blank?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">      data = JSON.parse(self.set_fields)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">      self.fields.each do |f|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="86">
          <span class="hits">5</span>
          
          <code class="ruby">        if data.has_key?(f.field_name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="87">
          <span class="hits">3</span>
          
          <code class="ruby">          f.value = data[f.field_name]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="88">
          <span class="hits">3</span>
          
          <code class="ruby">          f.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  def mandatory_fields_are_set</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="95">
          <span class="hits">45</span>
          
          <code class="ruby">    if !self.set_fields.blank? &amp;&amp; self.annotation_type != &#39;dynamic&#39;</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="96">
          <span class="hits">13</span>
          
          <code class="ruby">      annotation_type = DynamicAnnotation::AnnotationType.where(annotation_type: self.annotation_type).last</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="97">
          <span class="hits">13</span>
          
          <code class="ruby">      fields_set = JSON.parse(self.set_fields).keys</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="98">
          <span class="hits">36</span>
          
          <code class="ruby">      mandatory_fields = annotation_type.schema.reject{ |instance| instance.optional }.map(&amp;:name)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="99">
          <span class="hits">13</span>
          
          <code class="ruby">      errors.add(:base, &#39;Please set all mandatory fields&#39;) unless (mandatory_fields - fields_set).empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_annotator</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="104">
          <span class="hits">49</span>
          
          <code class="ruby">    self.annotator = User.current if !User.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6990b385898921bc3e78b9461981d1b486561be9">
  <div class="header">
    <h3>../models/annotations/embed.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>38</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Embed &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include SingletonAnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :title</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :embed</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :username</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :published_at, Integer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_slack on: :save,</code>
        </li>
      
        <li class="covered" data-hits="868" data-linenumber="11">
          <span class="hits">868</span>
          
          <code class="ruby">                 if: proc { |em| em.should_notify? and em.title_is_overridden? },</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">                 message: proc { |em| em.slack_notification_message},</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">                 channel: proc { |em| em.annotated.project.setting(:slack_channel) || em.current_team.setting(:slack_channel) },</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">                 webhook: proc { |em| em.current_team.setting(:slack_webhook) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :update_elasticsearch_embed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      title: self.title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      description: self.description,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      username: self.username,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      published_at: self.published_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      embed: self.embed</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_notification_message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    data = self.overridden_data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    I18n.t(:slack_save_embed, default: &quot;*%{user}* changed the title from *%{from}* to &lt;%{to}&gt;&quot;, user: User.current.name, from: data[0][&#39;title&#39;], to: &quot;#{CONFIG[&#39;checkdesk_client&#39;]}/#{self.annotated.project.team.slug}/project/#{self.annotated.project_id}/media/#{self.annotated_id}|#{data[1][&#39;title&#39;]}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def title_is_overridden?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    overriden = false</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    v = self.versions.last</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="36">
          <span class="hits">4</span>
          
          <code class="ruby">    unless v.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="37">
          <span class="hits">4</span>
          
          <code class="ruby">      data = self.get_overridden_data(v)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="38">
          <span class="hits">4</span>
          
          <code class="ruby">      overriden = (!data[0].blank? &amp;&amp; !data[0][&#39;title&#39;].nil? &amp;&amp; data[0][&#39;title&#39;] != data[1][&#39;title&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="40">
          <span class="hits">4</span>
          
          <code class="ruby">    self.overridden_data = data if overriden</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="41">
          <span class="hits">4</span>
          
          <code class="ruby">    overriden</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_overridden_data(version)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="45">
          <span class="hits">4</span>
          
          <code class="ruby">    data = version.changeset[&#39;data&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    # Get title from pender if Link has only one version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="47">
          <span class="hits">4</span>
          
          <code class="ruby">    if self.annotated.media.type == &#39;Link&#39; and self.versions.size == 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">      pender = self.annotated.get_media_annotations(&#39;embed&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">      data[0][&#39;title&#39;] = pender[&#39;data&#39;][&#39;title&#39;] unless pender.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="51">
          <span class="hits">4</span>
          
          <code class="ruby">    data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def overridden_data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">    @overridden_data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def overridden_data=(data)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    @overridden_data = data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_elasticsearch_embed</code>
        </li>
      
        <li class="covered" data-hits="868" data-linenumber="63">
          <span class="hits">868</span>
          
          <code class="ruby">    self.update_media_search(%w(title description)) if self.annotated_type == &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f8abb75e1a2e28109963dd40be7c8e6658ea993f">
  <div class="header">
    <h3>../models/annotations/flag.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Flag &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :flag, String, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :flag</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.flag_types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    [&#39;Spam&#39;, &#39;Graphic content&#39;, &#39;Needing fact-checking&#39;, &#39;Needing deletion&#39;, &#39;Follow story&#39;, &#39;Mark as graphic&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :flag, included: { values: self.flag_types }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.annotated_types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    [&#39;ProjectMedia&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    { flag: self.flag }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.where(email: value).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">    user.nil? ? nil : user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def target_id_callback(value, mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def flag_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    flags = Hash[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      &#39;spam&#39; =&gt; &#39;Spam&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">      &#39;graphic_journalist&#39; =&gt; &#39;Graphic content&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      &#39;factcheck_journalist&#39; =&gt; &#39;Needing fact-checking&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      &#39;graphic&#39; =&gt; &#39;Graphic content&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      &#39;factcheck&#39; =&gt; &#39;Needing fact-checking&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      &#39;delete&#39; =&gt; &#39;Needing deletion&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      &#39;follow_story&#39; =&gt; &#39;Follow story&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    ]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    flags[value].nil? ? value : flags[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="63dc70a62cd20a38eb7f5afb4207edc4ad22d818">
  <div class="header">
    <h3>../models/annotations/status.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>65</b> relevant lines. 
      <span class="green"><b>65</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Status &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include SingletonAnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :status, String, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :status_is_valid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :update</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :store_previous_status, :normalize_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :update_elasticsearch_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.core_verification_statuses(annotated_type)</code>
        </li>
      
        <li class="covered" data-hits="1152" data-linenumber="17">
          <span class="hits">1152</span>
          
          <code class="ruby">    core_statuses = YAML.load_file(File.join(Rails.root, &#39;config&#39;, &#39;core_statuses.yml&#39;))</code>
        </li>
      
        <li class="covered" data-hits="1152" data-linenumber="18">
          <span class="hits">1152</span>
          
          <code class="ruby">    key = &quot;#{annotated_type.upcase}_CORE_VERIFICATION_STATUSES&quot;</code>
        </li>
      
        <li class="covered" data-hits="1152" data-linenumber="19">
          <span class="hits">1152</span>
          
          <code class="ruby">    statuses = core_statuses.has_key?(key) ? core_statuses[key] : [{ id: &#39;undetermined&#39;, label: &#39;Undetermined&#39;, description: &#39;Undetermined&#39;, style: &#39;&#39; }]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      label: &#39;Status&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      default: &#39;undetermined&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      statuses: statuses</code>
        </li>
      
        <li class="covered" data-hits="1152" data-linenumber="25">
          <span class="hits">1152</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def store_previous_status</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="29">
          <span class="hits">424</span>
          
          <code class="ruby">    self.previous_annotated_status = self.annotated.last_status if self.annotated.respond_to?(:last_status)</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="30">
          <span class="hits">424</span>
          
          <code class="ruby">    annotated, context = get_annotated_and_context</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="31">
          <span class="hits">424</span>
          
          <code class="ruby">    self.previous_annotated_status ||= Status.default_id(annotated, context)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def previous_annotated_status</code>
        </li>
      
        <li class="covered" data-hits="426" data-linenumber="35">
          <span class="hits">426</span>
          
          <code class="ruby">    @previous_annotated_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def previous_annotated_status=(status)</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="39">
          <span class="hits">424</span>
          
          <code class="ruby">    @previous_annotated_status = status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    { status: self.status }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.where(email: value).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    user.nil? ? nil : user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def target_id_callback(value, mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotated_type_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    value.camelize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalize_status</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="60">
          <span class="hits">424</span>
          
          <code class="ruby">    self.status = self.status.tr(&#39; &#39;, &#39;_&#39;).downcase unless self.status.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.default_id(annotated, context = nil)</code>
        </li>
      
        <li class="covered" data-hits="727" data-linenumber="64">
          <span class="hits">727</span>
          
          <code class="ruby">    return nil if annotated.nil?</code>
        </li>
      
        <li class="covered" data-hits="723" data-linenumber="65">
          <span class="hits">723</span>
          
          <code class="ruby">    statuses = Status.possible_values(annotated, context)</code>
        </li>
      
        <li class="covered" data-hits="723" data-linenumber="66">
          <span class="hits">723</span>
          
          <code class="ruby">    statuses[:default].blank? ? statuses[:statuses].first[:id] : statuses[:default]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.possible_values(annotated, context = nil)</code>
        </li>
      
        <li class="covered" data-hits="1149" data-linenumber="70">
          <span class="hits">1149</span>
          
          <code class="ruby">    type = annotated.class_name</code>
        </li>
      
        <li class="covered" data-hits="1149" data-linenumber="71">
          <span class="hits">1149</span>
          
          <code class="ruby">    statuses = Status.core_verification_statuses(type)</code>
        </li>
      
        <li class="covered" data-hits="1149" data-linenumber="72">
          <span class="hits">1149</span>
          
          <code class="ruby">    getter = &quot;get_#{type.downcase}_verification_statuses&quot;</code>
        </li>
      
        <li class="covered" data-hits="1149" data-linenumber="73">
          <span class="hits">1149</span>
          
          <code class="ruby">    statuses = context.team.send(getter) if context &amp;&amp; context.respond_to?(:team) &amp;&amp; context.team &amp;&amp; context.team.send(getter)</code>
        </li>
      
        <li class="covered" data-hits="1149" data-linenumber="74">
          <span class="hits">1149</span>
          
          <code class="ruby">    statuses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def id_to_label(id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="78">
          <span class="hits">6</span>
          
          <code class="ruby">    values = Status.possible_values(self.annotated.media, self.annotated.project)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="79">
          <span class="hits">30</span>
          
          <code class="ruby">    values[:statuses].select{ |s| s[:id] === id }.first[:label]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_elasticsearch_status</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="83">
          <span class="hits">420</span>
          
          <code class="ruby">    self.update_media_search(%w(status))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    data = self.annotated.embed</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">    params = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">      default: &quot;*%{user}* changed the verification status on &lt;%{url}&gt; from *%{previous_status}* to *%{current_status}*&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      user: User.current.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      url: &quot;#{self.annotated_client_url}|#{data[&#39;title&#39;]}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      previous_status: self.id_to_label(self.previous_annotated_status),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">      current_status: self.id_to_label(self.status)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="95">
          <span class="hits">2</span>
          
          <code class="ruby">    I18n.t(:slack_update_status, params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">  def status_is_valid</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="101">
          <span class="hits">424</span>
          
          <code class="ruby">    if !self.annotated_type.blank?</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="102">
          <span class="hits">420</span>
          
          <code class="ruby">      annotated, context = get_annotated_and_context</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="103">
          <span class="hits">420</span>
          
          <code class="ruby">      values = Status.possible_values(annotated, context)</code>
        </li>
      
        <li class="covered" data-hits="2506" data-linenumber="104">
          <span class="hits">2506</span>
          
          <code class="ruby">      errors.add(:base, &#39;Status not valid&#39;) unless values[:statuses].collect{ |s| s[:id] }.include?(self.status)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_annotated_and_context</code>
        </li>
      
        <li class="covered" data-hits="844" data-linenumber="109">
          <span class="hits">844</span>
          
          <code class="ruby">    if self.annotated_type == &#39;ProjectMedia&#39; || self.annotated_type == &#39;ProjectSource&#39;</code>
        </li>
      
        <li class="covered" data-hits="838" data-linenumber="110">
          <span class="hits">838</span>
          
          <code class="ruby">      annotated = self.annotated.media if self.annotated.respond_to?(:media)</code>
        </li>
      
        <li class="covered" data-hits="838" data-linenumber="111">
          <span class="hits">838</span>
          
          <code class="ruby">      annotated = self.annotated.source if self.annotated.respond_to?(:source)</code>
        </li>
      
        <li class="covered" data-hits="838" data-linenumber="112">
          <span class="hits">838</span>
          
          <code class="ruby">      context = self.annotated.project if self.annotated.respond_to?(:project)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="114">
          <span class="hits">6</span>
          
          <code class="ruby">      annotated = self.annotated</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="115">
          <span class="hits">6</span>
          
          <code class="ruby">      context = self.context</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="844" data-linenumber="117">
          <span class="hits">844</span>
          
          <code class="ruby">    return annotated, context</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ee3b2e03d75af753c3c188173427c4cc40690014">
  <div class="header">
    <h3>../models/annotations/tag.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Tag &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  field :tag, String, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :full_tag, String, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :tag</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="8">
          <span class="hits">79</span>
          
          <code class="ruby">  validates :data, uniqueness: { scope: [:annotated_type, :annotated_id], message: I18n.t(:already_exists, default: &#39;already exists&#39;) }, if: lambda { |t| t.id.blank? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :normalize_tag, :store_full_tag</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :add_update_elasticsearch_tag</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  before_destroy :destroy_elasticsearch_tag</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    { tag: self.tag }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.where(email: value).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    user.nil? ? nil : user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def target_id_callback(value, mapping_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalize_tag</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="30">
          <span class="hits">78</span>
          
          <code class="ruby">    self.tag = self.tag.gsub(/^#/, &#39;&#39;) unless self.tag.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def store_full_tag</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="34">
          <span class="hits">78</span>
          
          <code class="ruby">    self.full_tag = self.tag</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_update_elasticsearch_tag</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="38">
          <span class="hits">75</span>
          
          <code class="ruby">    add_update_media_search_child(&#39;tag_search&#39;, %w(tag full_tag))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_elasticsearch_tag</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    destroy_elasticsearch_data(TagSearch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d7d22773707e4a69bb16bf302130a66e850a62e0">
  <div class="header">
    <h3>../models/annotations/task.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>70</b> relevant lines. 
      <span class="green"><b>70</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Task &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_initial_status, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  after_destroy :destroy_responses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :label</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :label</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :type</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.task_types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    [&#39;free_text&#39;, &#39;yes_no&#39;, &#39;single_choice&#39;, &#39;multiple_choice&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :type, included: { values: self.task_types }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :options</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :task_options_is_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :status</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.task_statuses</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    [&quot;Unresolved&quot;, &quot;Resolved&quot;, &quot;Can&#39;t be resolved&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :status, included: { values: self.task_statuses }, allow_blank: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :update</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  annotation_notifies_slack :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="31">
          <span class="hits">5</span>
          
          <code class="ruby">    if self.versions.count &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">      self.slack_message_on_update</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">      self.slack_message_on_create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message_on_create</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    params = self.slack_default_params.merge({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      default: &quot;*%{user}* created task &lt;%{url}&gt; in %{project} with note &#39;%{note}&#39;&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      note: self.description</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    I18n.t(:slack_create_task, params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_default_params</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      user: User.current.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      url: &quot;#{self.annotated_client_url}|#{self.label.tr(&quot;\n&quot;, &#39; &#39;)}&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      project: self.annotated.project.title</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="51">
          <span class="hits">7</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_message_on_update</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">    if self.data_changed?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">      data = self.data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">      data_was = self.data_was</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">      messages = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">        &#39;label&#39; =&gt; &#39;*%{user}* edited task &lt;%{url}&gt; in %{project}:\n&gt; *From:* %{from}\n&gt; *To*: %{to}&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">        &#39;description&#39; =&gt; &#39;*%{user}* edited task note in &lt;%{url}&gt; in %{project}:\n&gt; *From:* %{from}\n&gt; *To*: %{to}&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">      }.each do |key, message|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">        if data_was[key] != data[key]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="65">
          <span class="hits">4</span>
          
          <code class="ruby">          params = self.slack_default_params.merge({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">            default: message,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">            from: data_was[key],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">            to: data[key]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">          })</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="70">
          <span class="hits">4</span>
          
          <code class="ruby">          messages &lt;&lt; I18n.t(&quot;slack_update_task_#{key}&quot;.to_sym, params)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">      messages.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    hash = {}</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="80">
          <span class="hits">6</span>
          
          <code class="ruby">    %w(label type description options status).each{ |key| hash[key] = self.send(key) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    hash.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def jsonoptions=(json)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">    @json = json</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">    self.options = JSON.parse(json)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def jsonoptions</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    @json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def responses</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="94">
          <span class="hits">6</span>
          
          <code class="ruby">    DynamicAnnotation::Field.where(field_type: &#39;task_reference&#39;, value: self.id.to_s).to_a.map(&amp;:annotation)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def response</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="98">
          <span class="hits">2</span>
          
          <code class="ruby">    @response</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">  def response=(json)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="102">
          <span class="hits">10</span>
          
          <code class="ruby">    params = JSON.parse(json)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="103">
          <span class="hits">10</span>
          
          <code class="ruby">    response = Dynamic.new</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="104">
          <span class="hits">10</span>
          
          <code class="ruby">    response.annotated = self.annotated</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="105">
          <span class="hits">10</span>
          
          <code class="ruby">    response.annotation_type = params[&#39;annotation_type&#39;]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="106">
          <span class="hits">10</span>
          
          <code class="ruby">    response.set_fields = params[&#39;set_fields&#39;]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="107">
          <span class="hits">10</span>
          
          <code class="ruby">    response.save!</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="108">
          <span class="hits">10</span>
          
          <code class="ruby">    @response = response</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="109">
          <span class="hits">10</span>
          
          <code class="ruby">    self.record_timestamps = false</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="110">
          <span class="hits">10</span>
          
          <code class="ruby">    self.status = &#39;Resolved&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">  def task_options_is_array</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="116">
          <span class="hits">42</span>
          
          <code class="ruby">    errors.add(:options, &#39;must be an array&#39;) if !self.options.nil? &amp;&amp; !self.options.is_a?(Array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_initial_status</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="120">
          <span class="hits">31</span>
          
          <code class="ruby">    self.status ||= &#39;Unresolved&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_responses</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="124">
          <span class="hits">2</span>
          
          <code class="ruby">    self.responses.each do |annotation|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">      annotation.load.fields.delete_all</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">      annotation.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b6b59f4ff888ef6ea9487a9185078d04c31e62e3">
  <div class="header">
    <h3>../models/api_key.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ApiKey &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :access_token, :expire_at</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :access_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :generate_access_token, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :calculate_expiration_date, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # Reimplement this method in your application</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.applications</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    [nil]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="13">
          <span class="hits">10</span>
          
          <code class="ruby">  validates :application, inclusion: { in: proc { ApiKey.applications } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def generate_access_token</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="18">
          <span class="hits">9</span>
          
          <code class="ruby">    loop do</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="19">
          <span class="hits">9</span>
          
          <code class="ruby">      self.access_token = SecureRandom.hex</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="20">
          <span class="hits">9</span>
          
          <code class="ruby">      break unless ApiKey.where(access_token: access_token).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def calculate_expiration_date</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="25">
          <span class="hits">9</span>
          
          <code class="ruby">    self.expire_at = Time.now.since(30.days)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f71d6556b512a66892d45117be9fe4c749192a19">
  <div class="header">
    <h3>../models/bot.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Bot &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :avatar, ImageUploader</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def profile_image</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    CONFIG[&#39;checkdesk_base_url&#39;] + self.avatar.url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8921f3293fd57be4af7c9b962257d36c9b6da762">
  <div class="header">
    <h3>../models/bounce.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># How to create a bounce from the command line: $ bundle exec rails runner &quot;Bounce.create!(email: &#39;test@test.com&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">class Bounce &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_bounces(*recipients)</code>
        </li>
      
        <li class="covered" data-hits="357" data-linenumber="5">
          <span class="hits">357</span>
          
          <code class="ruby">    recipients.flatten.reject{ |r| Bounce.where(email: r).exists? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d9ba5a0035c64322dee16d249283ffddea93cc5e">
  <div class="header">
    <h3>../models/claim.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>2</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Claim &lt; Media</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :quote, presence: true, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="75a92083bcaf99cdb20ff3f398eda1c53dc2082b">
  <div class="header">
    <h3>../models/concerns/annotation_base.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>149</b> relevant lines. 
      <span class="green"><b>149</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module AnnotationBase</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  module Association</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.included(base)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      base.send :extend, ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      def define_annotators_method</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="11">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :annotators do</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="12">
          <span class="hits">34</span>
          
          <code class="ruby">          query = self.annotation_query</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="13">
          <span class="hits">34</span>
          
          <code class="ruby">          query[:annotator_type] = &#39;User&#39;</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="14">
          <span class="hits">34</span>
          
          <code class="ruby">          annotators = []</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="15">
          <span class="hits">34</span>
          
          <code class="ruby">          Annotation.group(:annotator_id, :id).having(query).each do |result|</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="16">
          <span class="hits">55</span>
          
          <code class="ruby">            annotators &lt;&lt; User.find(result.annotator_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="18">
          <span class="hits">34</span>
          
          <code class="ruby">          annotators.uniq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      def define_annotation_relation_method</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="23">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :annotation_relation do |type=nil|</code>
        </li>
      
        <li class="covered" data-hits="869" data-linenumber="24">
          <span class="hits">869</span>
          
          <code class="ruby">          query = self.annotation_query(type)</code>
        </li>
      
        <li class="covered" data-hits="869" data-linenumber="25">
          <span class="hits">869</span>
          
          <code class="ruby">          klass = (type.blank? || type.is_a?(Array)) ? Annotation : type.camelize.constantize</code>
        </li>
      
        <li class="covered" data-hits="869" data-linenumber="26">
          <span class="hits">869</span>
          
          <code class="ruby">          relation = klass.where(query)</code>
        </li>
      
        <li class="covered" data-hits="869" data-linenumber="27">
          <span class="hits">869</span>
          
          <code class="ruby">          relation.order(&#39;id DESC&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">      def has_annotations</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="32">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :annotation_query do |type=nil|</code>
        </li>
      
        <li class="covered" data-hits="903" data-linenumber="33">
          <span class="hits">903</span>
          
          <code class="ruby">          matches = { annotated_type: self.class_name, annotated_id: self.id }</code>
        </li>
      
        <li class="covered" data-hits="903" data-linenumber="34">
          <span class="hits">903</span>
          
          <code class="ruby">          matches[:annotation_type] = [*type] unless type.nil?</code>
        </li>
      
        <li class="covered" data-hits="903" data-linenumber="35">
          <span class="hits">903</span>
          
          <code class="ruby">          matches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="38">
          <span class="hits">8</span>
          
          <code class="ruby">        define_annotation_relation_method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="40">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :annotations do |type=nil|</code>
        </li>
      
        <li class="covered" data-hits="850" data-linenumber="41">
          <span class="hits">850</span>
          
          <code class="ruby">          self.annotation_relation(type).all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="44">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :annotations_count do |type=nil|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">          self.annotation_relation(type).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="48">
          <span class="hits">8</span>
          
          <code class="ruby">        define_method :add_annotation do |annotation|</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="49">
          <span class="hits">29</span>
          
          <code class="ruby">          annotation.annotated = self</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="50">
          <span class="hits">29</span>
          
          <code class="ruby">          annotation.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="53">
          <span class="hits">8</span>
          
          <code class="ruby">        define_annotators_method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  included do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="59">
          <span class="hits">8</span>
          
          <code class="ruby">    include ActiveModel::Validations</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="60">
          <span class="hits">8</span>
          
          <code class="ruby">    include ActiveModel::Validations::Callbacks</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="61">
          <span class="hits">8</span>
          
          <code class="ruby">    include PaperTrail::Model</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="62">
          <span class="hits">8</span>
          
          <code class="ruby">    include CheckPermissions</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="63">
          <span class="hits">8</span>
          
          <code class="ruby">    include CheckNotifications::Slack</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="64">
          <span class="hits">8</span>
          
          <code class="ruby">    include CheckNotifications::Pusher</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="65">
          <span class="hits">8</span>
          
          <code class="ruby">    include CheckElasticSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="67">
          <span class="hits">8</span>
          
          <code class="ruby">    attr_accessor :disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="68">
          <span class="hits">8</span>
          
          <code class="ruby">    self.table_name = &#39;annotations&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="70">
          <span class="hits">8</span>
          
          <code class="ruby">    notifies_pusher on: :save,</code>
        </li>
      
        <li class="covered" data-hits="1690" data-linenumber="71">
          <span class="hits">1690</span>
          
          <code class="ruby">                    if: proc { |a| a.annotated_type === &#39;ProjectMedia&#39; },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">                    event: &#39;media_updated&#39;,</code>
        </li>
      
        <li class="covered" data-hits="716" data-linenumber="73">
          <span class="hits">716</span>
          
          <code class="ruby">                    targets: proc { |a| [a.annotated.project, a.annotated.media] },</code>
        </li>
      
        <li class="covered" data-hits="716" data-linenumber="74">
          <span class="hits">716</span>
          
          <code class="ruby">                    data: proc { |a| a.to_json }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="76">
          <span class="hits">8</span>
          
          <code class="ruby">    before_validation :set_type_and_event, :set_annotator</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="77">
          <span class="hits">8</span>
          
          <code class="ruby">    after_initialize :start_serialized_fields</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1698" data-linenumber="79">
          <span class="hits">1698</span>
          
          <code class="ruby">    has_paper_trail on: [:create, :update], save_changes: true, ignore: [:updated_at, :created_at, :id, :entities], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="81">
          <span class="hits">8</span>
          
          <code class="ruby">    serialize :data, HashWithIndifferentAccess</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="82">
          <span class="hits">8</span>
          
          <code class="ruby">    serialize :entities, Array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="84">
          <span class="hits">8</span>
          
          <code class="ruby">    def self.annotated_types</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="85">
          <span class="hits">8</span>
          
          <code class="ruby">      [&#39;ProjectSource&#39;, &#39;ProjectMedia&#39;, &#39;Source&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1719" data-linenumber="87">
          <span class="hits">1719</span>
          
          <code class="ruby">    validates :annotated_type, included: { values: self.annotated_types }, allow_blank: true, :unless =&gt; Proc.new { |annotation| annotation.annotation_type == &#39;embed&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="89">
          <span class="hits">8</span>
          
          <code class="ruby">    private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="91">
          <span class="hits">8</span>
          
          <code class="ruby">    def start_serialized_fields</code>
        </li>
      
        <li class="covered" data-hits="3030" data-linenumber="92">
          <span class="hits">3030</span>
          
          <code class="ruby">      self.data ||= {}</code>
        </li>
      
        <li class="covered" data-hits="3030" data-linenumber="93">
          <span class="hits">3030</span>
          
          <code class="ruby">      self.entities ||= []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    def all_sorted(order = &#39;asc&#39;, field = &#39;created_at&#39;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="99">
          <span class="hits">5</span>
          
          <code class="ruby">      type = self.name.parameterize</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="100">
          <span class="hits">5</span>
          
          <code class="ruby">      query = type === &#39;annotation&#39; ? {} : { annotation_type: type }</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="101">
          <span class="hits">5</span>
          
          <code class="ruby">      Annotation.where(query).order(field =&gt; order.to_sym).all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">    def length</code>
        </li>
      
        <li class="covered" data-hits="76" data-linenumber="105">
          <span class="hits">76</span>
          
          <code class="ruby">      type = self.name.parameterize</code>
        </li>
      
        <li class="covered" data-hits="76" data-linenumber="106">
          <span class="hits">76</span>
          
          <code class="ruby">      Annotation.where(annotation_type: type).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    def field(name, _type = String, _options = {})</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="110">
          <span class="hits">15</span>
          
          <code class="ruby">      define_method &quot;#{name}=&quot; do |value=nil|</code>
        </li>
      
        <li class="covered" data-hits="2403" data-linenumber="111">
          <span class="hits">2403</span>
          
          <code class="ruby">        self.data ||= {}</code>
        </li>
      
        <li class="covered" data-hits="2403" data-linenumber="112">
          <span class="hits">2403</span>
          
          <code class="ruby">        self.data[name.to_sym] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="115">
          <span class="hits">15</span>
          
          <code class="ruby">      define_method name do</code>
        </li>
      
        <li class="covered" data-hits="2753" data-linenumber="116">
          <span class="hits">2753</span>
          
          <code class="ruby">        self.data ||= {}</code>
        </li>
      
        <li class="covered" data-hits="2753" data-linenumber="117">
          <span class="hits">2753</span>
          
          <code class="ruby">        self.data[name.to_sym]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">    def annotation_notifies_slack(event)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="122">
          <span class="hits">6</span>
          
          <code class="ruby">      notifies_slack on: event,</code>
        </li>
      
        <li class="covered" data-hits="317" data-linenumber="123">
          <span class="hits">317</span>
          
          <code class="ruby">                     if: proc { |a| a.should_notify? },</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="124">
          <span class="hits">11</span>
          
          <code class="ruby">                     message: proc { |a| a.slack_message },</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="125">
          <span class="hits">11</span>
          
          <code class="ruby">                     channel: proc { |a| a.annotated.project.setting(:slack_channel) || a.current_team.setting(:slack_channel) },</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="126">
          <span class="hits">11</span>
          
          <code class="ruby">                     webhook: proc { |a| a.current_team.setting(:slack_webhook) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">  def versions(options = {})</code>
        </li>
      
        <li class="covered" data-hits="3556" data-linenumber="131">
          <span class="hits">3556</span>
          
          <code class="ruby">    PaperTrail::Version.where(options).where(item_type: [self.class.to_s], item_id: self.id).order(&#39;id ASC&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">  def source</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="135">
          <span class="hits">12</span>
          
          <code class="ruby">    self.annotated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  def project_media</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="139">
          <span class="hits">11</span>
          
          <code class="ruby">    self.annotated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">  def project</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="143">
          <span class="hits">7</span>
          
          <code class="ruby">    self.annotated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotated</code>
        </li>
      
        <li class="covered" data-hits="7509" data-linenumber="147">
          <span class="hits">7509</span>
          
          <code class="ruby">    self.load_polymorphic(&#39;annotated&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotated=(obj)</code>
        </li>
      
        <li class="covered" data-hits="1817" data-linenumber="151">
          <span class="hits">1817</span>
          
          <code class="ruby">    self.set_polymorphic(&#39;annotated&#39;, obj) unless obj.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator</code>
        </li>
      
        <li class="covered" data-hits="386" data-linenumber="155">
          <span class="hits">386</span>
          
          <code class="ruby">    self.load_polymorphic(&#39;annotator&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotator=(obj)</code>
        </li>
      
        <li class="covered" data-hits="1697" data-linenumber="159">
          <span class="hits">1697</span>
          
          <code class="ruby">    self.set_polymorphic(&#39;annotator&#39;, obj) unless obj.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  # Overwrite in the annotation type and expose the specific fields of that type</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="163">
          <span class="hits">1</span>
          
          <code class="ruby">  def content</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="164">
          <span class="hits">7</span>
          
          <code class="ruby">    fields = self.get_fields</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="165">
          <span class="hits">7</span>
          
          <code class="ruby">    fields.empty? ? self.data.to_json : fields.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_fields</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="169">
          <span class="hits">7</span>
          
          <code class="ruby">    DynamicAnnotation::Field.where(annotation_id: self.id).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_annotation?</code>
        </li>
      
        <li class="covered" data-hits="367" data-linenumber="173">
          <span class="hits">367</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  def ==(annotation)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="177">
          <span class="hits">13</span>
          
          <code class="ruby">    annotation.respond_to?(:id) ? (self.id == annotation.id) : super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">  def dbid</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="181">
          <span class="hits">2</span>
          
          <code class="ruby">    self.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">  def relay_id(type)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="185">
          <span class="hits">6</span>
          
          <code class="ruby">    str = &quot;#{type.capitalize}/#{self.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="186">
          <span class="hits">6</span>
          
          <code class="ruby">    str += &quot;/#{self.version.id}&quot; unless self.version.nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="187">
          <span class="hits">6</span>
          
          <code class="ruby">    Base64.encode64(str)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team</code>
        </li>
      
        <li class="covered" data-hits="272" data-linenumber="191">
          <span class="hits">272</span>
          
          <code class="ruby">    team = []</code>
        </li>
      
        <li class="covered" data-hits="272" data-linenumber="192">
          <span class="hits">272</span>
          
          <code class="ruby">    obj = self.annotated.project if self.annotated.respond_to?(:project)</code>
        </li>
      
        <li class="covered" data-hits="272" data-linenumber="193">
          <span class="hits">272</span>
          
          <code class="ruby">    if !obj.nil? and obj.respond_to?(:team)</code>
        </li>
      
        <li class="covered" data-hits="234" data-linenumber="194">
          <span class="hits">234</span>
          
          <code class="ruby">      team = [obj.team.id] unless obj.team.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="272" data-linenumber="196">
          <span class="hits">272</span>
          
          <code class="ruby">    team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">  def current_team</code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="200">
          <span class="hits">195</span>
          
          <code class="ruby">    self.annotated.project.team if self.annotated_type === &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">  def should_notify?</code>
        </li>
      
        <li class="covered" data-hits="1185" data-linenumber="204">
          <span class="hits">1185</span>
          
          <code class="ruby">    User.current.present? &amp;&amp; self.current_team.present? &amp;&amp; self.current_team.setting(:slack_notifications_enabled).to_i === 1 &amp;&amp; self.annotated_type === &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  # Supports only media for the time being</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">  def entity_objects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">    ProjectMedia.where(id: self.entities).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def method_missing(method, *args, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="213">
          <span class="hits">12</span>
          
          <code class="ruby">    (args.empty? &amp;&amp; !block_given?) ? self.data[method] : super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotation_type_class</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="217">
          <span class="hits">2</span>
          
          <code class="ruby">    klass = nil</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="218">
          <span class="hits">2</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="219">
          <span class="hits">2</span>
          
          <code class="ruby">      klass = self.annotation_type.camelize.constantize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    rescue NameError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">      klass = Dynamic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="223">
          <span class="hits">2</span>
          
          <code class="ruby">    klass</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotated_client_url</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="227">
          <span class="hits">13</span>
          
          <code class="ruby">    &quot;#{CONFIG[&#39;checkdesk_client&#39;]}/#{self.annotated.project.team.slug}/project/#{self.annotated.project_id}/media/#{self.annotated_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_polymorphic(name)</code>
        </li>
      
        <li class="covered" data-hits="7895" data-linenumber="233">
          <span class="hits">7895</span>
          
          <code class="ruby">    type, id = self.send(&quot;#{name}_type&quot;), self.send(&quot;#{name}_id&quot;)</code>
        </li>
      
        <li class="covered" data-hits="7895" data-linenumber="234">
          <span class="hits">7895</span>
          
          <code class="ruby">    return nil if type.blank? &amp;&amp; id.blank?</code>
        </li>
      
        <li class="covered" data-hits="7820" data-linenumber="235">
          <span class="hits">7820</span>
          
          <code class="ruby">    Rails.cache.fetch(&quot;find_#{type.parameterize}_#{id}&quot;, expires_in: 30.seconds, race_condition_ttl: 30.seconds) do</code>
        </li>
      
        <li class="covered" data-hits="627" data-linenumber="236">
          <span class="hits">627</span>
          
          <code class="ruby">      type.constantize.find(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_polymorphic(name, obj)</code>
        </li>
      
        <li class="covered" data-hits="3475" data-linenumber="241">
          <span class="hits">3475</span>
          
          <code class="ruby">    self.send(&quot;#{name}_type=&quot;, obj.class_name)</code>
        </li>
      
        <li class="covered" data-hits="3475" data-linenumber="242">
          <span class="hits">3475</span>
          
          <code class="ruby">    self.send(&quot;#{name}_id=&quot;, obj.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_type_and_event</code>
        </li>
      
        <li class="covered" data-hits="1712" data-linenumber="248">
          <span class="hits">1712</span>
          
          <code class="ruby">    self.annotation_type ||= self.class_name.parameterize</code>
        </li>
      
        <li class="covered" data-hits="1712" data-linenumber="249">
          <span class="hits">1712</span>
          
          <code class="ruby">    self.paper_trail_event = &#39;create&#39; if self.versions.count === 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="252">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_annotator</code>
        </li>
      
        <li class="covered" data-hits="371" data-linenumber="253">
          <span class="hits">371</span>
          
          <code class="ruby">    self.annotator = User.current if self.annotator.nil? &amp;&amp; !User.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="be8643e296f5cc0ce2c559640b75be969504ff9c">
  <div class="header">
    <h3>../models/concerns/check_elastic_search_model.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckElasticSearchModel</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  included do</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="5">
          <span class="hits">4</span>
          
          <code class="ruby">    include ActiveModel::Validations</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">    include ActiveModel::Validations::Callbacks</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="7">
          <span class="hits">4</span>
          
          <code class="ruby">    include Elasticsearch::Persistence::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    index_name CONFIG[&#39;elasticsearch_index&#39;].blank? ? [Rails.application.engine_name, Rails.env, &#39;annotations&#39;].join(&#39;_&#39;) : CONFIG[&#39;elasticsearch_index&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    settings analysis: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      char_filter: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">        space_hashtags: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">          type: &#39;mapping&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">          mappings: [&#39;#=&gt;|#&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      filter: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">        hashtag_as_alphanum: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">          type: &#39;word_delimiter&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">          type_table: [&#39;# =&gt; ALPHANUM&#39;, &#39;@ =&gt; ALPHANUM&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      analyzer: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">        hashtag: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">          type: &#39;custom&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">          char_filter: &#39;space_hashtags&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">          tokenizer: &#39;whitespace&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">          filter: [&#39;lowercase&#39;, &#39;hashtag_as_alphanum&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    attribute :annotation_type, String</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    before_validation :set_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def save!(options = {})</code>
        </li>
      
        <li class="covered" data-hits="127" data-linenumber="39">
          <span class="hits">127</span>
          
          <code class="ruby">    raise &#39;Sorry, this is not valid&#39; unless self.save(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_type</code>
        </li>
      
        <li class="covered" data-hits="204" data-linenumber="45">
          <span class="hits">204</span>
          
          <code class="ruby">    self.annotation_type ||= self.class.name.parameterize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    def create_index</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="50">
          <span class="hits">773</span>
          
          <code class="ruby">      client = self.gateway.client</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="51">
          <span class="hits">773</span>
          
          <code class="ruby">      index_name = self.index_name</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="52">
          <span class="hits">773</span>
          
          <code class="ruby">      settings = []</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="53">
          <span class="hits">773</span>
          
          <code class="ruby">      mappings = []</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="54">
          <span class="hits">773</span>
          
          <code class="ruby">      [MediaSearch, CommentSearch, TagSearch, DynamicSearch].each do |klass|</code>
        </li>
      
        <li class="covered" data-hits="3092" data-linenumber="55">
          <span class="hits">3092</span>
          
          <code class="ruby">        settings &lt;&lt; klass.settings.to_hash</code>
        </li>
      
        <li class="covered" data-hits="3092" data-linenumber="56">
          <span class="hits">3092</span>
          
          <code class="ruby">        mappings &lt;&lt; klass.mappings.to_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="58">
          <span class="hits">773</span>
          
          <code class="ruby">      settings = settings.reduce(:merge)</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="59">
          <span class="hits">773</span>
          
          <code class="ruby">      mappings = mappings.reduce(:merge)</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="60">
          <span class="hits">773</span>
          
          <code class="ruby">      client.indices.create index: index_name, body: { settings: settings.to_hash, mappings: mappings.to_hash }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    def delete_index</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="64">
          <span class="hits">773</span>
          
          <code class="ruby">      client = self.gateway.client</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="65">
          <span class="hits">773</span>
          
          <code class="ruby">      index_name = self.index_name</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="66">
          <span class="hits">773</span>
          
          <code class="ruby">      if client.indices.exists? index: index_name</code>
        </li>
      
        <li class="covered" data-hits="773" data-linenumber="67">
          <span class="hits">773</span>
          
          <code class="ruby">        client.indices.delete index: index_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    def all_sorted(order = &#39;asc&#39;, field = &#39;created_at&#39;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">      type = self.name.parameterize</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">      query = type === &#39;annotation&#39; ? { match_all: {} } : { bool: { must: [{ match: { annotation_type: type } }] } }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">      self.search(query: query, sort: [{ field =&gt; { order: order }}, &#39;_score&#39;], size: 10000).results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    def length</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="78">
          <span class="hits">10</span>
          
          <code class="ruby">      type = self.name.parameterize</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="79">
          <span class="hits">10</span>
          
          <code class="ruby">      self.count({ query: { bool: { must: [{ match: { annotation_type: type } }] } } })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5cf765db826269aee89547b8b67f3c5f69483758">
  <div class="header">
    <h3>../models/concerns/singleton_annotation_base.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module SingletonAnnotationBase</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include AnnotationBase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    # should revert singleton annotation</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="7">
          <span class="hits">15</span>
          
          <code class="ruby">    widget = self.paper_trail.previous_version</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="8">
          <span class="hits">15</span>
          
          <code class="ruby">    if widget.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      # delete annotation if no versions</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="10">
          <span class="hits">11</span>
          
          <code class="ruby">      Annotation.find(self.id).delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">      widget.paper_trail.without_versioning do</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">        widget.save!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">        self.versions.last.destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_annotator</code>
        </li>
      
        <li class="covered" data-hits="1292" data-linenumber="22">
          <span class="hits">1292</span>
          
          <code class="ruby">    self.annotator = User.current unless User.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b99d3c6215364c93afba58a43a5c46a4d9e84b30">
  <div class="header">
    <h3>../models/concerns/versioned.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;active_support/concern&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">module Versioned</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ActiveSupport::Concern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  included do</code>
        </li>
      
        <li class="covered" data-hits="411" data-linenumber="7">
          <span class="hits">411</span>
          
          <code class="ruby">    has_paper_trail on: [:create, :update], save_changes: true, ignore: [:updated_at, :created_at], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7e40128b02941c0a83a7037470df0fbbb7dd02fe">
  <div class="header">
    <h3>../models/contact.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Contact &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  phony_normalize :phone, default_country_code: &#39;US&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :phone, phony_plausible: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6a70a3e982d25e9e446c5cba2adc2378cae20642">
  <div class="header">
    <h3>../models/dynamic_annotation.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module DynamicAnnotation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.table_name_prefix</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="3">
          <span class="hits">4</span>
          
          <code class="ruby">    &#39;dynamic_annotation_&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="671bf174271bfb71d29fa72bf80498036c0537d4">
  <div class="header">
    <h3>../models/dynamic_annotation/annotation_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DynamicAnnotation::AnnotationType &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :annotation_type, machine_name: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :annotation_type_is_available</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :schema, class_name: &#39;DynamicAnnotation::FieldInstance&#39;, foreign_key: &#39;annotation_type&#39;, primary_key: &#39;annotation_type&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :annotations, class_name: &#39;Annotation&#39;, foreign_key: &#39;annotation_type&#39;, primary_key: &#39;annotation_type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def annotation_type_is_available</code>
        </li>
      
        <li class="covered" data-hits="65" data-linenumber="12">
          <span class="hits">65</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="65" data-linenumber="13">
          <span class="hits">65</span>
          
          <code class="ruby">      self.annotation_type.camelize.constantize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      errors.add(:annotation_type, &#39;is not available&#39;)</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="15">
          <span class="hits">64</span>
          
          <code class="ruby">    rescue NameError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">      # Not defined</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5eff9284892f3ecbe23daf42f6c9ae94cf2e88e1">
  <div class="header">
    <h3>../models/dynamic_annotation/field.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DynamicAnnotation::Field &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :annotation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :annotation_type_object, class_name: &#39;DynamicAnnotation::AnnotationType&#39;, foreign_key: &#39;annotation_type&#39;, primary_key: &#39;annotation_type&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :field_instance, class_name: &#39;DynamicAnnotation::FieldInstance&#39;, foreign_key: &#39;field_name&#39;, primary_key: &#39;name&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :field_type_object, class_name: &#39;DynamicAnnotation::FieldType&#39;, foreign_key: &#39;field_type&#39;, primary_key: &#39;field_type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  serialize :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_annotation_type, :set_field_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  include Versioned</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_annotation_type</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="16">
          <span class="hits">46</span>
          
          <code class="ruby">    self.annotation_type ||= self.annotation.annotation_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_field_type</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="20">
          <span class="hits">46</span>
          
          <code class="ruby">    self.field_type ||= self.field_instance.field_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9a27f34ff1d68452443f2df18147af0d536dfeda">
  <div class="header">
    <h3>../models/dynamic_annotation/field_instance.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DynamicAnnotation::FieldInstance &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :field_type_object, class_name: &#39;DynamicAnnotation::FieldType&#39;, primary_key: &#39;field_type&#39;, foreign_key: &#39;field_type&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :annotation_type_object, class_name: &#39;DynamicAnnotation::AnnotationType&#39;, primary_key: &#39;annotation_type&#39;, foreign_key: &#39;annotation_type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  serialize :settings </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :name, machine_name: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c59f4a7753b4947479cb46c9572a751b75c290af">
  <div class="header">
    <h3>../models/dynamic_annotation/field_type.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>3</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DynamicAnnotation::FieldType &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :field_type, machine_name: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :field_instances, class_name: &#39;DynamicAnnotation::FieldInstance&#39;, foreign_key: &#39;field_type&#39;, primary_key: &#39;field_type&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2c58c801b65c00b8ae2851bb0ca46657408e5336">
  <div class="header">
    <h3>../models/link.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Link &lt; Media</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include PenderData</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :url, presence: true, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :validate_pender_result, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :pender_result_is_an_item, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :url_is_unique, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :set_pender_result_as_annotation, :set_account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def domain</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    host = URI.parse(self.url).host unless self.url.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    host.nil? ? nil : host.gsub(/^(www|m)\./, &#39;&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_account</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="19">
          <span class="hits">360</span>
          
          <code class="ruby">    unless self.pender_data.nil?</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="20">
          <span class="hits">360</span>
          
          <code class="ruby">      account = Account.new</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="21">
          <span class="hits">360</span>
          
          <code class="ruby">      account.url = self.pender_data[&#39;author_url&#39;]</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="22">
          <span class="hits">360</span>
          
          <code class="ruby">      if account.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">        self.account = account</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="358" data-linenumber="25">
          <span class="hits">358</span>
          
          <code class="ruby">        self.account = Account.where(url: account.url).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="27">
          <span class="hits">360</span>
          
          <code class="ruby">      self.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def pender_result_is_an_item</code>
        </li>
      
        <li class="covered" data-hits="369" data-linenumber="32">
          <span class="hits">369</span>
          
          <code class="ruby">    unless self.pender_data.nil?</code>
        </li>
      
        <li class="covered" data-hits="368" data-linenumber="33">
          <span class="hits">368</span>
          
          <code class="ruby">      errors.add(:base, I18n.t(:invalid_media_item, default: &#39;Sorry, this is not a valid media item&#39;)) unless self.pender_data[&#39;type&#39;] == &#39;item&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def url_is_unique</code>
        </li>
      
        <li class="covered" data-hits="369" data-linenumber="38">
          <span class="hits">369</span>
          
          <code class="ruby">    unless self.url.nil?</code>
        </li>
      
        <li class="covered" data-hits="369" data-linenumber="39">
          <span class="hits">369</span>
          
          <code class="ruby">      existing = Media.where(url: self.url).first</code>
        </li>
      
        <li class="covered" data-hits="369" data-linenumber="40">
          <span class="hits">369</span>
          
          <code class="ruby">      errors.add(:base, &quot;Media with this URL exists and has id #{existing.id}&quot;) unless existing.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a36420c425896c79cfb738a58e59151d38966a6a">
  <div class="header">
    <h3>../models/media.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>42</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Media &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  self.inheritance_column = :type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :project_id, :project_object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="751" data-linenumber="6">
          <span class="hits">751</span>
          
          <code class="ruby">  has_paper_trail on: [:create, :update], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :account</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :project_medias, dependent: :destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :projects, through: :project_medias</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_type, :set_url_nil_if_empty, :set_user, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    %w(Link Claim UploadedFile UploadedImage)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_inclusion_of :type, in: Media.types</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def class_name</code>
        </li>
      
        <li class="covered" data-hits="1942" data-linenumber="22">
          <span class="hits">1942</span>
          
          <code class="ruby">    &#39;Media&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    user_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def account_id_callback(value, mapping_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="34">
          <span class="hits">38</span>
          
          <code class="ruby">    self.projects.map(&amp;:team_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team_objects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    self.projects.map(&amp;:team)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def overridden_embed_attributes</code>
        </li>
      
        <li class="covered" data-hits="360" data-linenumber="42">
          <span class="hits">360</span>
          
          <code class="ruby">    %W(title description username quote)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def embed_path</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def thumbnail_path</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_url_nil_if_empty</code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="56">
          <span class="hits">397</span>
          
          <code class="ruby">    self.url = nil if self.url.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_user</code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="60">
          <span class="hits">397</span>
          
          <code class="ruby">    self.user = User.current unless User.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.class_from_input(input)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">    type = nil</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="65">
          <span class="hits">4</span>
          
          <code class="ruby">    if input[:url].blank?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="66">
          <span class="hits">3</span>
          
          <code class="ruby">      type = &#39;Claim&#39; unless input[:quote].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">      type = &#39;Link&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="70">
          <span class="hits">4</span>
          
          <code class="ruby">    type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_type</code>
        </li>
      
        <li class="covered" data-hits="397" data-linenumber="74">
          <span class="hits">397</span>
          
          <code class="ruby">    self.type = Media.class_from_input({ url: self.url, quote: self.quote }) if self.type.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ed14b2241f62604d1979262fe25b6566376d70df">
  <div class="header">
    <h3>../models/project.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>51</b> relevant lines. 
      <span class="green"><b>51</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Project &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1283" data-linenumber="3">
          <span class="hits">1283</span>
          
          <code class="ruby">  has_paper_trail on: [:create, :update], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :project_sources</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :sources , through: :project_sources</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :project_medias, dependent: :destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :medias , through: :project_medias</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :lead_image, ImageUploader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_description_and_team_and_user, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :title</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :lead_image, size: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_slack on: :create,</code>
        </li>
      
        <li class="covered" data-hits="1269" data-linenumber="21">
          <span class="hits">1269</span>
          
          <code class="ruby">                 if: proc { |p| User.current.present? &amp;&amp; p.team.setting(:slack_notifications_enabled).to_i === 1 },</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">                 message: proc { |p| I18n.t(:slack_create_project, default: &quot;*%{user}* created a project: &lt;%{url}&gt;&quot;, user: User.current.name, url: &quot;#{CONFIG[&#39;checkdesk_client&#39;]}/#{p.team.slug}/project/#{p.id}|*#{p.title}*&quot;) },</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">                 channel: proc { |p| p.setting(:slack_channel) || p.team.setting(:slack_channel) },</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">                 webhook: proc { |p| p.team.setting(:slack_webhook) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_pusher on: :create,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">                  event: &#39;project_created&#39;,</code>
        </li>
      
        <li class="covered" data-hits="1269" data-linenumber="28">
          <span class="hits">1269</span>
          
          <code class="ruby">                  targets: proc { |p| [p.team] },</code>
        </li>
      
        <li class="covered" data-hits="1269" data-linenumber="29">
          <span class="hits">1269</span>
          
          <code class="ruby">                  data: proc { |p| p.to_json }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckSettings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    user_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def team_id_callback(value, mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def lead_image_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>
          
          <code class="ruby">    image_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def avatar</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    CONFIG[&#39;checkdesk_base_url&#39;] + self.lead_image.url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(options = {})</code>
        </li>
      
        <li class="covered" data-hits="2640" data-linenumber="50">
          <span class="hits">2640</span>
          
          <code class="ruby">    project = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      dbid: self.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      title: self.title,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      id: Base64.encode64(&quot;Project/#{self.id}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="2640" data-linenumber="55">
          <span class="hits">2640</span>
          
          <code class="ruby">    unless options[:without_team]</code>
        </li>
      
        <li class="covered" data-hits="1272" data-linenumber="56">
          <span class="hits">1272</span>
          
          <code class="ruby">      project[:team] = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">        id: Base64.encode64(&quot;Team/#{self.id}&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">        dbid: self.team_id,</code>
        </li>
      
        <li class="covered" data-hits="1368" data-linenumber="59">
          <span class="hits">1368</span>
          
          <code class="ruby">        projects: { edges: self.team.projects.collect{ |p| { node: p.as_json(without_team: true) } } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2640" data-linenumber="62">
          <span class="hits">2640</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def medias_count</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">    self.project_medias.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_notifications_enabled=(enabled)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_slack_notifications_enabled, enabled)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_channel=(channel)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_slack_channel, channel)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def admin_label</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="78">
          <span class="hits">5</span>
          
          <code class="ruby">    unless self.new_record?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      [self.team.name.truncate(15),self.title.truncate(25)].join(&#39; - &#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_description_and_team_and_user</code>
        </li>
      
        <li class="covered" data-hits="1274" data-linenumber="86">
          <span class="hits">1274</span>
          
          <code class="ruby">    self.description ||= &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1274" data-linenumber="87">
          <span class="hits">1274</span>
          
          <code class="ruby">    if !User.current.nil? &amp;&amp; !self.team_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">      self.team = User.current.current_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1274" data-linenumber="90">
          <span class="hits">1274</span>
          
          <code class="ruby">    self.user ||= User.current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="018645750caab849ffc8c046d36609a27913e7c9">
  <div class="header">
    <h3>../models/project_media.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>172</b> relevant lines. 
      <span class="green"><b>172</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectMedia &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :url, :quote, :file, :embed, :disable_es_callbacks, :previous_project_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :media</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  include Versioned</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :media_id, :project_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_media, :set_user, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :is_unique, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :set_quote_embed, :set_initial_media_status, :add_elasticsearch_data, :create_auto_tasks</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  after_update :update_elasticsearch_data</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  before_destroy :destroy_elasticsearch_media</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_slack on: :create,</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="21">
          <span class="hits">345</span>
          
          <code class="ruby">                 if: proc { |pm| t = pm.project.team; User.current.present? &amp;&amp; t.present? &amp;&amp; t.setting(:slack_notifications_enabled).to_i === 1 },</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="22">
          <span class="hits">6</span>
          
          <code class="ruby">                 message: proc { |pm| pm.slack_notification_message },</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="23">
          <span class="hits">6</span>
          
          <code class="ruby">                 channel: proc { |pm| p = pm.project; p.setting(:slack_channel) || p.team.setting(:slack_channel) },</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="24">
          <span class="hits">6</span>
          
          <code class="ruby">                 webhook: proc { |pm| pm.project.team.setting(:slack_webhook) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_pusher on: :create,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">                  event: &#39;media_updated&#39;,</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="28">
          <span class="hits">345</span>
          
          <code class="ruby">                  targets: proc { |pm| [pm.project] },</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="29">
          <span class="hits">345</span>
          
          <code class="ruby">                  data: proc { |pm| pm.media.to_json }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckElasticSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def project_id_callback(value, mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_initial_media_status</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="38">
          <span class="hits">345</span>
          
          <code class="ruby">    st = Status.new</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="39">
          <span class="hits">345</span>
          
          <code class="ruby">    st.annotated = self</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="40">
          <span class="hits">345</span>
          
          <code class="ruby">    st.annotator = self.user</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="41">
          <span class="hits">345</span>
          
          <code class="ruby">    st.status = Status.default_id(self.media, self.project)</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="42">
          <span class="hits">345</span>
          
          <code class="ruby">    st.created_at = self.created_at</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="43">
          <span class="hits">345</span>
          
          <code class="ruby">    st.disable_es_callbacks = self.disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="44">
          <span class="hits">345</span>
          
          <code class="ruby">    st.skip_check_ability = true</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="45">
          <span class="hits">345</span>
          
          <code class="ruby">    st.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_notification_message</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="49">
          <span class="hits">8</span>
          
          <code class="ruby">    m = self.media</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="50">
          <span class="hits">8</span>
          
          <code class="ruby">    data = self.embed</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="51">
          <span class="hits">8</span>
          
          <code class="ruby">    type, text = m.quote.blank? ?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      [ &#39;link&#39;, data[&#39;title&#39;] ] :</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      [ &#39;claim&#39;, m.quote ]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="54">
          <span class="hits">8</span>
          
          <code class="ruby">    I18n.t(:slack_create_project_media, default: &quot;*%{user}* added a new %{type}: &lt;%{url}&gt;&quot;, user: User.current.name, type: I18n.t(type.to_sym), url: &quot;#{CONFIG[&#39;checkdesk_client&#39;]}/#{self.project.team.slug}/project/#{self.project_id}/media/#{self.id}|*#{text}*&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_elasticsearch_data</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="58">
          <span class="hits">345</span>
          
          <code class="ruby">    return if self.disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="59">
          <span class="hits">75</span>
          
          <code class="ruby">    p = self.project</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="60">
          <span class="hits">75</span>
          
          <code class="ruby">    m = self.media</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="61">
          <span class="hits">75</span>
          
          <code class="ruby">    ms = MediaSearch.new</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="62">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.id = self.id</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="63">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.team_id = p.team.id</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="64">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.project_id = p.id</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="65">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.set_es_annotated(self)</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="66">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.status = self.last_status</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="67">
          <span class="hits">75</span>
          
          <code class="ruby">    data = self.embed</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="68">
          <span class="hits">75</span>
          
          <code class="ruby">    unless data.nil?</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="69">
          <span class="hits">75</span>
          
          <code class="ruby">      ms.title = data[&#39;title&#39;]</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="70">
          <span class="hits">75</span>
          
          <code class="ruby">      ms.description = data[&#39;description&#39;]</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="71">
          <span class="hits">75</span>
          
          <code class="ruby">      ms.quote = m.quote</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="73">
          <span class="hits">75</span>
          
          <code class="ruby">    ms.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    # ElasticSearchWorker.perform_in(1.second, YAML::dump(ms), YAML::dump({}), &#39;add_parent&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_elasticsearch_data</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="78">
          <span class="hits">18</span>
          
          <code class="ruby">    return if self.disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>
          
          <code class="ruby">    keys = %w(project_id team_id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="80">
          <span class="hits">3</span>
          
          <code class="ruby">    data = {&#39;project_id&#39; =&gt; self.project_id, &#39;team_id&#39; =&gt; self.project.team_id}</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="81">
          <span class="hits">3</span>
          
          <code class="ruby">    ElasticSearchWorker.perform_in(1.second, YAML::dump(self), YAML::dump(keys), YAML::dump(data), &#39;update_parent&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_elasticsearch_media</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="85">
          <span class="hits">6</span>
          
          <code class="ruby">    destroy_elasticsearch_data(MediaSearch, &#39;parent&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_annotations(type = nil)</code>
        </li>
      
        <li class="covered" data-hits="631" data-linenumber="89">
          <span class="hits">631</span>
          
          <code class="ruby">    self.annotations.where(annotation_type: type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_versions_log</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="93">
          <span class="hits">21</span>
          
          <code class="ruby">    events = %w(create_comment update_status create_tag create_task create_dynamicannotationfield update_dynamicannotationfield create_flag update_embed update_projectmedia update_task create_embed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="95">
          <span class="hits">21</span>
          
          <code class="ruby">    joins = &quot;LEFT JOIN annotations &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">            &quot;ON versions.item_type IN (&#39;Status&#39;,&#39;Comment&#39;,&#39;Embed&#39;,&#39;Tag&#39;,&#39;Flag&#39;,&#39;Dynamic&#39;,&#39;Task&#39;,&#39;Annotation&#39;) &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">            &quot;AND CAST(annotations.id AS TEXT) = versions.item_id &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">            &quot;AND annotations.annotated_type = &#39;ProjectMedia&#39; &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">            &quot;LEFT JOIN dynamic_annotation_fields d &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">            &quot;ON CAST(d.id AS TEXT) = versions.item_id &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">            &quot;AND versions.item_type = &#39;DynamicAnnotation::Field&#39; &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">            &quot;LEFT JOIN annotations a2 &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">            &quot;ON a2.id = d.annotation_id &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">            &quot;AND a2.annotated_type = &#39;ProjectMedia&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="106">
          <span class="hits">21</span>
          
          <code class="ruby">    where = &quot;(annotations.id IS NOT NULL AND annotations.annotated_id = ?) &quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">            &quot;OR (d.id IS NOT NULL AND a2.annotated_id = ?)&quot;\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">            &quot;OR (annotations.id IS NULL AND d.id IS NULL AND versions.item_type = &#39;ProjectMedia&#39; AND versions.item_id = ?)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="110">
          <span class="hits">21</span>
          
          <code class="ruby">    PaperTrail::Version.joins(joins).where(where, self.id, self.id, self.id.to_s).where(&#39;versions.event_type&#39; =&gt; events).distinct(&#39;versions.id&#39;).order(&#39;versions.id ASC&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_versions_log_count</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="114">
          <span class="hits">2</span>
          
          <code class="ruby">    self.get_versions_log.where.not(event_type: &#39;create_dynamicannotationfield&#39;).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_media_annotations(type = nil)</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="118">
          <span class="hits">104</span>
          
          <code class="ruby">    self.media.annotations.where(annotation_type: type).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def embed</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="122">
          <span class="hits">96</span>
          
          <code class="ruby">    em_pender = self.get_media_annotations(&#39;embed&#39;)</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="123">
          <span class="hits">96</span>
          
          <code class="ruby">    em_overriden = self.get_annotations(&#39;embed&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="124">
          <span class="hits">96</span>
          
          <code class="ruby">    if em_overriden.nil?</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="125">
          <span class="hits">82</span>
          
          <code class="ruby">      em = em_pender</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="127">
          <span class="hits">14</span>
          
          <code class="ruby">      em = em_overriden</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="128">
          <span class="hits">14</span>
          
          <code class="ruby">      em[&#39;data&#39;][&#39;embed&#39;] = em_pender[&#39;data&#39;][&#39;embed&#39;] unless em_pender.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="130">
          <span class="hits">96</span>
          
          <code class="ruby">    embed = JSON.parse(em.data[&#39;embed&#39;]) unless em.nil?</code>
        </li>
      
        <li class="covered" data-hits="384" data-linenumber="131">
          <span class="hits">384</span>
          
          <code class="ruby">    self.overridden_embed_attributes.each{ |k| sk = k.to_s; embed[sk] = em.data[sk] unless em.data[sk].nil? } unless embed.nil?</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="132">
          <span class="hits">96</span>
          
          <code class="ruby">    embed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_status</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="136">
          <span class="hits">475</span>
          
          <code class="ruby">    last = self.get_annotations(&#39;status&#39;).first</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="137">
          <span class="hits">475</span>
          
          <code class="ruby">    last.nil? ? Status.default_id(self, self.project) : last.data[:status]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def overridden</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="141">
          <span class="hits">13</span>
          
          <code class="ruby">    data = {}</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="142">
          <span class="hits">52</span>
          
          <code class="ruby">    self.overridden_embed_attributes.each{|k| data[k] = false}</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="143">
          <span class="hits">13</span>
          
          <code class="ruby">    if self.media.type == &#39;Link&#39;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="144">
          <span class="hits">10</span>
          
          <code class="ruby">      em = self.get_annotations(&#39;embed&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="145">
          <span class="hits">10</span>
          
          <code class="ruby">      unless em.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="146">
          <span class="hits">7</span>
          
          <code class="ruby">        em_media = self.get_media_annotations(&#39;embed&#39;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="147">
          <span class="hits">7</span>
          
          <code class="ruby">        data.each do |k, _v|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="148">
          <span class="hits">21</span>
          
          <code class="ruby">          data[k] = true if em[&#39;data&#39;][k] != em_media[&#39;data&#39;][k] and !em[&#39;data&#39;][k].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="152">
          <span class="hits">13</span>
          
          <code class="ruby">    data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="155">
          <span class="hits">1</span>
          
          <code class="ruby">  def overridden_embed_attributes</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="156">
          <span class="hits">112</span>
          
          <code class="ruby">    %W(title description username)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">  def embed=(info)</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="160">
          <span class="hits">47</span>
          
          <code class="ruby">    info = info.blank? ? {} : JSON.parse(info)</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="161">
          <span class="hits">47</span>
          
          <code class="ruby">    unless info.blank?</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="162">
          <span class="hits">47</span>
          
          <code class="ruby">      em = self.get_annotations(&#39;embed&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="163">
          <span class="hits">47</span>
          
          <code class="ruby">      em = em.load unless em.nil?</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="164">
          <span class="hits">47</span>
          
          <code class="ruby">      em = initiate_embed_annotation(info) if em.nil?</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="165">
          <span class="hits">47</span>
          
          <code class="ruby">      self.override_embed_data(em, info)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.belonged_to_project(pmid, pid)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="170">
          <span class="hits">14</span>
          
          <code class="ruby">    pm = ProjectMedia.find_by_id pmid</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="171">
          <span class="hits">14</span>
          
          <code class="ruby">    if pm &amp;&amp; (pm.project_id == pid || pm.versions.where_object(project_id: pid).exists?)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="172">
          <span class="hits">12</span>
          
          <code class="ruby">      return pm.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="174">
          <span class="hits">2</span>
          
          <code class="ruby">      pm = ProjectMedia.where(project_id: pid, media_id: pmid).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="175">
          <span class="hits">2</span>
          
          <code class="ruby">      return pm.id if pm</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>
          
          <code class="ruby">  def project_was</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="180">
          <span class="hits">7</span>
          
          <code class="ruby">    Project.find(self.previous_project_id) unless self.previous_project_id.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_image</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="186">
          <span class="hits">2</span>
          
          <code class="ruby">    m = UploadedImage.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="187">
          <span class="hits">2</span>
          
          <code class="ruby">    m.file = self.file</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="188">
          <span class="hits">2</span>
          
          <code class="ruby">    m.save!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="189">
          <span class="hits">2</span>
          
          <code class="ruby">    m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_claim</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="193">
          <span class="hits">4</span>
          
          <code class="ruby">    m = Claim.new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="194">
          <span class="hits">4</span>
          
          <code class="ruby">    m.quote = self.quote</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="195">
          <span class="hits">4</span>
          
          <code class="ruby">    m.save!</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="196">
          <span class="hits">4</span>
          
          <code class="ruby">    m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_link</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="200">
          <span class="hits">5</span>
          
          <code class="ruby">    m = Link.new</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="201">
          <span class="hits">5</span>
          
          <code class="ruby">    m.url = self.url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    # call m.valid? to get normalized URL before caling &#39;find_or_create_by&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="203">
          <span class="hits">5</span>
          
          <code class="ruby">    m.valid?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="204">
          <span class="hits">5</span>
          
          <code class="ruby">    m = Link.find_or_create_by(url: m.url)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="205">
          <span class="hits">5</span>
          
          <code class="ruby">    m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_media</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="209">
          <span class="hits">11</span>
          
          <code class="ruby">    m = nil</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="210">
          <span class="hits">11</span>
          
          <code class="ruby">    if !self.file.blank?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="211">
          <span class="hits">2</span>
          
          <code class="ruby">      m = self.create_image</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="212">
          <span class="hits">9</span>
          
          <code class="ruby">    elsif !self.quote.blank?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="213">
          <span class="hits">4</span>
          
          <code class="ruby">      m = self.create_claim</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="215">
          <span class="hits">5</span>
          
          <code class="ruby">      m = self.create_link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="217">
          <span class="hits">11</span>
          
          <code class="ruby">    m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_unique</code>
        </li>
      
        <li class="covered" data-hits="348" data-linenumber="223">
          <span class="hits">348</span>
          
          <code class="ruby">    pm = ProjectMedia.where(project_id: self.project_id, media_id: self.media_id).last</code>
        </li>
      
        <li class="covered" data-hits="348" data-linenumber="224">
          <span class="hits">348</span>
          
          <code class="ruby">    errors.add(:base, &quot;This media already exists in this project and has id #{pm.id}&quot;) unless pm.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="227">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_media</code>
        </li>
      
        <li class="covered" data-hits="348" data-linenumber="228">
          <span class="hits">348</span>
          
          <code class="ruby">    unless self.url.blank? &amp;&amp; self.quote.blank? &amp;&amp; self.file.blank?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="229">
          <span class="hits">11</span>
          
          <code class="ruby">      m = self.create_media</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="230">
          <span class="hits">11</span>
          
          <code class="ruby">      self.media_id = m.id unless m.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_quote_embed</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="235">
          <span class="hits">345</span>
          
          <code class="ruby">    self.embed = ({ title: self.media.quote }.to_json) unless self.media.quote.blank?</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="236">
          <span class="hits">345</span>
          
          <code class="ruby">    self.embed = ({ title: File.basename(self.media.file.path) }.to_json) unless self.media.file.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_user</code>
        </li>
      
        <li class="covered" data-hits="348" data-linenumber="240">
          <span class="hits">348</span>
          
          <code class="ruby">    self.user = User.current unless User.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_auto_tasks</code>
        </li>
      
        <li class="covered" data-hits="345" data-linenumber="244">
          <span class="hits">345</span>
          
          <code class="ruby">    if self.project &amp;&amp; self.project.team &amp;&amp; !self.project.team.get_checklist.blank?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="245">
          <span class="hits">3</span>
          
          <code class="ruby">      self.project.team.get_checklist.each do |task|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="246">
          <span class="hits">5</span>
          
          <code class="ruby">        if task[&#39;projects&#39;].empty? || task[&#39;projects&#39;].include?(self.project.id)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="247">
          <span class="hits">4</span>
          
          <code class="ruby">          t = Task.new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="248">
          <span class="hits">4</span>
          
          <code class="ruby">          t.label = task[&#39;label&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="249">
          <span class="hits">4</span>
          
          <code class="ruby">          t.type = task[&#39;type&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="250">
          <span class="hits">4</span>
          
          <code class="ruby">          t.description = task[&#39;description&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="251">
          <span class="hits">4</span>
          
          <code class="ruby">          t.annotator = User.current</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="252">
          <span class="hits">4</span>
          
          <code class="ruby">          t.annotated = self</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="253">
          <span class="hits">4</span>
          
          <code class="ruby">          t.skip_check_ability = true</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="254">
          <span class="hits">4</span>
          
          <code class="ruby">          t.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  def initiate_embed_annotation(info)</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="263">
          <span class="hits">40</span>
          
          <code class="ruby">    em = Embed.new</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="264">
          <span class="hits">40</span>
          
          <code class="ruby">    em.embed = info.to_json</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="265">
          <span class="hits">40</span>
          
          <code class="ruby">    em.annotated = self</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="266">
          <span class="hits">40</span>
          
          <code class="ruby">    em.annotator = User.current unless User.current.nil?</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="267">
          <span class="hits">40</span>
          
          <code class="ruby">    em</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">  def override_embed_data(em, info)</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="271">
          <span class="hits">104</span>
          
          <code class="ruby">    info.each{ |k, v| em.send(&quot;#{k}=&quot;, v) if em.respond_to?(k) and !v.blank? }</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="272">
          <span class="hits">47</span>
          
          <code class="ruby">    em.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8b210e5ce38e68c88483135b05a8cec4c0494c90">
  <div class="header">
    <h3>../models/project_source.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectSource &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :source</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    p = self.project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    p.nil? ? [] : [p.team_id]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def tags</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    self.annotations(&#39;tag&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def comments</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    self.annotations(&#39;comment&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def collaborators</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    self.annotators</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1ff24a3a20e4469d85f8504e0a64fe6799d255bc">
  <div class="header">
    <h3>../models/root_level.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class RootLevel &lt; Struct.new :id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  STATIC = new(id: &#39;root&#39;).freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find(_)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    STATIC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b270baf8337df92dec8f6b1b7a0cc6e23eea6d18">
  <div class="header">
    <h3>../models/search/comment_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CommentSearch</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckElasticSearchModel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :text, String, presence: true, mapping: { analyzer: &#39;hashtag&#39; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  mapping _parent: { type: &#39;media_search&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dc0e2c42b7a3f5ac9e5815eaaf4e2c32f0f8f665">
  <div class="header">
    <h3>../models/search/dynamic_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DynamicSearch</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckElasticSearchModel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :indexable, String, presence: true, mapping: { analyzer: &#39;hashtag&#39; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :indexable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  mapping _parent: { type: &#39;media_search&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0e3b59e250237f0beb297e5b58af12e0ed7a038a">
  <div class="header">
    <h3>../models/search/media_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MediaSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckElasticSearchModel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :team_id, String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :project_id, String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :annotated_type, String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :annotated_id, String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :status, String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :title, String, mapping: { analyzer: &#39;hashtag&#39; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :description, String, mapping: { analyzer: &#39;hashtag&#39; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :quote, String, mapping: { analyzer: &#39;hashtag&#39; }</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="13">
          <span class="hits">86</span>
          
          <code class="ruby">  attribute :last_activity_at, Time, default: lambda { |_o, _a| Time.now.utc }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_es_annotated(obj)</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="16">
          <span class="hits">75</span>
          
          <code class="ruby">    self.send(&quot;annotated_type=&quot;, obj.class.name)</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="17">
          <span class="hits">75</span>
          
          <code class="ruby">    self.send(&quot;annotated_id=&quot;, obj.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3d5ecefc7af32a1dbd18f2e7f9217605250164f0">
  <div class="header">
    <h3>../models/search/tag_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class TagSearch</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckElasticSearchModel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :tag, String, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  attribute :full_tag, String, presence: true, mapping: { index: &#39;not_analyzed&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :tag</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  mapping _parent: { type: &#39;media_search&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e99d048c239a2368822ce6af1f081dbda7fa12a0">
  <div class="header">
    <h3>../models/source.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>31</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Source &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="3906" data-linenumber="2">
          <span class="hits">3906</span>
          
          <code class="ruby">  has_paper_trail on: [:create, :update], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :accounts</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :project_sources</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :projects , through: :project_sources</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    user_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def avatar_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    image_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def medias</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    #TODO: fix me - list valid project media ids</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="22">
          <span class="hits">21</span>
          
          <code class="ruby">    m_ids = Media.where(account_id: self.account_ids).map(&amp;:id)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="23">
          <span class="hits">21</span>
          
          <code class="ruby">    ProjectMedia.where(media_id: m_ids)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_team</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>
          
          <code class="ruby">    teams = []</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    projects = self.projects.map(&amp;:id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">    teams = Project.where(:id =&gt; projects).map(&amp;:team_id).uniq unless projects.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    return teams</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def image</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="34">
          <span class="hits">5</span>
          
          <code class="ruby">    self.avatar</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def description</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">    return self.slogan unless self.slogan == self.name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    self.accounts.empty? ? &#39;&#39; : self.accounts.first.data[&#39;description&#39;].to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def collaborators</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="43">
          <span class="hits">22</span>
          
          <code class="ruby">    self.annotators</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def tags</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="47">
          <span class="hits">21</span>
          
          <code class="ruby">    self.annotations(&#39;tag&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def comments</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="51">
          <span class="hits">21</span>
          
          <code class="ruby">    self.annotations(&#39;comment&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="71b9adc3090ff3c43d0d7e55aaab936d62d43a9b">
  <div class="header">
    <h3>../models/team.rb</h3>
    <h4><span class="green">99.03 %</span> covered</h4>
    <div>
      <b>103</b> relevant lines. 
      <span class="green"><b>102</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Team &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1417" data-linenumber="3">
          <span class="hits">1417</span>
          
          <code class="ruby">  has_paper_trail on: [:create, :update], if: proc { |_x| User.current.present? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :projects, dependent: :destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :accounts, dependent: :destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :team_users, dependent: :destroy</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :users, through: :team_users</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :contacts, dependent: :destroy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :logo, ImageUploader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :normalize_slug, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :slug</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_format_of :slug, with: /\A[[:alnum:]-]+\z/, message: I18n.t(:slug_format_validation_message, default: &#39;accepts only letters, numbers and hyphens&#39;), on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :slug, length: { in: 4..63 }, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :slug, uniqueness: true, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :slug_is_not_reserved</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :logo, size: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :slack_webhook_format</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :custom_media_statuses_format</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :custom_source_statuses_format</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :add_user_to_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  has_annotations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  RESERVED_SLUGS = [&#39;check&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckSettings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def logo_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    image_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def avatar</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="39">
          <span class="hits">8</span>
          
          <code class="ruby">    CONFIG[&#39;checkdesk_base_url&#39;] + self.logo.url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def members_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    self.users.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(_options = {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      dbid: self.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      id: Base64.encode64(&quot;Team/#{self.id}&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      avatar: self.avatar,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      name: self.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      projects: self.recent_projects,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      slug: self.slug</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="54">
          <span class="hits">7</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def owners</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="58">
          <span class="hits">327</span>
          
          <code class="ruby">    self.users.where(&#39;team_users.role&#39; =&gt; &#39;owner&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def recent_projects</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="62">
          <span class="hits">11</span>
          
          <code class="ruby">    self.projects.order(&#39;id DESC&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def contact=(info)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">    contact = self.contacts.first || Contact.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="67">
          <span class="hits">2</span>
          
          <code class="ruby">    info = JSON.parse(info)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="68">
          <span class="hits">2</span>
          
          <code class="ruby">    contact.web = info[&#39;web&#39;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">    contact.phone = info[&#39;phone&#39;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">    contact.location = info[&#39;location&#39;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">    contact.team = self</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">    contact.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def verification_statuses(type)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="76">
          <span class="hits">3</span>
          
          <code class="ruby">    statuses = self.send(&quot;get_#{type}_verification_statuses&quot;) || Status.core_verification_statuses(type)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="77">
          <span class="hits">3</span>
          
          <code class="ruby">    statuses.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def recipients(requestor)</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="81">
          <span class="hits">327</span>
          
          <code class="ruby">    owners = self.owners</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="82">
          <span class="hits">327</span>
          
          <code class="ruby">    recipients = []</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="83">
          <span class="hits">327</span>
          
          <code class="ruby">    if !owners.empty? &amp;&amp; !owners.include?(requestor)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="84">
          <span class="hits">32</span>
          
          <code class="ruby">      recipients = owners.map(&amp;:email).reject{ |m| m.blank? }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="86">
          <span class="hits">327</span>
          
          <code class="ruby">    recipients</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def media_verification_statuses=(statuses)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_media_verification_statuses, statuses)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def source_verification_statuses=(statuses)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_source_verification_statuses, statuses)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_notifications_enabled=(enabled)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_slack_notifications_enabled, enabled)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_webhook=(webhook)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_slack_webhook, webhook)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_channel=(channel)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    self.send(:set_slack_channel, channel)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">  def checklist=(checklist)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="110">
          <span class="hits">2</span>
          
          <code class="ruby">    self.send(:set_checklist, checklist)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">  def custom_statuses_format(type)</code>
        </li>
      
        <li class="covered" data-hits="2860" data-linenumber="116">
          <span class="hits">2860</span>
          
          <code class="ruby">    statuses = self.send(&quot;get_#{type}_verification_statuses&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2860" data-linenumber="117">
          <span class="hits">2860</span>
          
          <code class="ruby">    unless statuses.nil?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="118">
          <span class="hits">9</span>
          
          <code class="ruby">      if statuses[:label].blank? || !statuses[:statuses].is_a?(Array) || statuses[:statuses].size === 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">        errors.add(:base, I18n.t(:invalid_format_for_custom_verification_status, default: &#39;Invalid format for custom verification statuses&#39;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="121">
          <span class="hits">8</span>
          
          <code class="ruby">        statuses[:statuses].each do |status|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="122">
          <span class="hits">11</span>
          
          <code class="ruby">          errors.add(:base, &#39;Invalid format for custom verification status&#39;) if status.keys.map(&amp;:to_sym).sort != [:description, :id, :label, :style]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_user_to_team</code>
        </li>
      
        <li class="covered" data-hits="1380" data-linenumber="131">
          <span class="hits">1380</span>
          
          <code class="ruby">    user = User.current</code>
        </li>
      
        <li class="covered" data-hits="1380" data-linenumber="132">
          <span class="hits">1380</span>
          
          <code class="ruby">    unless user.nil?</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="133">
          <span class="hits">15</span>
          
          <code class="ruby">      tu = TeamUser.new</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="134">
          <span class="hits">15</span>
          
          <code class="ruby">      tu.user = user</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="135">
          <span class="hits">15</span>
          
          <code class="ruby">      tu.team = self</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="136">
          <span class="hits">15</span>
          
          <code class="ruby">      tu.role = &#39;owner&#39;</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="137">
          <span class="hits">15</span>
          
          <code class="ruby">      tu.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="139">
          <span class="hits">15</span>
          
          <code class="ruby">      user.current_team_id = self.id</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="140">
          <span class="hits">15</span>
          
          <code class="ruby">      user.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.slug_from_name(name)</code>
        </li>
      
        <li class="covered" data-hits="1343" data-linenumber="145">
          <span class="hits">1343</span>
          
          <code class="ruby">    name.parameterize.underscore.dasherize.ljust(4, &#39;-&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current</code>
        </li>
      
        <li class="covered" data-hits="3375" data-linenumber="149">
          <span class="hits">3375</span>
          
          <code class="ruby">    Thread.current[:team]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current=(team)</code>
        </li>
      
        <li class="covered" data-hits="1089" data-linenumber="153">
          <span class="hits">1089</span>
          
          <code class="ruby">    Thread.current[:team] = team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.slug_from_url(url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">    URI(url).path.split(&#39;/&#39;)[1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">  def slack_webhook_format</code>
        </li>
      
        <li class="covered" data-hits="1430" data-linenumber="161">
          <span class="hits">1430</span>
          
          <code class="ruby">    webhook = self.get_slack_webhook</code>
        </li>
      
        <li class="covered" data-hits="1430" data-linenumber="162">
          <span class="hits">1430</span>
          
          <code class="ruby">    if !webhook.blank? &amp;&amp; /\Ahttps?:\/\/hooks\.slack\.com\/services\/[^\s]+\z/.match(webhook).nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="163">
          <span class="hits">1</span>
          
          <code class="ruby">      errors.add(:base, I18n.t(:slack_webhook_format_wrong, default: &#39;Slack webhook format is wrong&#39;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="167">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalize_slug</code>
        </li>
      
        <li class="covered" data-hits="1390" data-linenumber="168">
          <span class="hits">1390</span>
          
          <code class="ruby">    self.slug = self.slug.downcase unless self.slug.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  def custom_media_statuses_format</code>
        </li>
      
        <li class="covered" data-hits="1430" data-linenumber="172">
          <span class="hits">1430</span>
          
          <code class="ruby">    self.custom_statuses_format(:media)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">  def custom_source_statuses_format</code>
        </li>
      
        <li class="covered" data-hits="1430" data-linenumber="176">
          <span class="hits">1430</span>
          
          <code class="ruby">    self.custom_statuses_format(:source)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>
          
          <code class="ruby">  def slug_is_not_reserved</code>
        </li>
      
        <li class="covered" data-hits="1430" data-linenumber="180">
          <span class="hits">1430</span>
          
          <code class="ruby">    errors.add(:slug, I18n.t(:slug_is_reserved, default: &#39;is reserved&#39;)) if RESERVED_SLUGS.include?(self.slug)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="daf3cc08eef40d66411e0ae6a531b961f544e1dd">
  <div class="header">
    <h3>../models/team_user.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class TeamUser &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :status, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :user_id, uniqueness: { scope: :team_id, message: &#39;already joined this team&#39; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :user_is_member_in_slack_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :set_role_default_value, on: :create</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :send_email_to_team_owners</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  after_save :send_email_to_requestor</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  notifies_slack on: :create,</code>
        </li>
      
        <li class="covered" data-hits="403" data-linenumber="15">
          <span class="hits">403</span>
          
          <code class="ruby">                 if: proc { |tu| User.current.present? &amp;&amp; tu.team.setting(:slack_notifications_enabled).to_i === 1 },</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">                 message: proc { |tu| I18n.t(:slack_create_team_user, default: &quot;*%{user}* joined &lt;%{url}&gt;&quot;, user: tu.user.name, url: &quot;#{CONFIG[&#39;checkdesk_client&#39;]}/#{tu.team.slug}|*#{tu.team.name}*&quot;) },</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">                 channel: proc { |tu| tu.team.setting(:slack_channel) },</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">                 webhook: proc { |tu| tu.team.setting(:slack_webhook) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.status_types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    %w(member requested invited banned)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :status, included: { values: self.status_types }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.role_types</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    %w(owner editor journalist contributor)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :role, included: { values: self.role_types }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_id_callback(value, _mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    user_callback(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def team_id_callback(value, mapping_ids = nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    mapping_ids[value]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(_options = {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      id: self.team.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      name: self.team.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      role: self.role,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      status: self.status</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="44">
          <span class="hits">8</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_email_to_team_owners</code>
        </li>
      
        <li class="covered" data-hits="403" data-linenumber="50">
          <span class="hits">403</span>
          
          <code class="ruby">    TeamUserMailer.delay.request_to_join(self.team, self.user, CONFIG[&#39;checkdesk_client&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_email_to_requestor</code>
        </li>
      
        <li class="covered" data-hits="459" data-linenumber="54">
          <span class="hits">459</span>
          
          <code class="ruby">    if self.status_was === &#39;requested&#39; &amp;&amp; [&#39;member&#39;, &#39;banned&#39;].include?(self.status)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">      accepted = self.status === &#39;member&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">      TeamUserMailer.delay.request_to_join_processed(self.team, self.user, accepted, CONFIG[&#39;checkdesk_client&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_role_default_value</code>
        </li>
      
        <li class="covered" data-hits="409" data-linenumber="61">
          <span class="hits">409</span>
          
          <code class="ruby">    self.role = &#39;contributor&#39; if self.role.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  # Validate that a Slack user is part of the team&#39;s `slack_teams` setting.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  # The `slack_teams` should be a hash of the form:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  # { &#39;Slack team 1 id&#39; =&gt; &#39;Slack team 1 name&#39;, &#39;Slack team 2 id&#39; =&gt; &#39;Slack team 2 name&#39;, ... }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_is_member_in_slack_team</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    if self.user.provider == &#39;slack&#39; &amp;&amp;</code>
        </li>
      
        <li class="covered" data-hits="470" data-linenumber="69">
          <span class="hits">470</span>
          
          <code class="ruby">        self.team.setting(:slack_teams)&amp;.is_a?(Hash) &amp;&amp;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">        (!self.team.setting(:slack_teams)&amp;.keys&amp;.include? self.user.omniauth_info&amp;.dig(&#39;info&#39;, &#39;team_id&#39;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">        errors.add(:base, &quot;Sorry, you cannot join #{self.team.name} because it is restricted to members of the Slack #{&quot;team&quot;.pluralize(self.team.setting(:slack_teams).values.length)} #{self.team.setting(:slack_teams).values.join(&#39;, &#39;)}.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="227095a68c55b053e6b5111362ae3cff24b02f4a">
  <div class="header">
    <h3>../models/uploaded_file.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UploadedFile &lt; Media</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :file, FileUploader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :file, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :file, safe: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def public_path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    CONFIG[&#39;checkdesk_base_url&#39;] + self.file.url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.max_size</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    ENV[&#39;MAX_UPLOAD_SIZE&#39;] ? Filesize.from(&quot;#{ENV[&#39;MAX_UPLOAD_SIZE&#39;]}B&quot;).to_f : (CONFIG[&#39;uploaded_file_max_size&#39;] || 1.megabyte)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.max_size_readable</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    Filesize.new(UploadedFile.max_size, Filesize::SI).pretty</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :file, file_size: { less_than: UploadedFile.max_size, message: &quot;size should be less than #{UploadedFile.max_size_readable}&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fef511b3fcaffc59a16d70d0b6840bd64f3dc31a">
  <div class="header">
    <h3>../models/uploaded_image.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UploadedImage &lt; UploadedFile</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :file, ImageUploader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :file, size: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def embed_path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    self.image_path(&#39;embed&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def thumbnail_path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    self.image_path(&#39;thumbnail&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def image_path(version = &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    CONFIG[&#39;checkdesk_base_url&#39;] + self.file_url(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4a07c80a4841a4bea1d05c6d98daf9bb801c62d0">
  <div class="header">
    <h3>../models/user.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>132</b> relevant lines. 
      <span class="green"><b>132</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class User &lt; ActiveRecord::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  has_one :source</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :team_users</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :teams, through: :team_users</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :projects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :accounts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  devise :database_authenticatable, :registerable,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">         :recoverable, :rememberable, :trackable, :validatable, :confirmable,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">         :omniauthable, omniauth_providers: [:twitter, :facebook, :slack]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  after_create :set_image, :create_source_and_account, :send_welcome_email</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :set_token, :set_login, :set_uuid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  mount_uploader :image, ImageUploader</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :image, size: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :user_is_member_in_current_team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  validate :validate_duplicate_email, on: :create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  serialize :omniauth_info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  include CheckSettings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  include DeviseAsync</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  ROLES = %w[contributor journalist editor owner]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def role?(base_role)</code>
        </li>
      
        <li class="covered" data-hits="5355" data-linenumber="29">
          <span class="hits">5355</span>
          
          <code class="ruby">    ROLES.index(base_role.to_s) &lt;= ROLES.index(self.role) unless self.role.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def role</code>
        </li>
      
        <li class="covered" data-hits="10000" data-linenumber="33">
          <span class="hits">10000</span>
          
          <code class="ruby">    context_team = Team.current || self.current_team</code>
        </li>
      
        <li class="covered" data-hits="10000" data-linenumber="34">
          <span class="hits">10000</span>
          
          <code class="ruby">    role = nil</code>
        </li>
      
        <li class="covered" data-hits="10000" data-linenumber="35">
          <span class="hits">10000</span>
          
          <code class="ruby">    unless context_team.nil?</code>
        </li>
      
        <li class="covered" data-hits="9487" data-linenumber="36">
          <span class="hits">9487</span>
          
          <code class="ruby">      role = Rails.cache.fetch(&quot;role_#{context_team.id}_#{self.id}&quot;, expires_in: 30.seconds, race_condition_ttl: 30.seconds) do</code>
        </li>
      
        <li class="covered" data-hits="268" data-linenumber="37">
          <span class="hits">268</span>
          
          <code class="ruby">        tu = TeamUser.where(team_id: context_team.id, user_id: self.id, status: &#39;member&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="268" data-linenumber="38">
          <span class="hits">268</span>
          
          <code class="ruby">        tu.nil? ? nil : tu.role.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10000" data-linenumber="41">
          <span class="hits">10000</span>
          
          <code class="ruby">    role</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.from_omniauth(auth)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="45">
          <span class="hits">11</span>
          
          <code class="ruby">    token = User.token(auth.provider, auth.uid, auth.credentials.token, auth.credentials.secret)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="46">
          <span class="hits">11</span>
          
          <code class="ruby">    user = User.where(provider: auth.provider, uuid: auth.uid).first || User.new</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="47">
          <span class="hits">11</span>
          
          <code class="ruby">    user.email = user.email.presence || auth.info.email</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="48">
          <span class="hits">11</span>
          
          <code class="ruby">    user.password ||= Devise.friendly_token[0,20]</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="49">
          <span class="hits">11</span>
          
          <code class="ruby">    user.name = auth.info.name</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="50">
          <span class="hits">11</span>
          
          <code class="ruby">    user.uuid = auth.uid</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="51">
          <span class="hits">11</span>
          
          <code class="ruby">    user.provider = auth.provider</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="52">
          <span class="hits">11</span>
          
          <code class="ruby">    user.profile_image = auth.info.image</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="53">
          <span class="hits">11</span>
          
          <code class="ruby">    user.token = token</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="54">
          <span class="hits">11</span>
          
          <code class="ruby">    user.url = auth.url</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="55">
          <span class="hits">11</span>
          
          <code class="ruby">    user.login = auth.info.nickname || auth.info.name.tr(&#39; &#39;, &#39;-&#39;).downcase</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="56">
          <span class="hits">11</span>
          
          <code class="ruby">    user.omniauth_info = auth.as_json</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="57">
          <span class="hits">11</span>
          
          <code class="ruby">    User.current = user</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="58">
          <span class="hits">11</span>
          
          <code class="ruby">    user.save!</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="59">
          <span class="hits">10</span>
          
          <code class="ruby">    user.reload</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.token(provider, id, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    Base64.encode64({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      provider: provider.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      id: id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      token: token.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      secret: secret.to_s</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="68">
          <span class="hits">18</span>
          
          <code class="ruby">    }.to_json).gsub(&quot;\n&quot;, &#39;++n&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.from_token(token)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    JSON.parse(Base64.decode64(token.gsub(&#39;++n&#39;, &quot;\n&quot;)))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(_options = {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      id: Base64.encode64(&quot;User/#{self.id}&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      dbid: self.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      name: self.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">      email: self.email,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">      login: self.login,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      uuid: self.uuid,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      provider: self.provider,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      token: self.token,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      current_team: self.current_team,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      teams: self.user_teams,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      team_ids: self.team_ids,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      permissions: self.permissions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">      profile_image: self.profile_image</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="90">
          <span class="hits">15</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def email_required?</code>
        </li>
      
        <li class="covered" data-hits="3401" data-linenumber="94">
          <span class="hits">3401</span>
          
          <code class="ruby">    self.provider.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def password_required?</code>
        </li>
      
        <li class="covered" data-hits="6802" data-linenumber="98">
          <span class="hits">6802</span>
          
          <code class="ruby">    super &amp;&amp; self.provider.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">  def current_team</code>
        </li>
      
        <li class="covered" data-hits="979" data-linenumber="102">
          <span class="hits">979</span>
          
          <code class="ruby">    if self.current_team_id.blank?</code>
        </li>
      
        <li class="covered" data-hits="908" data-linenumber="103">
          <span class="hits">908</span>
          
          <code class="ruby">      tu = TeamUser.where(user_id: self.id, status: &#39;member&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="908" data-linenumber="104">
          <span class="hits">908</span>
          
          <code class="ruby">      tu.team unless tu.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="106">
          <span class="hits">71</span>
          
          <code class="ruby">      Team.where(id: self.current_team_id).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_teams</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="111">
          <span class="hits">16</span>
          
          <code class="ruby">    team_users = TeamUser.where(user_id: self.id)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="112">
          <span class="hits">16</span>
          
          <code class="ruby">    teams = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="113">
          <span class="hits">16</span>
          
          <code class="ruby">    team_users.each do |tu|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="114">
          <span class="hits">8</span>
          
          <code class="ruby">      teams[tu.team.name] = tu.as_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="116">
          <span class="hits">16</span>
          
          <code class="ruby">    teams.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_member_of?(team)</code>
        </li>
      
        <li class="covered" data-hits="65" data-linenumber="120">
          <span class="hits">65</span>
          
          <code class="ruby">    !self.team_users.select{ |tu| tu.team_id == team.id &amp;&amp; tu.status == &#39;member&#39; }.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def handle</code>
        </li>
      
        <li class="covered" data-hits="330" data-linenumber="124">
          <span class="hits">330</span>
          
          <code class="ruby">    if self.provider.blank?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="125">
          <span class="hits">4</span>
          
          <code class="ruby">      self.email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="326" data-linenumber="127">
          <span class="hits">326</span>
          
          <code class="ruby">      provider = self.provider.capitalize</code>
        </li>
      
        <li class="covered" data-hits="326" data-linenumber="128">
          <span class="hits">326</span>
          
          <code class="ruby">      if !self.omniauth_info.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="129">
          <span class="hits">2</span>
          
          <code class="ruby">        if self.provider == &#39;slack&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">          provider = self.omniauth_info.dig(&#39;extra&#39;, &#39;raw_info&#39;, &#39;url&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">          provider = self.omniauth_info.dig(&#39;url&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">          return provider if !provider.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="325" data-linenumber="136">
          <span class="hits">325</span>
          
          <code class="ruby">      &quot;#{self.login} at #{provider}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  # Whether two users are members of any same team</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_a_colleague_of?(user)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="142">
          <span class="hits">4</span>
          
          <code class="ruby">    results = TeamUser.find_by_sql([&#39;SELECT COUNT(*) AS count FROM team_users tu1 INNER JOIN team_users tu2 ON tu1.team_id = tu2.team_id WHERE tu1.user_id = :user1 AND tu2.user_id = :user2 AND tu1.status = :status AND tu2.status = :status&#39;, { user1: self.id, user2: user.id, status: &#39;member&#39; }])</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="143">
          <span class="hits">4</span>
          
          <code class="ruby">    results.first.count.to_i &gt;= 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current</code>
        </li>
      
        <li class="covered" data-hits="24044" data-linenumber="147">
          <span class="hits">24044</span>
          
          <code class="ruby">    Thread.current[:user]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current=(user)</code>
        </li>
      
        <li class="covered" data-hits="1989" data-linenumber="151">
          <span class="hits">1989</span>
          
          <code class="ruby">    Thread.current[:user] = user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_password=(value)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if value.blank?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">    self.password = value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>
          
          <code class="ruby">    self.password_confirmation = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>
          
          <code class="ruby">  def confirmation_required?</code>
        </li>
      
        <li class="covered" data-hits="6796" data-linenumber="163">
          <span class="hits">6796</span>
          
          <code class="ruby">    self.provider.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="166">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_source_and_account</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="169">
          <span class="hits">3329</span>
          
          <code class="ruby">    source = Source.new</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="170">
          <span class="hits">3329</span>
          
          <code class="ruby">    source.user = self</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="171">
          <span class="hits">3329</span>
          
          <code class="ruby">    source.name = self.name</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="172">
          <span class="hits">3329</span>
          
          <code class="ruby">    source.avatar = self.profile_image</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="173">
          <span class="hits">3329</span>
          
          <code class="ruby">    source.slogan = self.name</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="174">
          <span class="hits">3329</span>
          
          <code class="ruby">    source.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3325" data-linenumber="176">
          <span class="hits">3325</span>
          
          <code class="ruby">    if !self.provider.blank? &amp;&amp; !self.url.blank?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="177">
          <span class="hits">10</span>
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="178">
          <span class="hits">10</span>
          
          <code class="ruby">        account = Account.new</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="179">
          <span class="hits">10</span>
          
          <code class="ruby">        account.user = self</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="180">
          <span class="hits">10</span>
          
          <code class="ruby">        account.source = source</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="181">
          <span class="hits">10</span>
          
          <code class="ruby">        account.url = self.url</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="182">
          <span class="hits">10</span>
          
          <code class="ruby">        account.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">      rescue Errno::ECONNREFUSED =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">        Rails.logger.info &quot;Could not create account for user ##{self.id}: #{e.message}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_token</code>
        </li>
      
        <li class="covered" data-hits="3422" data-linenumber="190">
          <span class="hits">3422</span>
          
          <code class="ruby">    self.token = User.token(&#39;checkdesk&#39;, self.id, Devise.friendly_token[0, 8], Devise.friendly_token[0, 8]) if self.token.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_login</code>
        </li>
      
        <li class="covered" data-hits="3422" data-linenumber="194">
          <span class="hits">3422</span>
          
          <code class="ruby">    if self.login.blank?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="195">
          <span class="hits">5</span>
          
          <code class="ruby">      if self.email.blank?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">        self.login = self.name.tr(&#39; &#39;, &#39;-&#39;).downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="198">
          <span class="hits">4</span>
          
          <code class="ruby">        self.login = self.email.split(&#39;@&#39;)[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_uuid</code>
        </li>
      
        <li class="covered" data-hits="3422" data-linenumber="204">
          <span class="hits">3422</span>
          
          <code class="ruby">    self.uuid = (&#39;checkdesk_&#39; + Digest::MD5.hexdigest(self.email)) if self.uuid.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="207">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_welcome_email</code>
        </li>
      
        <li class="covered" data-hits="3325" data-linenumber="208">
          <span class="hits">3325</span>
          
          <code class="ruby">    RegistrationMailer.delay.welcome_email(self) if self.provider.blank? &amp;&amp; CONFIG[&#39;send_welcome_email_on_registration&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_image</code>
        </li>
      
        <li class="covered" data-hits="3329" data-linenumber="212">
          <span class="hits">3329</span>
          
          <code class="ruby">    if self.profile_image.blank?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="213">
          <span class="hits">5</span>
          
          <code class="ruby">      self.profile_image = CONFIG[&#39;checkdesk_base_url&#39;] + User.find(self.id).image.url</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="214">
          <span class="hits">5</span>
          
          <code class="ruby">      self.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def user_is_member_in_current_team</code>
        </li>
      
        <li class="covered" data-hits="3401" data-linenumber="219">
          <span class="hits">3401</span>
          
          <code class="ruby">    unless self.current_team_id.blank?</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="220">
          <span class="hits">37</span>
          
          <code class="ruby">      tu = TeamUser.where(user_id: self.id, team_id: self.current_team_id, status: &#39;member&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="221">
          <span class="hits">37</span>
          
          <code class="ruby">      errors.add(:base, &quot;User not a member in team #{self.current_team_id}&quot;) if tu.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_duplicate_email</code>
        </li>
      
        <li class="covered" data-hits="3340" data-linenumber="226">
          <span class="hits">3340</span>
          
          <code class="ruby">    u = User.where(email: self.email).last unless self.email.blank?</code>
        </li>
      
        <li class="covered" data-hits="3340" data-linenumber="227">
          <span class="hits">3340</span>
          
          <code class="ruby">    unless u.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="228">
          <span class="hits">3</span>
          
          <code class="ruby">      RegistrationMailer.delay.duplicate_email_detection(self, u)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="229">
          <span class="hits">3</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="30d53ee2aa3321074474db3ab50320d46b7baa79">
  <div class="header">
    <h3>../uploaders/file_uploader.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class FileUploader &lt; CarrierWave::Uploader::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  storage :file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def store_dir</code>
        </li>
      
        <li class="covered" data-hits="2700" data-linenumber="5">
          <span class="hits">2700</span>
          
          <code class="ruby">   &quot;uploads/#{model.class.to_s.underscore}/#{model.id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2afedd0e87563af538aaaea2579b801de288f12d">
  <div class="header">
    <h3>../uploaders/image_uploader.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ImageUploader &lt; FileUploader</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  include CarrierWave::MiniMagick</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  version :thumbnail, if: :media? do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    process resize_to_fit: CONFIG[&#39;image_thumbnail_size&#39;] || [100, 100]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  version :embed, if: :media? do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    process resize_to_fit: CONFIG[&#39;image_embed_size&#39;] || [800, 600]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def default_url</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="13">
          <span class="hits">156</span>
          
          <code class="ruby">    &quot;/images/#{model.class.to_s.underscore}.png&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def extension_white_list</code>
        </li>
      
        <li class="covered" data-hits="5406" data-linenumber="17">
          <span class="hits">5406</span>
          
          <code class="ruby">    %w(jpg jpeg gif png)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def media?(_file)</code>
        </li>
      
        <li class="covered" data-hits="15992" data-linenumber="23">
          <span class="hits">15992</span>
          
          <code class="ruby">    model.class.name == &#39;UploadedImage&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="789a1cc02a6652558f6c0d5da3b33fa4fc62d731">
  <div class="header">
    <h3>../workers/elastic_search_worker.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ElasticSearchWorker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Sidekiq::Worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;sidekiq-limit_fetch&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  sidekiq_options queue: &#39;esqueue&#39;, :retry =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def perform(model, keys, data, type)</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="8">
          <span class="hits">201</span>
          
          <code class="ruby">    model = YAML::load(model)</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="9">
          <span class="hits">201</span>
          
          <code class="ruby">    keys = YAML::load(keys)</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="10">
          <span class="hits">201</span>
          
          <code class="ruby">    data = YAML::load(data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="12">
          <span class="hits">201</span>
          
          <code class="ruby">    if type == &#39;update_parent&#39;</code>
        </li>
      
        <li class="covered" data-hits="151" data-linenumber="13">
          <span class="hits">151</span>
          
          <code class="ruby">      model.update_media_search_bg(keys, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="15">
          <span class="hits">50</span>
          
          <code class="ruby">      model.add_update_media_search_child_bg(type, keys, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ac87e23493e0c267a9788647e0d02eb62392155a">
  <div class="header">
    <h3>lib/api_constraints.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ApiConstraints</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(options)</code>
        </li>
      
        <li class="covered" data-hits="786" data-linenumber="3">
          <span class="hits">786</span>
          
          <code class="ruby">    @version = options[:version]</code>
        </li>
      
        <li class="covered" data-hits="786" data-linenumber="4">
          <span class="hits">786</span>
          
          <code class="ruby">    @default = options[:default]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def matches?(req)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="8">
          <span class="hits">10</span>
          
          <code class="ruby">    @default || req.headers[&#39;Accept&#39;].include?(ApiConstraints.accept(@version))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.accept(version = 1)</code>
        </li>
      
        <li class="covered" data-hits="130" data-linenumber="12">
          <span class="hits">130</span>
          
          <code class="ruby">    &quot;application/vnd.lapis.v#{version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="47666e090b628bfe1fd07353da6f91c909228d28">
  <div class="header">
    <h3>lib/check_elastic_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>41</b> relevant lines. 
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckElasticSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_media_search(keys, data = {})</code>
        </li>
      
        <li class="covered" data-hits="474" data-linenumber="4">
          <span class="hits">474</span>
          
          <code class="ruby">    return if self.disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="151" data-linenumber="5">
          <span class="hits">151</span>
          
          <code class="ruby">    ElasticSearchWorker.perform_in(1.second, YAML::dump(self), YAML::dump(keys), YAML::dump(data), &#39;update_parent&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_media_search_bg(keys, data)</code>
        </li>
      
        <li class="covered" data-hits="151" data-linenumber="9">
          <span class="hits">151</span>
          
          <code class="ruby">    ms = get_elasticsearch_parent</code>
        </li>
      
        <li class="covered" data-hits="151" data-linenumber="10">
          <span class="hits">151</span>
          
          <code class="ruby">    unless ms.nil?</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="11">
          <span class="hits">43</span>
          
          <code class="ruby">      data = get_elasticsearch_data(data)</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="12">
          <span class="hits">43</span>
          
          <code class="ruby">      options = {&#39;last_activity_at&#39; =&gt; Time.now.utc}</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="13">
          <span class="hits">110</span>
          
          <code class="ruby">      keys.each{|k| options[k] = data[k] if ms.respond_to?(&quot;#{k}=&quot;) and !data[k].blank? }</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="14">
          <span class="hits">43</span>
          
          <code class="ruby">      ms.update options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_update_media_search_child(child, keys, data = {})</code>
        </li>
      
        <li class="covered" data-hits="306" data-linenumber="19">
          <span class="hits">306</span>
          
          <code class="ruby">    return if self.disable_es_callbacks</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="20">
          <span class="hits">51</span>
          
          <code class="ruby">    ElasticSearchWorker.perform_in(1.second, YAML::dump(self), YAML::dump(keys), YAML::dump(data), child)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_update_media_search_child_bg(child, keys, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    # get parent</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="25">
          <span class="hits">50</span>
          
          <code class="ruby">    ms = get_elasticsearch_parent</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="26">
          <span class="hits">50</span>
          
          <code class="ruby">    unless ms.nil?</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="27">
          <span class="hits">34</span>
          
          <code class="ruby">      child = child.singularize.camelize.constantize</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="28">
          <span class="hits">34</span>
          
          <code class="ruby">      model = child.search(query: { match: { _id: self.id } }).results.last</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="29">
          <span class="hits">34</span>
          
          <code class="ruby">      if model.nil?</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="30">
          <span class="hits">32</span>
          
          <code class="ruby">        model = child.new</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="31">
          <span class="hits">32</span>
          
          <code class="ruby">        model.id = self.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="33">
          <span class="hits">34</span>
          
          <code class="ruby">      store_elasticsearch_data(model, keys, data, {parent: ms.id})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      # Update last_activity_at on parent</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="35">
          <span class="hits">34</span>
          
          <code class="ruby">      ms.update last_activity_at: Time.now.utc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def store_elasticsearch_data(model, keys, data, options = {})</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="40">
          <span class="hits">34</span>
          
          <code class="ruby">    data = get_elasticsearch_data(data)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="41">
          <span class="hits">34</span>
          
          <code class="ruby">    keys.each do |k|</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="42">
          <span class="hits">57</span>
          
          <code class="ruby">      model.send(&quot;#{k}=&quot;, data[k]) if model.respond_to?(&quot;#{k}=&quot;) and !data[k].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="44">
          <span class="hits">34</span>
          
          <code class="ruby">    model.save!(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_elasticsearch_parent</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="48">
          <span class="hits">201</span>
          
          <code class="ruby">    pm = self.id if self.class.name == &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="49">
          <span class="hits">201</span>
          
          <code class="ruby">    pm = self.annotated_id if pm.nil? and self.is_annotation?</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="50">
          <span class="hits">201</span>
          
          <code class="ruby">    sleep 1 if Rails.env == &#39;test&#39;</code>
        </li>
      
        <li class="covered" data-hits="201" data-linenumber="51">
          <span class="hits">201</span>
          
          <code class="ruby">    MediaSearch.search(query: { match: { annotated_id: pm } }).last unless pm.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_elasticsearch_data(data)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="55">
          <span class="hits">77</span>
          
          <code class="ruby">    (data.blank? and self.respond_to?(:data)) ? self.data : data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def destroy_elasticsearch_data(model, type = &#39;child&#39;)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="59">
          <span class="hits">16</span>
          
          <code class="ruby">    options = {}</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="60">
          <span class="hits">16</span>
          
          <code class="ruby">    options = {parent: self.annotated_id} if type == &#39;child&#39;</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="61">
          <span class="hits">16</span>
          
          <code class="ruby">    obj = model.search(query: { match: { _id: self.id } }).last</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="62">
          <span class="hits">16</span>
          
          <code class="ruby">    obj.delete(options) unless obj.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="37fb467436bcf6e2d5b947053ffdc98c8ac3f9aa">
  <div class="header">
    <h3>lib/check_notifications/pusher.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>42</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckNotifications</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module Pusher</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.included(base)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="4">
          <span class="hits">9</span>
          
          <code class="ruby">      base.send :extend, ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    def pusher_channel</code>
        </li>
      
        <li class="covered" data-hits="3047" data-linenumber="8">
          <span class="hits">3047</span>
          
          <code class="ruby">      &#39;check-channel-&#39; + Digest::MD5.hexdigest(self.class_name + &#39;:&#39; + self.id.to_s + &#39;:pusher_channel&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">      def pusher_options</code>
        </li>
      
        <li class="covered" data-hits="3304" data-linenumber="13">
          <span class="hits">3304</span>
          
          <code class="ruby">        @pusher_options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">      def send_to_pusher(channels, event, data)</code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="17">
          <span class="hits">2330</span>
          
          <code class="ruby">        ::Pusher.trigger(channels, event, { message: data }) unless CONFIG[&#39;pusher_key&#39;].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      def pusher_options=(options)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="21">
          <span class="hits">10</span>
          
          <code class="ruby">        @pusher_options = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      def notifies_pusher(options = {})</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="25">
          <span class="hits">10</span>
          
          <code class="ruby">        send(&quot;after_#{options[:on]}&quot;, :notify_pusher)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="27">
          <span class="hits">10</span>
          
          <code class="ruby">        self.pusher_options = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="29">
          <span class="hits">10</span>
          
          <code class="ruby">        send :include, InstanceMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    module InstanceMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">      def sent_to_pusher</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">        @sent_to_pusher</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      def sent_to_pusher=(bool)</code>
        </li>
      
        <li class="covered" data-hits="2326" data-linenumber="39">
          <span class="hits">2326</span>
          
          <code class="ruby">        @sent_to_pusher = bool</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      def parse_pusher_options</code>
        </li>
      
        <li class="covered" data-hits="3304" data-linenumber="43">
          <span class="hits">3304</span>
          
          <code class="ruby">        options = self.class.pusher_options</code>
        </li>
      
        <li class="covered" data-hits="3304" data-linenumber="44">
          <span class="hits">3304</span>
          
          <code class="ruby">        return if options.has_key?(:if) &amp;&amp; !options[:if].call(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="46">
          <span class="hits">2330</span>
          
          <code class="ruby">        event = options[:event]</code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="47">
          <span class="hits">2330</span>
          
          <code class="ruby">        targets = options[:targets].call(self)</code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="48">
          <span class="hits">2330</span>
          
          <code class="ruby">        data = options[:data].call(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="50">
          <span class="hits">2330</span>
          
          <code class="ruby">        [event, targets, data]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">      def notify_pusher</code>
        </li>
      
        <li class="covered" data-hits="3304" data-linenumber="54">
          <span class="hits">3304</span>
          
          <code class="ruby">        event, targets, data = self.parse_pusher_options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3304" data-linenumber="56">
          <span class="hits">3304</span>
          
          <code class="ruby">        return if event.blank? || targets.blank? || data.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="58">
          <span class="hits">2330</span>
          
          <code class="ruby">        channels = targets.map(&amp;:pusher_channel)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2330" data-linenumber="60">
          <span class="hits">2330</span>
          
          <code class="ruby">        Rails.env === &#39;test&#39; ? self.request_pusher(channels, event, data) : CheckNotifications::Pusher::Worker.perform_in(1.second, channels, event, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">      def request_pusher(channels, event, data)</code>
        </li>
      
        <li class="covered" data-hits="2326" data-linenumber="64">
          <span class="hits">2326</span>
          
          <code class="ruby">        self.class.send_to_pusher(channels, event, data)</code>
        </li>
      
        <li class="covered" data-hits="2326" data-linenumber="65">
          <span class="hits">2326</span>
          
          <code class="ruby">        self.sent_to_pusher = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    class Worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">      include ::Sidekiq::Worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">      include CheckNotifications::Pusher::ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">      def perform(channels, event, data)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="74">
          <span class="hits">4</span>
          
          <code class="ruby">        send_to_pusher(channels, event, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c39888abbd831c7d2f81173dad57673905574247">
  <div class="header">
    <h3>lib/check_notifications/slack.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>46</b> relevant lines. 
      <span class="green"><b>46</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckNotifications</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module Slack</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.included(base)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="4">
          <span class="hits">9</span>
          
          <code class="ruby">      base.send :extend, ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    class Request &lt; ::Net::HTTP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      def slack_options</code>
        </li>
      
        <li class="covered" data-hits="3202" data-linenumber="12">
          <span class="hits">3202</span>
          
          <code class="ruby">        @slack_options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      def slack_options=(options)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="16">
          <span class="hits">10</span>
          
          <code class="ruby">        @slack_options = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">      def request(webhook, data)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="20">
          <span class="hits">21</span>
          
          <code class="ruby">        url = URI.parse(webhook)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="21">
          <span class="hits">21</span>
          
          <code class="ruby">        http = CheckNotifications::Slack::Request.new(url.host, url.port)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="22">
          <span class="hits">21</span>
          
          <code class="ruby">        http.use_ssl = true</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="23">
          <span class="hits">21</span>
          
          <code class="ruby">        request = Net::HTTP::Post.new(url.request_uri)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="24">
          <span class="hits">21</span>
          
          <code class="ruby">        request.set_form_data(data)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="25">
          <span class="hits">21</span>
          
          <code class="ruby">        http.request(request)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">      def notifies_slack(options = {})</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="29">
          <span class="hits">10</span>
          
          <code class="ruby">        send(&quot;after_#{options[:on]}&quot;, :notify_slack)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="31">
          <span class="hits">10</span>
          
          <code class="ruby">        self.slack_options = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="33">
          <span class="hits">10</span>
          
          <code class="ruby">        send :include, InstanceMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    module InstanceMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      def sent_to_slack</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="39">
          <span class="hits">19</span>
          
          <code class="ruby">        @sent_to_slack</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      def sent_to_slack=(bool)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="43">
          <span class="hits">20</span>
          
          <code class="ruby">        @sent_to_slack = bool</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">      def parse_slack_options</code>
        </li>
      
        <li class="covered" data-hits="3202" data-linenumber="47">
          <span class="hits">3202</span>
          
          <code class="ruby">        options = self.class.slack_options</code>
        </li>
      
        <li class="covered" data-hits="3202" data-linenumber="48">
          <span class="hits">3202</span>
          
          <code class="ruby">        return if options.has_key?(:if) &amp;&amp; !options[:if].call(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="50">
          <span class="hits">21</span>
          
          <code class="ruby">        webhook = options[:webhook].call(self)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="51">
          <span class="hits">21</span>
          
          <code class="ruby">        channel = options[:channel].call(self)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="52">
          <span class="hits">21</span>
          
          <code class="ruby">        message = options[:message].call(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="54">
          <span class="hits">21</span>
          
          <code class="ruby">        [webhook, channel, message]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">      def notify_slack</code>
        </li>
      
        <li class="covered" data-hits="3202" data-linenumber="58">
          <span class="hits">3202</span>
          
          <code class="ruby">        webhook, channel, message = self.parse_slack_options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3202" data-linenumber="60">
          <span class="hits">3202</span>
          
          <code class="ruby">        return if webhook.blank? || channel.blank? || message.blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="62">
          <span class="hits">21</span>
          
          <code class="ruby">        data = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">          payload: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">            channel: channel,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">            text: message.gsub(&#39;\\n&#39;, &quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">          }.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="69">
          <span class="hits">21</span>
          
          <code class="ruby">        Rails.env === &#39;test&#39; ? self.request_slack(webhook, data) : CheckNotifications::Slack::Worker.perform_async(webhook, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">      def request_slack(webhook, data)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="73">
          <span class="hits">20</span>
          
          <code class="ruby">        self.class.request(webhook, data)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="74">
          <span class="hits">20</span>
          
          <code class="ruby">        self.sent_to_slack = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    class Worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      include ::Sidekiq::Worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">      include CheckNotifications::Slack::ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">      def perform(webhook, data)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">        request(webhook, data)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7553b062377d88a7112f9dd2ea358ddef05faeef">
  <div class="header">
    <h3>lib/check_permissions.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>62</b> relevant lines. 
      <span class="green"><b>62</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckPermissions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(base)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="4">
          <span class="hits">9</span>
          
          <code class="ruby">    base.extend(ClassMethods)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  class AccessDenied &lt; ::StandardError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(message)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="11">
          <span class="hits">18</span>
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="12">
          <span class="hits">18</span>
          
          <code class="ruby">      @message = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  module ClassMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    def find_if_can(id, ability = nil)</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="18">
          <span class="hits">70</span>
          
          <code class="ruby">      id = id.id if id.is_a?(ActiveRecord::Base)</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="19">
          <span class="hits">70</span>
          
          <code class="ruby">      if User.current.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">        self.find(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="22">
          <span class="hits">68</span>
          
          <code class="ruby">        model = self.name == &#39;Project&#39; ? self.eager_load(:project_medias).order(&#39;project_medias.id DESC&#39;).where(id: id)[0] : self.find(id)</code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="23">
          <span class="hits">66</span>
          
          <code class="ruby">        raise ActiveRecord::RecordNotFound if model.nil?</code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="24">
          <span class="hits">66</span>
          
          <code class="ruby">        ability ||= Ability.new</code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="25">
          <span class="hits">66</span>
          
          <code class="ruby">        if ability.can?(:read, model)</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="26">
          <span class="hits">48</span>
          
          <code class="ruby">          model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="28">
          <span class="hits">18</span>
          
          <code class="ruby">          raise AccessDenied, &quot;Sorry, you can&#39;t read this #{model.class.name.downcase}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def permissions(ability = nil, klass = self.class)</code>
        </li>
      
        <li class="covered" data-hits="81" data-linenumber="35">
          <span class="hits">81</span>
          
          <code class="ruby">    perms = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="81" data-linenumber="36">
          <span class="hits">81</span>
          
          <code class="ruby">    unless User.current.nil?</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="37">
          <span class="hits">77</span>
          
          <code class="ruby">      ability ||= Ability.new</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="38">
          <span class="hits">77</span>
          
          <code class="ruby">      perms[&quot;read #{klass}&quot;] = ability.can?(:read, self)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="39">
          <span class="hits">77</span>
          
          <code class="ruby">      perms[&quot;update #{klass}&quot;] = ability.can?(:update, self)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="40">
          <span class="hits">77</span>
          
          <code class="ruby">      perms[&quot;destroy #{klass}&quot;] = ability.can?(:destroy, self)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="41">
          <span class="hits">77</span>
          
          <code class="ruby">      perms = perms.merge self.set_create_permissions(klass.name, ability)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="81" data-linenumber="43">
          <span class="hits">81</span>
          
          <code class="ruby">    perms.to_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_create_permissions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      &#39;Team&#39; =&gt; [Project, Account, TeamUser, User, Contact],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      &#39;Account&#39; =&gt; [Media, Link, Claim],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      &#39;Media&#39; =&gt; [ProjectMedia, Comment, Flag, Status, Tag, Dynamic, Task],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      &#39;Link&#39; =&gt; [ProjectMedia, Comment, Flag, Status, Tag, Dynamic, Task],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      &#39;Claim&#39; =&gt; [ProjectMedia, Comment, Flag, Status, Tag, Dynamic, Task],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      &#39;Project&#39; =&gt; [ProjectSource, Source, Media, ProjectMedia, Claim, Link],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      &#39;ProjectMedia&#39; =&gt; [Comment, Flag, Status, Tag, Dynamic, Task],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      &#39;Source&#39; =&gt; [Account, ProjectSource, Project],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">      &#39;User&#39; =&gt; [Source, TeamUser, Team, Project]</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="57">
          <span class="hits">77</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_create_permissions(obj, ability = nil)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="61">
          <span class="hits">77</span>
          
          <code class="ruby">    create = self.get_create_permissions</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="62">
          <span class="hits">77</span>
          
          <code class="ruby">    perms = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="63">
          <span class="hits">77</span>
          
          <code class="ruby">    unless create[obj].nil?</code>
        </li>
      
        <li class="covered" data-hits="76" data-linenumber="64">
          <span class="hits">76</span>
          
          <code class="ruby">      ability ||= Ability.new</code>
        </li>
      
        <li class="covered" data-hits="76" data-linenumber="65">
          <span class="hits">76</span>
          
          <code class="ruby">      create[obj].each do |data|</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="66">
          <span class="hits">382</span>
          
          <code class="ruby">        model = data.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="68">
          <span class="hits">382</span>
          
          <code class="ruby">        if model.respond_to?(:team_id) and Team.current.present?</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="69">
          <span class="hits">54</span>
          
          <code class="ruby">          model.team_id = Team.current.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="72">
          <span class="hits">382</span>
          
          <code class="ruby">        model = self.set_project_for_permissions(model) if self.respond_to?(:project)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="74">
          <span class="hits">382</span>
          
          <code class="ruby">        perms[&quot;create #{data}&quot;] = ability.can?(:create, model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="77">
          <span class="hits">77</span>
          
          <code class="ruby">    perms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_project_for_permissions(model)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="81">
          <span class="hits">156</span>
          
          <code class="ruby">    if self.class.name == &#39;ProjectMedia&#39;</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="82">
          <span class="hits">156</span>
          
          <code class="ruby">      model = self.set_media_for_permissions(model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="84">
          <span class="hits">156</span>
          
          <code class="ruby">    unless self.project.nil?</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="85">
          <span class="hits">156</span>
          
          <code class="ruby">      model.project_id = self.project.id if model.respond_to?(:project_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="87">
          <span class="hits">156</span>
          
          <code class="ruby">    model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_media_for_permissions(model)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="91">
          <span class="hits">156</span>
          
          <code class="ruby">    model.media_id = self.id if model.respond_to?(:media_id)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="92">
          <span class="hits">156</span>
          
          <code class="ruby">    model.annotated = self if model.respond_to?(:annotated)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="93">
          <span class="hits">156</span>
          
          <code class="ruby">    model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def check_ability</code>
        </li>
      
        <li class="covered" data-hits="14607" data-linenumber="99">
          <span class="hits">14607</span>
          
          <code class="ruby">    unless self.skip_check_ability or User.current.nil?</code>
        </li>
      
        <li class="covered" data-hits="1089" data-linenumber="100">
          <span class="hits">1089</span>
          
          <code class="ruby">      ability = Ability.new</code>
        </li>
      
        <li class="covered" data-hits="1089" data-linenumber="101">
          <span class="hits">1089</span>
          
          <code class="ruby">      op = self.new_record? ? :create : :update</code>
        </li>
      
        <li class="covered" data-hits="1089" data-linenumber="102">
          <span class="hits">1089</span>
          
          <code class="ruby">      raise &quot;No permission to #{op} #{self.class.name}&quot; unless ability.can?(op, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  def check_destroy_ability</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="107">
          <span class="hits">63</span>
          
          <code class="ruby">    unless User.current.nil?</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="108">
          <span class="hits">41</span>
          
          <code class="ruby">      ability = Ability.new</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="109">
          <span class="hits">41</span>
          
          <code class="ruby">      raise &quot;No permission to delete #{self.class.name}&quot; unless ability.can?(:destroy, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a0158b47b9d235a35765159dcc2ef6728d86e0c2">
  <div class="header">
    <h3>lib/check_search.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>45</b> relevant lines. 
      <span class="green"><b>45</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CheckSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    # options include keywords, projects, tags, status</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="5">
          <span class="hits">63</span>
          
          <code class="ruby">    @options = JSON.parse(options)</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="6">
          <span class="hits">63</span>
          
          <code class="ruby">    @options[&#39;team_id&#39;] = Team.current.id unless Team.current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    # set sort options</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="8">
          <span class="hits">63</span>
          
          <code class="ruby">    @options[&#39;sort&#39;] = @options[&#39;sort&#39;] ||= &#39;recent_added&#39;</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="9">
          <span class="hits">63</span>
          
          <code class="ruby">    @options[&#39;sort_type&#39;] = @options[&#39;sort_type&#39;] ||= &#39;desc&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="13">
          <span class="hits">5</span>
          
          <code class="ruby">    Base64.encode64(&quot;CheckSearch/#{@options.to_json}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def class_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    &#39;CheckSearch&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def create</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="21">
          <span class="hits">62</span>
          
          <code class="ruby">    query = build_search_query</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="22">
          <span class="hits">62</span>
          
          <code class="ruby">    get_search_result(query)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def search_result</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="26">
          <span class="hits">62</span>
          
          <code class="ruby">    self.create</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def medias</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    # should loop in search result and return media</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    # for now all results are medias</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="32">
          <span class="hits">58</span>
          
          <code class="ruby">    ids = self.search_result.map(&amp;:id)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="33">
          <span class="hits">58</span>
          
          <code class="ruby">    items = ProjectMedia.where(id: ids)</code>
        </li>
      
        <li class="covered" data-hits="146" data-linenumber="34">
          <span class="hits">146</span>
          
          <code class="ruby">    ids_sort = items.sort_by{|x| ids.index x.id.to_s}</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="35">
          <span class="hits">58</span>
          
          <code class="ruby">    ids_sort.to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def number_of_results</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="39">
          <span class="hits">4</span>
          
          <code class="ruby">    self.search_result.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_search_query</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="45">
          <span class="hits">62</span>
          
          <code class="ruby">    conditions = []</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="46">
          <span class="hits">62</span>
          
          <code class="ruby">    conditions &lt;&lt; {term: { team_id: @options[&quot;team_id&quot;] } } unless @options[&quot;team_id&quot;].nil?</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="47">
          <span class="hits">62</span>
          
          <code class="ruby">    unless @options[&quot;keyword&quot;].blank?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      # add keyword conditions</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="49">
          <span class="hits">39</span>
          
          <code class="ruby">      keyword_c = [{ query_string: { query: @options[&quot;keyword&quot;], fields: %w(title description quote), default_operator: &quot;AND&quot; } }]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="51">
          <span class="hits">39</span>
          
          <code class="ruby">      [[&#39;comment&#39;, &#39;text&#39;], [&#39;dynamic&#39;, &#39;indexable&#39;]].each do |pair|</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="52">
          <span class="hits">78</span>
          
          <code class="ruby">        keyword_c &lt;&lt; { has_child: { type: &quot;#{pair[0]}_search&quot;, query: { query_string: { query: @options[&quot;keyword&quot;], fields: [pair[1]], default_operator: &quot;AND&quot; }}}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="55">
          <span class="hits">39</span>
          
          <code class="ruby">      conditions &lt;&lt; {bool: {should: keyword_c}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="57">
          <span class="hits">62</span>
          
          <code class="ruby">    unless @options[&quot;tags&quot;].blank?</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="58">
          <span class="hits">21</span>
          
          <code class="ruby">      tags_c = []</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="59">
          <span class="hits">42</span>
          
          <code class="ruby">      tags = @options[&quot;tags&quot;].collect{ |t| t.delete(&#39;#&#39;) }</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="60">
          <span class="hits">21</span>
          
          <code class="ruby">      tags.each do |tag|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="61">
          <span class="hits">21</span>
          
          <code class="ruby">        tags_c &lt;&lt; { match: { full_tag: { query: tag, operator: &#39;and&#39; } } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="63">
          <span class="hits">21</span>
          
          <code class="ruby">      tags_c &lt;&lt; { terms: { tag: tags } }</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="64">
          <span class="hits">21</span>
          
          <code class="ruby">      conditions &lt;&lt; {has_child: { type: &#39;tag_search&#39;, query: { bool: {should: tags_c }}}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="66">
          <span class="hits">62</span>
          
          <code class="ruby">    conditions &lt;&lt; {terms: { project_id: @options[&quot;projects&quot;] } } unless @options[&quot;projects&quot;].blank?</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="67">
          <span class="hits">62</span>
          
          <code class="ruby">    conditions &lt;&lt; {terms: { status: @options[&quot;status&quot;] } } unless @options[&quot;status&quot;].blank?</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="68">
          <span class="hits">62</span>
          
          <code class="ruby">    { bool: { must: conditions } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_search_result(query)</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="72">
          <span class="hits">62</span>
          
          <code class="ruby">    field = &#39;created_at&#39;</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="73">
          <span class="hits">62</span>
          
          <code class="ruby">    field = &#39;last_activity_at&#39; if @options[&#39;sort&#39;] == &#39;recent_activity&#39;</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="74">
          <span class="hits">62</span>
          
          <code class="ruby">    MediaSearch.search(query: query, sort: [{ field =&gt; { order: @options[&quot;sort_type&quot;].downcase }}, &#39;_score&#39;], size: 10000).results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="86d675b34054456747cff5841d114c25f322c775">
  <div class="header">
    <h3>lib/check_settings.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Check Settings Module</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># Add to the model: include CheckSettings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># It must have a &quot;settings&quot; column already</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># Settings have key and value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># How to get a setting value: object.setting(key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># How to set a setting value: object.set_key = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">module CheckSettings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(base)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    base.class_eval do</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">      serialize :settings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def setting(key)</code>
        </li>
      
        <li class="covered" data-hits="6003" data-linenumber="16">
          <span class="hits">6003</span>
          
          <code class="ruby">    self.settings = {} if self.settings.blank?</code>
        </li>
      
        <li class="covered" data-hits="6003" data-linenumber="17">
          <span class="hits">6003</span>
          
          <code class="ruby">    value = self.settings[key.to_s] || self.settings[key.to_sym]</code>
        </li>
      
        <li class="covered" data-hits="6003" data-linenumber="18">
          <span class="hits">6003</span>
          
          <code class="ruby">    unless value.nil?</code>
        </li>
      
        <li class="covered" data-hits="134" data-linenumber="19">
          <span class="hits">134</span>
          
          <code class="ruby">      value.is_a?(Numeric) ? value.to_s : value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def method_missing(method, *args, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="5868" data-linenumber="24">
          <span class="hits">5868</span>
          
          <code class="ruby">    match = /^(set|get)_([^=]+)=?$/.match(method)</code>
        </li>
      
        <li class="covered" data-hits="5868" data-linenumber="25">
          <span class="hits">5868</span>
          
          <code class="ruby">    if match.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="covered" data-hits="5865" data-linenumber="27">
          <span class="hits">5865</span>
          
          <code class="ruby">    elsif match[1] === &#39;set&#39;</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="28">
          <span class="hits">61</span>
          
          <code class="ruby">      self.settings = {} if self.settings.blank?</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="29">
          <span class="hits">61</span>
          
          <code class="ruby">      self.settings[match[2].to_sym] = args.first</code>
        </li>
      
        <li class="covered" data-hits="5804" data-linenumber="30">
          <span class="hits">5804</span>
          
          <code class="ruby">    elsif match[1] === &#39;get&#39;</code>
        </li>
      
        <li class="covered" data-hits="5804" data-linenumber="31">
          <span class="hits">5804</span>
          
          <code class="ruby">      self.setting(match[2])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7c1c533dfd87dbae279c339d93dd6ad2c2010c68">
  <div class="header">
    <h3>lib/devise_async.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># http://www.rubydoc.info/github/plataformatec/devise/Devise%2FModels%2FAuthenticatable%3Asend_devise_notification</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">module DeviseAsync</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  #######################################################################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # Override Devise email logic for sending asynchronously with Sidekiq #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  #######################################################################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.included(clazz)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    clazz.class_eval do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">      after_commit :send_pending_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      # If the resource has been changed, wait until the after_commit flag is fired before sending the notification</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      def send_devise_notification(notification, *args)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">        if self.changed?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">          pending_notifications &lt;&lt; [notification, args]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">          devise_mailer.delay.send(notification, self, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      def send_pending_notifications</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">        pending_notifications.each do |notification, args|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">          devise_mailer.delay.send(notification, self, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">      def pending_notifications</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="29">
          <span class="hits">5</span>
          
          <code class="ruby">        @pending_notifications ||= []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="097423e39de73a9e25c56fe24c0b574fff977719">
  <div class="header">
    <h3>lib/error_codes.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module LapisConstants</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  class ErrorCodes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    UNAUTHORIZED = 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    MISSING_PARAMETERS = 2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    ID_NOT_FOUND = 3</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    INVALID_VALUE = 4</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    UNKNOWN = 5</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    AUTH = 6</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    WARNING = 7</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    MISSING_OBJECT = 8</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    DUPLICATED = 9</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    ALL = %w(UNAUTHORIZED MISSING_PARAMETERS ID_NOT_FOUND INVALID_VALUE UNKNOWN AUTH WARNING MISSING_OBJECT DUPLICATED)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1bf077e64a6eddad880ad3a7362435cac1a154cf">
  <div class="header">
    <h3>lib/included_validator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class IncludedValidator &lt; ActiveModel::EachValidator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_each(record, attribute, value)</code>
        </li>
      
        <li class="covered" data-hits="1873" data-linenumber="3">
          <span class="hits">1873</span>
          
          <code class="ruby">    values = options[:values]</code>
        </li>
      
        <li class="covered" data-hits="1873" data-linenumber="4">
          <span class="hits">1873</span>
          
          <code class="ruby">    unless values.include?(value) </code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="5">
          <span class="hits">9</span>
          
          <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;must be one of: #{values.join(&#39;, &#39;)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fae1396ffcf3e3b04e8d96b0c89a9e6a15d3644a">
  <div class="header">
    <h3>lib/lapis_webhook.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Lapis</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  class Webhook</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(url, payload)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="4">
          <span class="hits">3</span>
          
          <code class="ruby">      @url = url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">      @payload = payload</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    def notification_signature(payload)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">      &#39;sha1=&#39; + OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new(&#39;sha1&#39;), CONFIG[&#39;secret_token&#39;], payload)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    def notify</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">      payload = @payload.to_json</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      uri = URI(@url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      http = Net::HTTP.new(uri.host, uri.port)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">      http.use_ssl = uri.scheme == &#39;https&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">      request = Net::HTTP::Post.new(uri.path)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      request.body = payload</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">      request[&#39;X-Signature&#39;] = notification_signature(payload)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      request[&#39;Content-Type&#39;] = &#39;application/json&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      http.request(request)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5bd729ae741be8f577c048923b094d692051b899">
  <div class="header">
    <h3>lib/machine_name_validator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MachineNameValidator &lt; ActiveModel::EachValidator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_each(record, attribute, value)</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="3">
          <span class="hits">177</span>
          
          <code class="ruby">    if value.to_s.match(/\A([a-z_]+)\Z/).nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="4">
          <span class="hits">6</span>
          
          <code class="ruby">      record.errors[attribute] &lt;&lt; &#39;accepts only downcase letters and underscore&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="64fca552e32de9dd0fe9f39b9d08cd82bca892a8">
  <div class="header">
    <h3>lib/pender_data.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>23</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module PenderData</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_pender_result</code>
        </li>
      
        <li class="covered" data-hits="1169" data-linenumber="3">
          <span class="hits">1169</span>
          
          <code class="ruby">    unless self.url.blank?</code>
        </li>
      
        <li class="covered" data-hits="811" data-linenumber="4">
          <span class="hits">811</span>
          
          <code class="ruby">      result = PenderClient::Request.get_medias(CONFIG[&#39;pender_host&#39;], { url: self.url }, CONFIG[&#39;pender_key&#39;])</code>
        </li>
      
        <li class="covered" data-hits="811" data-linenumber="5">
          <span class="hits">811</span>
          
          <code class="ruby">      if (result[&#39;type&#39;] == &#39;error&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">        errors.add(:base, I18n.t(:pender_could_not_parse, default: &#39;Could not parse this media&#39;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="810" data-linenumber="8">
          <span class="hits">810</span>
          
          <code class="ruby">        self.pender_data = result[&#39;data&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">        # set url with normalized pender URL</code>
        </li>
      
        <li class="covered" data-hits="810" data-linenumber="10">
          <span class="hits">810</span>
          
          <code class="ruby">        self.url = result[&#39;data&#39;][&#39;url&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_pender_result_as_annotation</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="16">
          <span class="hits">797</span>
          
          <code class="ruby">    unless self.pender_data.nil?</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="17">
          <span class="hits">797</span>
          
          <code class="ruby">      data = self.pender_data</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="18">
          <span class="hits">797</span>
          
          <code class="ruby">      pender = Bot.where(name: &#39;Pender&#39;).last</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="19">
          <span class="hits">797</span>
          
          <code class="ruby">      em = Embed.new</code>
        </li>
      
        <li class="covered" data-hits="2237" data-linenumber="20">
          <span class="hits">2237</span>
          
          <code class="ruby">      self.overridden_embed_attributes.each{ |k| em.data[k.to_s] = data[k.to_s] } if self.respond_to?(&#39;overridden_embed_attributes&#39;)</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="21">
          <span class="hits">797</span>
          
          <code class="ruby">      em.published_at = data[&#39;published_at&#39;].to_time.to_i unless data[&#39;published_at&#39;].nil?</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="22">
          <span class="hits">797</span>
          
          <code class="ruby">      em.embed = data.to_json</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="23">
          <span class="hits">797</span>
          
          <code class="ruby">      em.annotated = self</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="24">
          <span class="hits">797</span>
          
          <code class="ruby">      em.annotator = pender unless pender.nil?</code>
        </li>
      
        <li class="covered" data-hits="797" data-linenumber="25">
          <span class="hits">797</span>
          
          <code class="ruby">      em.save!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def pender_data</code>
        </li>
      
        <li class="covered" data-hits="4738" data-linenumber="30">
          <span class="hits">4738</span>
          
          <code class="ruby">    @pender_data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def pender_data=(data)</code>
        </li>
      
        <li class="covered" data-hits="810" data-linenumber="34">
          <span class="hits">810</span>
          
          <code class="ruby">    @pender_data = data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cb44bb32b2c7de6371aaea084349d6e627b72d05">
  <div class="header">
    <h3>lib/safe_validator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SafeValidator &lt; ActiveModel::EachValidator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  def virus_found?(file)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="3">
          <span class="hits">2</span>
          
          <code class="ruby">    io = StringIO.new(File.read(file.path))</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">    client = ClamAV::Client.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    response = client.execute(ClamAV::Commands::InstreamCommand.new(io))</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    response.class.name == &#39;ClamAV::VirusResponse&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_each(record, attribute, value)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="10">
          <span class="hits">15</span>
          
          <code class="ruby">    if !value.nil? &amp;&amp; !value.path.blank? &amp;&amp; !CONFIG[&#39;clamav_service_path&#39;].blank? &amp;&amp; self.virus_found?(value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;validation failed! Virus was found.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e5e5b06c5124b5b219bc0791188bf341f4b56ee2">
  <div class="header">
    <h3>lib/size_validator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SizeValidator &lt; ActiveModel::EachValidator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  DEFAULTS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">    min_width: 200,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    max_width: 600,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    min_height: 200,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    max_height: 600</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  }.with_indifferent_access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def config(key)</code>
        </li>
      
        <li class="covered" data-hits="10902" data-linenumber="10">
          <span class="hits">10902</span>
          
          <code class="ruby">    CONFIG[&quot;image_#{key}&quot;] || DEFAULTS[key]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def invalid_size?(w, h)</code>
        </li>
      
        <li class="covered" data-hits="2722" data-linenumber="14">
          <span class="hits">2722</span>
          
          <code class="ruby">    w &lt; self.config(&#39;min_width&#39;) || w &gt; self.config(&#39;max_width&#39;) || h &lt; self.config(&#39;min_height&#39;) || h &gt; self.config(&#39;max_height&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_each(record, attribute, value)</code>
        </li>
      
        <li class="covered" data-hits="6133" data-linenumber="18">
          <span class="hits">6133</span>
          
          <code class="ruby">    if !value.nil? &amp;&amp; !value.path.blank?</code>
        </li>
      
        <li class="covered" data-hits="2722" data-linenumber="19">
          <span class="hits">2722</span>
          
          <code class="ruby">      w, h = ::MiniMagick::Image.open(value.path)[:dimensions]</code>
        </li>
      
        <li class="covered" data-hits="2722" data-linenumber="20">
          <span class="hits">2722</span>
          
          <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;must be between #{self.config(&#39;min_width&#39;)}x#{self.config(&#39;min_height&#39;)} and #{self.config(&#39;max_width&#39;)}x#{self.config(&#39;max_height&#39;)} pixels&quot; if invalid_size?(w, h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
